2024-11-15 12:33:23,449 - {'optimizer': {'name': 'adam', 'lr': 0.001, 'weight_decay': 0}, 'train': {'epoch': 30, 'batch_size': 2000, 'save_model': True, 'loss': 'pairwise', 'test_step': 1, 'reproducible': True, 'seed': 2023, 'tensorboard': True, 'log_loss': True, 'early_stop': False}, 'test': {'metrics': ['recall', 'ndcg'], 'k': [10, 20, 40], 'batch_size': 512}, 'data': {'type': 'social', 'name': 'yelp', 'user_num': 43043, 'item_num': 66576}, 'model': {'name': 'mhcn', 'layer_num': 2, 'reg_weight': 0.001, 'embedding_size': 64, 'ss_rate': 0.01}, 'tune': {'enable': False, 'hyperparameters': ['layer_num', 'reg_weight'], 'layer_num': [1, 2, 3], 'reg_weight': [0.1, 0.01, 0.001]}, 'device': 'cuda', 'log': True}
2024-11-15 12:33:35,207 - [Epoch   0 /  30] bpr_loss: 206.6137 reg_loss: 0.9709 ss_loss: 1632.3837 
2024-11-15 12:33:52,076 - Epoch   0 Test set [recall@10: 0.0225 recall@20: 0.0384 recall@40: 0.0618 ] Test set [ndcg@10: 0.0114 ndcg@20: 0.0154 ndcg@40: 0.0202 ] 
2024-11-15 12:34:02,996 - [Epoch   1 /  30] bpr_loss: 147.1981 reg_loss: 1.6366 ss_loss: 1430.9625 
2024-11-15 12:34:20,180 - Epoch   1 Test set [recall@10: 0.0257 recall@20: 0.0434 recall@40: 0.0725 ] Test set [ndcg@10: 0.0129 ndcg@20: 0.0173 ndcg@40: 0.0232 ] 
2024-11-15 12:34:31,505 - [Epoch   2 /  30] bpr_loss: 123.5290 reg_loss: 2.2646 ss_loss: 1401.0814 
2024-11-15 12:34:50,265 - Epoch   2 Test set [recall@10: 0.0277 recall@20: 0.0456 recall@40: 0.0758 ] Test set [ndcg@10: 0.0142 ndcg@20: 0.0187 ndcg@40: 0.0248 ] 
2024-11-15 12:35:00,858 - [Epoch   3 /  30] bpr_loss: 112.6745 reg_loss: 2.8864 ss_loss: 1381.4987 
2024-11-15 12:35:16,741 - Epoch   3 Test set [recall@10: 0.0288 recall@20: 0.0475 recall@40: 0.0772 ] Test set [ndcg@10: 0.0145 ndcg@20: 0.0192 ndcg@40: 0.0252 ] 
2024-11-15 12:35:27,271 - [Epoch   4 /  30] bpr_loss: 104.1059 reg_loss: 3.5213 ss_loss: 1373.7880 
2024-11-15 12:35:42,908 - Epoch   4 Test set [recall@10: 0.0299 recall@20: 0.0492 recall@40: 0.0790 ] Test set [ndcg@10: 0.0151 ndcg@20: 0.0200 ndcg@40: 0.0261 ] 
2024-11-15 12:35:53,376 - [Epoch   5 /  30] bpr_loss: 97.9664 reg_loss: 4.1745 ss_loss: 1364.7563 
2024-11-15 12:36:09,161 - Epoch   5 Test set [recall@10: 0.0308 recall@20: 0.0515 recall@40: 0.0817 ] Test set [ndcg@10: 0.0156 ndcg@20: 0.0208 ndcg@40: 0.0269 ] 
2024-11-15 12:36:20,256 - [Epoch   6 /  30] bpr_loss: 93.0660 reg_loss: 4.8402 ss_loss: 1362.2943 
2024-11-15 12:36:36,090 - Epoch   6 Test set [recall@10: 0.0307 recall@20: 0.0509 recall@40: 0.0823 ] Test set [ndcg@10: 0.0158 ndcg@20: 0.0208 ndcg@40: 0.0272 ] 
2024-11-15 12:36:46,901 - [Epoch   7 /  30] bpr_loss: 87.4851 reg_loss: 5.5268 ss_loss: 1358.0268 
2024-11-15 12:37:03,058 - Epoch   7 Test set [recall@10: 0.0317 recall@20: 0.0510 recall@40: 0.0822 ] Test set [ndcg@10: 0.0161 ndcg@20: 0.0210 ndcg@40: 0.0273 ] 
2024-11-15 12:37:13,794 - [Epoch   8 /  30] bpr_loss: 83.7537 reg_loss: 6.2338 ss_loss: 1346.1272 
2024-11-15 12:37:30,190 - Epoch   8 Test set [recall@10: 0.0326 recall@20: 0.0520 recall@40: 0.0832 ] Test set [ndcg@10: 0.0165 ndcg@20: 0.0214 ndcg@40: 0.0277 ] 
2024-11-15 12:37:41,070 - [Epoch   9 /  30] bpr_loss: 79.7697 reg_loss: 6.9544 ss_loss: 1358.7924 
2024-11-15 12:37:57,060 - Epoch   9 Test set [recall@10: 0.0316 recall@20: 0.0519 recall@40: 0.0833 ] Test set [ndcg@10: 0.0158 ndcg@20: 0.0209 ndcg@40: 0.0273 ] 
2024-11-15 12:38:07,679 - [Epoch  10 /  30] bpr_loss: 77.3297 reg_loss: 7.6939 ss_loss: 1335.2126 
2024-11-15 12:38:24,117 - Epoch  10 Test set [recall@10: 0.0317 recall@20: 0.0522 recall@40: 0.0848 ] Test set [ndcg@10: 0.0158 ndcg@20: 0.0210 ndcg@40: 0.0276 ] 
2024-11-15 12:38:34,684 - [Epoch  11 /  30] bpr_loss: 74.7285 reg_loss: 8.4707 ss_loss: 1342.9107 
2024-11-15 12:38:50,799 - Epoch  11 Test set [recall@10: 0.0318 recall@20: 0.0529 recall@40: 0.0856 ] Test set [ndcg@10: 0.0160 ndcg@20: 0.0213 ndcg@40: 0.0279 ] 
2024-11-15 12:39:01,682 - [Epoch  12 /  30] bpr_loss: 72.5268 reg_loss: 9.2646 ss_loss: 1341.6757 
2024-11-15 12:39:18,307 - Epoch  12 Test set [recall@10: 0.0314 recall@20: 0.0525 recall@40: 0.0850 ] Test set [ndcg@10: 0.0160 ndcg@20: 0.0212 ndcg@40: 0.0278 ] 
2024-11-15 12:39:28,891 - [Epoch  13 /  30] bpr_loss: 70.2448 reg_loss: 10.0761 ss_loss: 1336.6458 
2024-11-15 12:39:45,720 - Epoch  13 Test set [recall@10: 0.0318 recall@20: 0.0524 recall@40: 0.0865 ] Test set [ndcg@10: 0.0158 ndcg@20: 0.0210 ndcg@40: 0.0279 ] 
2024-11-15 12:39:56,385 - [Epoch  14 /  30] bpr_loss: 67.1941 reg_loss: 10.8850 ss_loss: 1337.8516 
2024-11-15 12:40:12,605 - Epoch  14 Test set [recall@10: 0.0308 recall@20: 0.0524 recall@40: 0.0858 ] Test set [ndcg@10: 0.0155 ndcg@20: 0.0209 ndcg@40: 0.0277 ] 
2024-11-15 12:40:23,053 - [Epoch  15 /  30] bpr_loss: 64.7309 reg_loss: 11.7076 ss_loss: 1340.1613 
2024-11-15 12:40:38,839 - Epoch  15 Test set [recall@10: 0.0320 recall@20: 0.0528 recall@40: 0.0857 ] Test set [ndcg@10: 0.0159 ndcg@20: 0.0210 ndcg@40: 0.0277 ] 
2024-11-15 12:40:49,455 - [Epoch  16 /  30] bpr_loss: 63.3366 reg_loss: 12.5436 ss_loss: 1335.2894 
2024-11-15 12:41:05,718 - Epoch  16 Test set [recall@10: 0.0311 recall@20: 0.0526 recall@40: 0.0861 ] Test set [ndcg@10: 0.0156 ndcg@20: 0.0209 ndcg@40: 0.0278 ] 
2024-11-15 12:41:16,415 - [Epoch  17 /  30] bpr_loss: 60.8636 reg_loss: 13.4015 ss_loss: 1323.5031 
2024-11-15 12:41:32,829 - Epoch  17 Test set [recall@10: 0.0315 recall@20: 0.0531 recall@40: 0.0865 ] Test set [ndcg@10: 0.0158 ndcg@20: 0.0212 ndcg@40: 0.0280 ] 
2024-11-15 12:41:43,735 - [Epoch  18 /  30] bpr_loss: 58.5066 reg_loss: 14.2762 ss_loss: 1333.2364 
2024-11-15 12:42:00,341 - Epoch  18 Test set [recall@10: 0.0311 recall@20: 0.0535 recall@40: 0.0864 ] Test set [ndcg@10: 0.0158 ndcg@20: 0.0214 ndcg@40: 0.0281 ] 
2024-11-15 12:42:10,809 - [Epoch  19 /  30] bpr_loss: 56.6609 reg_loss: 15.1446 ss_loss: 1323.1151 
2024-11-15 12:42:29,383 - Epoch  19 Test set [recall@10: 0.0314 recall@20: 0.0535 recall@40: 0.0866 ] Test set [ndcg@10: 0.0161 ndcg@20: 0.0217 ndcg@40: 0.0284 ] 
2024-11-15 12:42:43,110 - [Epoch  20 /  30] bpr_loss: 54.8170 reg_loss: 16.0101 ss_loss: 1319.6488 
2024-11-15 12:42:59,697 - Epoch  20 Test set [recall@10: 0.0316 recall@20: 0.0519 recall@40: 0.0846 ] Test set [ndcg@10: 0.0160 ndcg@20: 0.0211 ndcg@40: 0.0278 ] 
2024-11-15 12:43:09,999 - [Epoch  21 /  30] bpr_loss: 53.2398 reg_loss: 16.8818 ss_loss: 1320.5800 
2024-11-15 12:43:26,949 - Epoch  21 Test set [recall@10: 0.0318 recall@20: 0.0516 recall@40: 0.0851 ] Test set [ndcg@10: 0.0161 ndcg@20: 0.0211 ndcg@40: 0.0279 ] 
2024-11-15 12:43:37,794 - [Epoch  22 /  30] bpr_loss: 51.2215 reg_loss: 17.7701 ss_loss: 1313.8577 
2024-11-15 12:43:54,166 - Epoch  22 Test set [recall@10: 0.0313 recall@20: 0.0516 recall@40: 0.0854 ] Test set [ndcg@10: 0.0161 ndcg@20: 0.0212 ndcg@40: 0.0281 ] 
2024-11-15 12:44:04,563 - [Epoch  23 /  30] bpr_loss: 50.1032 reg_loss: 18.6758 ss_loss: 1313.0254 
2024-11-15 12:44:22,197 - Epoch  23 Test set [recall@10: 0.0319 recall@20: 0.0524 recall@40: 0.0851 ] Test set [ndcg@10: 0.0162 ndcg@20: 0.0214 ndcg@40: 0.0280 ] 
2024-11-15 12:44:33,143 - [Epoch  24 /  30] bpr_loss: 48.2739 reg_loss: 19.5713 ss_loss: 1310.1261 
2024-11-15 12:44:49,630 - Epoch  24 Test set [recall@10: 0.0322 recall@20: 0.0525 recall@40: 0.0854 ] Test set [ndcg@10: 0.0162 ndcg@20: 0.0213 ndcg@40: 0.0280 ] 
2024-11-15 12:45:00,646 - [Epoch  25 /  30] bpr_loss: 46.9822 reg_loss: 20.5102 ss_loss: 1298.7309 
2024-11-15 12:45:16,679 - Epoch  25 Test set [recall@10: 0.0321 recall@20: 0.0530 recall@40: 0.0863 ] Test set [ndcg@10: 0.0164 ndcg@20: 0.0216 ndcg@40: 0.0284 ] 
2024-11-15 12:45:27,363 - [Epoch  26 /  30] bpr_loss: 46.3256 reg_loss: 21.4659 ss_loss: 1301.0471 
2024-11-15 12:45:44,060 - Epoch  26 Test set [recall@10: 0.0315 recall@20: 0.0520 recall@40: 0.0856 ] Test set [ndcg@10: 0.0161 ndcg@20: 0.0213 ndcg@40: 0.0281 ] 
2024-11-15 12:45:54,524 - [Epoch  27 /  30] bpr_loss: 44.5983 reg_loss: 22.4261 ss_loss: 1294.6697 
2024-11-15 12:46:11,674 - Epoch  27 Test set [recall@10: 0.0321 recall@20: 0.0522 recall@40: 0.0848 ] Test set [ndcg@10: 0.0166 ndcg@20: 0.0216 ndcg@40: 0.0282 ] 
2024-11-15 12:46:22,694 - [Epoch  28 /  30] bpr_loss: 43.3141 reg_loss: 23.3796 ss_loss: 1287.8967 
2024-11-15 12:46:38,841 - Epoch  28 Test set [recall@10: 0.0316 recall@20: 0.0523 recall@40: 0.0851 ] Test set [ndcg@10: 0.0163 ndcg@20: 0.0216 ndcg@40: 0.0282 ] 
2024-11-15 12:46:49,226 - [Epoch  29 /  30] bpr_loss: 41.8758 reg_loss: 24.3675 ss_loss: 1285.6477 
2024-11-15 12:47:05,332 - Epoch  29 Test set [recall@10: 0.0314 recall@20: 0.0525 recall@40: 0.0841 ] Test set [ndcg@10: 0.0163 ndcg@20: 0.0216 ndcg@40: 0.0280 ] 
2024-11-15 12:47:21,569 - Test set [recall@10: 0.0314 recall@20: 0.0525 recall@40: 0.0841 ] Test set [ndcg@10: 0.0163 ndcg@20: 0.0216 ndcg@40: 0.0280 ] 
2024-11-15 12:47:21,607 - Save model parameters to ./checkpoint/mhcn/mhcn-1731674841.pth
2024-11-15 12:47:38,317 - Test set [recall@10: 0.0314 recall@20: 0.0525 recall@40: 0.0841 ] Test set [ndcg@10: 0.0163 ndcg@20: 0.0216 ndcg@40: 0.0280 ] 
