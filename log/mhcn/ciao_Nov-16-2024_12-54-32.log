2024-11-16 12:54:32,488 - {'optimizer': {'name': 'adam', 'lr': 0.001, 'weight_decay': 0}, 'train': {'epoch': 30, 'batch_size': 2000, 'save_model': True, 'loss': 'pairwise', 'test_step': 1, 'reproducible': True, 'seed': 2023, 'tensorboard': True, 'log_loss': True, 'early_stop': False}, 'test': {'metrics': ['recall', 'ndcg'], 'k': [10, 20, 40], 'batch_size': 512}, 'data': {'type': 'social', 'name': 'ciao', 'user_num': 7375, 'item_num': 105114}, 'model': {'name': 'mhcn', 'layer_num': 2, 'reg_weight': 0.001, 'embedding_size': 64, 'ss_rate': 0.01}, 'tune': {'enable': False, 'hyperparameters': ['layer_num', 'reg_weight'], 'layer_num': [1, 2, 3], 'reg_weight': [0.1, 0.01, 0.001]}, 'device': 'cuda', 'log': True}
2024-11-16 12:54:37,751 - [Epoch   0 /  30] bpr_loss: 185.4622 reg_loss: 0.7846 ss_loss: 342.2003 
2024-11-16 12:54:42,061 - Epoch   0 Test set [recall@10: 0.0280 recall@20: 0.0430 recall@40: 0.0650 ] Test set [ndcg@10: 0.0309 ndcg@20: 0.0347 ndcg@40: 0.0410 ] 
2024-11-16 12:54:46,421 - [Epoch   1 /  30] bpr_loss: 116.8744 reg_loss: 1.2275 ss_loss: 293.5975 
2024-11-16 12:54:50,947 - Epoch   1 Test set [recall@10: 0.0330 recall@20: 0.0489 recall@40: 0.0707 ] Test set [ndcg@10: 0.0367 ndcg@20: 0.0401 ndcg@40: 0.0462 ] 
2024-11-16 12:54:55,389 - [Epoch   2 /  30] bpr_loss: 99.1369 reg_loss: 1.6710 ss_loss: 282.8989 
2024-11-16 12:54:59,460 - Epoch   2 Test set [recall@10: 0.0343 recall@20: 0.0521 recall@40: 0.0746 ] Test set [ndcg@10: 0.0381 ndcg@20: 0.0420 ndcg@40: 0.0483 ] 
2024-11-16 12:55:03,307 - [Epoch   3 /  30] bpr_loss: 89.0396 reg_loss: 2.1030 ss_loss: 278.6901 
2024-11-16 12:55:07,744 - Epoch   3 Test set [recall@10: 0.0353 recall@20: 0.0541 recall@40: 0.0775 ] Test set [ndcg@10: 0.0397 ndcg@20: 0.0438 ndcg@40: 0.0502 ] 
2024-11-16 12:55:12,446 - [Epoch   4 /  30] bpr_loss: 80.9221 reg_loss: 2.5155 ss_loss: 275.6994 
2024-11-16 12:55:16,294 - Epoch   4 Test set [recall@10: 0.0373 recall@20: 0.0556 recall@40: 0.0801 ] Test set [ndcg@10: 0.0409 ndcg@20: 0.0447 ndcg@40: 0.0514 ] 
2024-11-16 12:55:20,719 - [Epoch   5 /  30] bpr_loss: 75.5270 reg_loss: 2.9138 ss_loss: 274.0669 
2024-11-16 12:55:24,470 - Epoch   5 Test set [recall@10: 0.0377 recall@20: 0.0569 recall@40: 0.0798 ] Test set [ndcg@10: 0.0412 ndcg@20: 0.0454 ndcg@40: 0.0519 ] 
2024-11-16 12:55:29,376 - [Epoch   6 /  30] bpr_loss: 70.2680 reg_loss: 3.3081 ss_loss: 273.3650 
2024-11-16 12:55:33,049 - Epoch   6 Test set [recall@10: 0.0380 recall@20: 0.0565 recall@40: 0.0812 ] Test set [ndcg@10: 0.0415 ndcg@20: 0.0457 ndcg@40: 0.0526 ] 
2024-11-16 12:55:38,216 - [Epoch   7 /  30] bpr_loss: 66.5945 reg_loss: 3.6929 ss_loss: 270.8064 
2024-11-16 12:55:41,909 - Epoch   7 Test set [recall@10: 0.0363 recall@20: 0.0559 recall@40: 0.0803 ] Test set [ndcg@10: 0.0407 ndcg@20: 0.0451 ndcg@40: 0.0520 ] 
2024-11-16 12:55:46,789 - [Epoch   8 /  30] bpr_loss: 62.5114 reg_loss: 4.0780 ss_loss: 270.4101 
2024-11-16 12:55:50,493 - Epoch   8 Test set [recall@10: 0.0366 recall@20: 0.0566 recall@40: 0.0817 ] Test set [ndcg@10: 0.0410 ndcg@20: 0.0456 ndcg@40: 0.0527 ] 
2024-11-16 12:55:54,693 - [Epoch   9 /  30] bpr_loss: 59.5924 reg_loss: 4.4603 ss_loss: 269.4871 
2024-11-16 12:55:58,960 - Epoch   9 Test set [recall@10: 0.0373 recall@20: 0.0563 recall@40: 0.0817 ] Test set [ndcg@10: 0.0413 ndcg@20: 0.0457 ndcg@40: 0.0527 ] 
2024-11-16 12:56:03,174 - [Epoch  10 /  30] bpr_loss: 57.0665 reg_loss: 4.8441 ss_loss: 267.7933 
2024-11-16 12:56:07,549 - Epoch  10 Test set [recall@10: 0.0374 recall@20: 0.0571 recall@40: 0.0826 ] Test set [ndcg@10: 0.0415 ndcg@20: 0.0459 ndcg@40: 0.0530 ] 
2024-11-16 12:56:12,028 - [Epoch  11 /  30] bpr_loss: 54.1704 reg_loss: 5.2303 ss_loss: 267.3256 
2024-11-16 12:56:15,999 - Epoch  11 Test set [recall@10: 0.0380 recall@20: 0.0580 recall@40: 0.0832 ] Test set [ndcg@10: 0.0416 ndcg@20: 0.0462 ndcg@40: 0.0534 ] 
2024-11-16 12:56:20,464 - [Epoch  12 /  30] bpr_loss: 51.7086 reg_loss: 5.6138 ss_loss: 266.3049 
2024-11-16 12:56:24,705 - Epoch  12 Test set [recall@10: 0.0382 recall@20: 0.0583 recall@40: 0.0836 ] Test set [ndcg@10: 0.0421 ndcg@20: 0.0467 ndcg@40: 0.0539 ] 
2024-11-16 12:56:28,776 - [Epoch  13 /  30] bpr_loss: 49.0286 reg_loss: 5.9989 ss_loss: 265.0671 
2024-11-16 12:56:32,616 - Epoch  13 Test set [recall@10: 0.0380 recall@20: 0.0566 recall@40: 0.0828 ] Test set [ndcg@10: 0.0419 ndcg@20: 0.0460 ndcg@40: 0.0534 ] 
2024-11-16 12:56:36,400 - [Epoch  14 /  30] bpr_loss: 47.3725 reg_loss: 6.3823 ss_loss: 264.4422 
2024-11-16 12:56:40,084 - Epoch  14 Test set [recall@10: 0.0370 recall@20: 0.0570 recall@40: 0.0830 ] Test set [ndcg@10: 0.0416 ndcg@20: 0.0461 ndcg@40: 0.0534 ] 
2024-11-16 12:56:44,192 - [Epoch  15 /  30] bpr_loss: 45.6822 reg_loss: 6.7665 ss_loss: 262.6856 
2024-11-16 12:56:48,257 - Epoch  15 Test set [recall@10: 0.0370 recall@20: 0.0587 recall@40: 0.0834 ] Test set [ndcg@10: 0.0418 ndcg@20: 0.0469 ndcg@40: 0.0538 ] 
2024-11-16 12:56:52,991 - [Epoch  16 /  30] bpr_loss: 43.3640 reg_loss: 7.1469 ss_loss: 263.0784 
2024-11-16 12:56:56,874 - Epoch  16 Test set [recall@10: 0.0376 recall@20: 0.0584 recall@40: 0.0836 ] Test set [ndcg@10: 0.0422 ndcg@20: 0.0471 ndcg@40: 0.0540 ] 
2024-11-16 12:57:01,597 - [Epoch  17 /  30] bpr_loss: 41.8242 reg_loss: 7.5194 ss_loss: 261.4347 
2024-11-16 12:57:05,301 - Epoch  17 Test set [recall@10: 0.0383 recall@20: 0.0594 recall@40: 0.0849 ] Test set [ndcg@10: 0.0427 ndcg@20: 0.0476 ndcg@40: 0.0547 ] 
2024-11-16 12:57:09,286 - [Epoch  18 /  30] bpr_loss: 40.7128 reg_loss: 7.8900 ss_loss: 260.6349 
2024-11-16 12:57:13,210 - Epoch  18 Test set [recall@10: 0.0377 recall@20: 0.0593 recall@40: 0.0847 ] Test set [ndcg@10: 0.0421 ndcg@20: 0.0470 ndcg@40: 0.0542 ] 
2024-11-16 12:57:17,180 - [Epoch  19 /  30] bpr_loss: 38.9656 reg_loss: 8.2610 ss_loss: 258.8411 
2024-11-16 12:57:21,552 - Epoch  19 Test set [recall@10: 0.0369 recall@20: 0.0588 recall@40: 0.0846 ] Test set [ndcg@10: 0.0420 ndcg@20: 0.0471 ndcg@40: 0.0543 ] 
2024-11-16 12:57:26,356 - [Epoch  20 /  30] bpr_loss: 37.3695 reg_loss: 8.6264 ss_loss: 258.3407 
2024-11-16 12:57:30,245 - Epoch  20 Test set [recall@10: 0.0376 recall@20: 0.0593 recall@40: 0.0852 ] Test set [ndcg@10: 0.0421 ndcg@20: 0.0470 ndcg@40: 0.0542 ] 
2024-11-16 12:57:34,693 - [Epoch  21 /  30] bpr_loss: 36.3629 reg_loss: 8.9829 ss_loss: 258.1022 
2024-11-16 12:57:38,502 - Epoch  21 Test set [recall@10: 0.0377 recall@20: 0.0584 recall@40: 0.0854 ] Test set [ndcg@10: 0.0419 ndcg@20: 0.0466 ndcg@40: 0.0541 ] 
2024-11-16 12:57:42,496 - [Epoch  22 /  30] bpr_loss: 35.1430 reg_loss: 9.3383 ss_loss: 256.3760 
2024-11-16 12:57:46,522 - Epoch  22 Test set [recall@10: 0.0380 recall@20: 0.0600 recall@40: 0.0848 ] Test set [ndcg@10: 0.0418 ndcg@20: 0.0468 ndcg@40: 0.0538 ] 
2024-11-16 12:57:51,505 - [Epoch  23 /  30] bpr_loss: 34.1296 reg_loss: 9.6858 ss_loss: 255.9760 
2024-11-16 12:57:55,858 - Epoch  23 Test set [recall@10: 0.0383 recall@20: 0.0593 recall@40: 0.0852 ] Test set [ndcg@10: 0.0421 ndcg@20: 0.0471 ndcg@40: 0.0543 ] 
2024-11-16 12:58:00,728 - [Epoch  24 /  30] bpr_loss: 32.7324 reg_loss: 10.0251 ss_loss: 255.0291 
2024-11-16 12:58:05,047 - Epoch  24 Test set [recall@10: 0.0393 recall@20: 0.0603 recall@40: 0.0859 ] Test set [ndcg@10: 0.0429 ndcg@20: 0.0477 ndcg@40: 0.0548 ] 
2024-11-16 12:58:09,799 - [Epoch  25 /  30] bpr_loss: 31.5107 reg_loss: 10.3472 ss_loss: 254.5706 
2024-11-16 12:58:13,529 - Epoch  25 Test set [recall@10: 0.0379 recall@20: 0.0602 recall@40: 0.0843 ] Test set [ndcg@10: 0.0417 ndcg@20: 0.0471 ndcg@40: 0.0538 ] 
2024-11-16 12:58:18,281 - [Epoch  26 /  30] bpr_loss: 30.4497 reg_loss: 10.6655 ss_loss: 253.2425 
2024-11-16 12:58:22,225 - Epoch  26 Test set [recall@10: 0.0388 recall@20: 0.0597 recall@40: 0.0844 ] Test set [ndcg@10: 0.0421 ndcg@20: 0.0469 ndcg@40: 0.0539 ] 
2024-11-16 12:58:27,005 - [Epoch  27 /  30] bpr_loss: 29.2780 reg_loss: 10.9702 ss_loss: 252.0974 
2024-11-16 12:58:30,881 - Epoch  27 Test set [recall@10: 0.0393 recall@20: 0.0595 recall@40: 0.0848 ] Test set [ndcg@10: 0.0424 ndcg@20: 0.0471 ndcg@40: 0.0541 ] 
2024-11-16 12:58:35,416 - [Epoch  28 /  30] bpr_loss: 29.1555 reg_loss: 11.2658 ss_loss: 251.1633 
2024-11-16 12:58:39,155 - Epoch  28 Test set [recall@10: 0.0388 recall@20: 0.0592 recall@40: 0.0856 ] Test set [ndcg@10: 0.0418 ndcg@20: 0.0465 ndcg@40: 0.0538 ] 
2024-11-16 12:58:44,095 - [Epoch  29 /  30] bpr_loss: 27.4717 reg_loss: 11.5620 ss_loss: 250.6724 
2024-11-16 12:58:47,910 - Epoch  29 Test set [recall@10: 0.0390 recall@20: 0.0597 recall@40: 0.0846 ] Test set [ndcg@10: 0.0416 ndcg@20: 0.0467 ndcg@40: 0.0537 ] 
2024-11-16 12:58:51,665 - Test set [recall@10: 0.0390 recall@20: 0.0597 recall@40: 0.0846 ] Test set [ndcg@10: 0.0416 ndcg@20: 0.0467 ndcg@40: 0.0537 ] 
2024-11-16 12:58:51,695 - Save model parameters to ./checkpoint/mhcn/mhcn-1731761931.pth
2024-11-16 12:58:55,524 - Test set [recall@10: 0.0390 recall@20: 0.0597 recall@40: 0.0846 ] Test set [ndcg@10: 0.0416 ndcg@20: 0.0467 ndcg@40: 0.0537 ] 
