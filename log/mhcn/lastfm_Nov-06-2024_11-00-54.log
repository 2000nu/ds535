2024-11-06 11:00:54,663 - {'optimizer': {'name': 'adam', 'lr': 0.001, 'weight_decay': 0}, 'train': {'epoch': 30, 'batch_size': 2000, 'save_model': True, 'loss': 'pairwise', 'test_step': 1, 'reproducible': True, 'seed': 2023, 'tensorboard': True, 'log_loss': True, 'early_stop': False}, 'test': {'metrics': ['recall', 'ndcg'], 'k': [10, 20, 40], 'batch_size': 512}, 'data': {'type': 'social', 'name': 'lastfm', 'user_num': 1892, 'item_num': 17632}, 'model': {'name': 'mhcn', 'layer_num': 2, 'reg_weight': 0.001, 'embedding_size': 64, 'ss_rate': 0.01}, 'tune': {'enable': False, 'hyperparameters': ['layer_num', 'reg_weight'], 'layer_num': [1, 2, 3], 'reg_weight': [0.1, 0.01, 0.001]}, 'device': 'cuda', 'log': True}
2024-11-06 11:00:56,833 - [Epoch   0 /  30] bpr_loss: 190.7260 reg_loss: 0.4986 ss_loss: 67.6697 
2024-11-06 11:00:57,384 - Epoch   0 Test set [recall@10: 0.0263 recall@20: 0.0412 recall@40: 0.0643 ] Test set [ndcg@10: 0.0322 ndcg@20: 0.0387 ndcg@40: 0.0493 ] 
2024-11-06 11:00:58,624 - [Epoch   1 /  30] bpr_loss: 122.0398 reg_loss: 0.5722 ss_loss: 51.2034 
2024-11-06 11:00:59,108 - Epoch   1 Test set [recall@10: 0.0258 recall@20: 0.0404 recall@40: 0.0620 ] Test set [ndcg@10: 0.0324 ndcg@20: 0.0388 ndcg@40: 0.0488 ] 
2024-11-06 11:01:00,340 - [Epoch   2 /  30] bpr_loss: 105.6397 reg_loss: 0.6481 ss_loss: 45.2191 
2024-11-06 11:01:01,011 - Epoch   2 Test set [recall@10: 0.0264 recall@20: 0.0408 recall@40: 0.0632 ] Test set [ndcg@10: 0.0330 ndcg@20: 0.0392 ndcg@40: 0.0495 ] 
2024-11-06 11:01:02,145 - [Epoch   3 /  30] bpr_loss: 96.7084 reg_loss: 0.7335 ss_loss: 41.8124 
2024-11-06 11:01:02,653 - Epoch   3 Test set [recall@10: 0.0259 recall@20: 0.0403 recall@40: 0.0623 ] Test set [ndcg@10: 0.0327 ndcg@20: 0.0389 ndcg@40: 0.0491 ] 
2024-11-06 11:01:03,766 - [Epoch   4 /  30] bpr_loss: 92.3913 reg_loss: 0.8262 ss_loss: 39.6431 
2024-11-06 11:01:04,249 - Epoch   4 Test set [recall@10: 0.0266 recall@20: 0.0415 recall@40: 0.0641 ] Test set [ndcg@10: 0.0337 ndcg@20: 0.0402 ndcg@40: 0.0506 ] 
2024-11-06 11:01:05,641 - [Epoch   5 /  30] bpr_loss: 85.7255 reg_loss: 0.9234 ss_loss: 37.7255 
2024-11-06 11:01:06,126 - Epoch   5 Test set [recall@10: 0.0266 recall@20: 0.0417 recall@40: 0.0645 ] Test set [ndcg@10: 0.0337 ndcg@20: 0.0404 ndcg@40: 0.0508 ] 
2024-11-06 11:01:07,364 - [Epoch   6 /  30] bpr_loss: 82.2048 reg_loss: 1.0242 ss_loss: 37.3695 
2024-11-06 11:01:07,778 - Epoch   6 Test set [recall@10: 0.0278 recall@20: 0.0425 recall@40: 0.0660 ] Test set [ndcg@10: 0.0350 ndcg@20: 0.0413 ndcg@40: 0.0521 ] 
2024-11-06 11:01:08,989 - [Epoch   7 /  30] bpr_loss: 77.8989 reg_loss: 1.1269 ss_loss: 35.9511 
2024-11-06 11:01:09,441 - Epoch   7 Test set [recall@10: 0.0274 recall@20: 0.0418 recall@40: 0.0662 ] Test set [ndcg@10: 0.0342 ndcg@20: 0.0404 ndcg@40: 0.0517 ] 
2024-11-06 11:01:11,120 - [Epoch   8 /  30] bpr_loss: 73.7124 reg_loss: 1.2304 ss_loss: 35.1081 
2024-11-06 11:01:11,533 - Epoch   8 Test set [recall@10: 0.0277 recall@20: 0.0426 recall@40: 0.0656 ] Test set [ndcg@10: 0.0345 ndcg@20: 0.0410 ndcg@40: 0.0516 ] 
2024-11-06 11:01:12,765 - [Epoch   9 /  30] bpr_loss: 72.3515 reg_loss: 1.3328 ss_loss: 34.8178 
2024-11-06 11:01:13,162 - Epoch   9 Test set [recall@10: 0.0269 recall@20: 0.0428 recall@40: 0.0656 ] Test set [ndcg@10: 0.0336 ndcg@20: 0.0406 ndcg@40: 0.0512 ] 
2024-11-06 11:01:14,554 - [Epoch  10 /  30] bpr_loss: 69.1126 reg_loss: 1.4356 ss_loss: 34.1717 
2024-11-06 11:01:14,964 - Epoch  10 Test set [recall@10: 0.0275 recall@20: 0.0433 recall@40: 0.0674 ] Test set [ndcg@10: 0.0339 ndcg@20: 0.0409 ndcg@40: 0.0520 ] 
2024-11-06 11:01:16,181 - [Epoch  11 /  30] bpr_loss: 67.0513 reg_loss: 1.5377 ss_loss: 33.6247 
2024-11-06 11:01:16,580 - Epoch  11 Test set [recall@10: 0.0271 recall@20: 0.0436 recall@40: 0.0682 ] Test set [ndcg@10: 0.0342 ndcg@20: 0.0415 ndcg@40: 0.0529 ] 
2024-11-06 11:01:17,822 - [Epoch  12 /  30] bpr_loss: 63.6152 reg_loss: 1.6375 ss_loss: 33.7095 
2024-11-06 11:01:18,218 - Epoch  12 Test set [recall@10: 0.0274 recall@20: 0.0434 recall@40: 0.0671 ] Test set [ndcg@10: 0.0341 ndcg@20: 0.0413 ndcg@40: 0.0522 ] 
2024-11-06 11:01:19,635 - [Epoch  13 /  30] bpr_loss: 62.0971 reg_loss: 1.7356 ss_loss: 32.8150 
2024-11-06 11:01:20,131 - Epoch  13 Test set [recall@10: 0.0269 recall@20: 0.0436 recall@40: 0.0680 ] Test set [ndcg@10: 0.0342 ndcg@20: 0.0417 ndcg@40: 0.0529 ] 
2024-11-06 11:01:21,373 - [Epoch  14 /  30] bpr_loss: 59.6273 reg_loss: 1.8317 ss_loss: 32.5411 
2024-11-06 11:01:21,823 - Epoch  14 Test set [recall@10: 0.0271 recall@20: 0.0441 recall@40: 0.0680 ] Test set [ndcg@10: 0.0341 ndcg@20: 0.0417 ndcg@40: 0.0528 ] 
2024-11-06 11:01:22,899 - [Epoch  15 /  30] bpr_loss: 59.3936 reg_loss: 1.9265 ss_loss: 33.0144 
2024-11-06 11:01:23,273 - Epoch  15 Test set [recall@10: 0.0275 recall@20: 0.0443 recall@40: 0.0687 ] Test set [ndcg@10: 0.0345 ndcg@20: 0.0421 ndcg@40: 0.0533 ] 
2024-11-06 11:01:24,390 - [Epoch  16 /  30] bpr_loss: 57.4624 reg_loss: 2.0198 ss_loss: 32.1865 
2024-11-06 11:01:24,764 - Epoch  16 Test set [recall@10: 0.0280 recall@20: 0.0452 recall@40: 0.0685 ] Test set [ndcg@10: 0.0351 ndcg@20: 0.0428 ndcg@40: 0.0536 ] 
2024-11-06 11:01:26,003 - [Epoch  17 /  30] bpr_loss: 54.9717 reg_loss: 2.1102 ss_loss: 32.0185 
2024-11-06 11:01:26,415 - Epoch  17 Test set [recall@10: 0.0282 recall@20: 0.0455 recall@40: 0.0685 ] Test set [ndcg@10: 0.0352 ndcg@20: 0.0430 ndcg@40: 0.0536 ] 
2024-11-06 11:01:27,651 - [Epoch  18 /  30] bpr_loss: 54.3423 reg_loss: 2.1986 ss_loss: 31.5654 
2024-11-06 11:01:28,049 - Epoch  18 Test set [recall@10: 0.0280 recall@20: 0.0454 recall@40: 0.0687 ] Test set [ndcg@10: 0.0350 ndcg@20: 0.0430 ndcg@40: 0.0536 ] 
2024-11-06 11:01:29,229 - [Epoch  19 /  30] bpr_loss: 52.3671 reg_loss: 2.2852 ss_loss: 31.3597 
2024-11-06 11:01:29,615 - Epoch  19 Test set [recall@10: 0.0285 recall@20: 0.0462 recall@40: 0.0704 ] Test set [ndcg@10: 0.0361 ndcg@20: 0.0442 ndcg@40: 0.0552 ] 
2024-11-06 11:01:30,850 - [Epoch  20 /  30] bpr_loss: 51.3763 reg_loss: 2.3701 ss_loss: 31.3526 
2024-11-06 11:01:31,245 - Epoch  20 Test set [recall@10: 0.0287 recall@20: 0.0459 recall@40: 0.0699 ] Test set [ndcg@10: 0.0361 ndcg@20: 0.0438 ndcg@40: 0.0548 ] 
2024-11-06 11:01:32,898 - [Epoch  21 /  30] bpr_loss: 50.8286 reg_loss: 2.4540 ss_loss: 31.3852 
2024-11-06 11:01:33,303 - Epoch  21 Test set [recall@10: 0.0283 recall@20: 0.0455 recall@40: 0.0694 ] Test set [ndcg@10: 0.0349 ndcg@20: 0.0426 ndcg@40: 0.0536 ] 
2024-11-06 11:01:34,749 - [Epoch  22 /  30] bpr_loss: 49.1853 reg_loss: 2.5367 ss_loss: 30.9232 
2024-11-06 11:01:35,155 - Epoch  22 Test set [recall@10: 0.0291 recall@20: 0.0451 recall@40: 0.0694 ] Test set [ndcg@10: 0.0358 ndcg@20: 0.0428 ndcg@40: 0.0540 ] 
2024-11-06 11:01:36,574 - [Epoch  23 /  30] bpr_loss: 47.8981 reg_loss: 2.6160 ss_loss: 30.7922 
2024-11-06 11:01:36,982 - Epoch  23 Test set [recall@10: 0.0292 recall@20: 0.0451 recall@40: 0.0701 ] Test set [ndcg@10: 0.0367 ndcg@20: 0.0436 ndcg@40: 0.0551 ] 
2024-11-06 11:01:38,413 - [Epoch  24 /  30] bpr_loss: 47.2412 reg_loss: 2.6943 ss_loss: 30.8219 
2024-11-06 11:01:38,819 - Epoch  24 Test set [recall@10: 0.0287 recall@20: 0.0453 recall@40: 0.0700 ] Test set [ndcg@10: 0.0364 ndcg@20: 0.0437 ndcg@40: 0.0550 ] 
2024-11-06 11:01:40,223 - [Epoch  25 /  30] bpr_loss: 46.4858 reg_loss: 2.7702 ss_loss: 30.0196 
2024-11-06 11:01:40,647 - Epoch  25 Test set [recall@10: 0.0284 recall@20: 0.0456 recall@40: 0.0706 ] Test set [ndcg@10: 0.0363 ndcg@20: 0.0440 ndcg@40: 0.0554 ] 
2024-11-06 11:01:42,086 - [Epoch  26 /  30] bpr_loss: 46.1565 reg_loss: 2.8457 ss_loss: 30.3346 
2024-11-06 11:01:42,494 - Epoch  26 Test set [recall@10: 0.0285 recall@20: 0.0449 recall@40: 0.0709 ] Test set [ndcg@10: 0.0366 ndcg@20: 0.0439 ndcg@40: 0.0558 ] 
2024-11-06 11:01:43,916 - [Epoch  27 /  30] bpr_loss: 44.4829 reg_loss: 2.9222 ss_loss: 29.4978 
2024-11-06 11:01:44,322 - Epoch  27 Test set [recall@10: 0.0281 recall@20: 0.0452 recall@40: 0.0696 ] Test set [ndcg@10: 0.0361 ndcg@20: 0.0437 ndcg@40: 0.0549 ] 
2024-11-06 11:01:45,744 - [Epoch  28 /  30] bpr_loss: 43.5690 reg_loss: 2.9959 ss_loss: 29.6126 
2024-11-06 11:01:46,150 - Epoch  28 Test set [recall@10: 0.0278 recall@20: 0.0451 recall@40: 0.0696 ] Test set [ndcg@10: 0.0360 ndcg@20: 0.0437 ndcg@40: 0.0549 ] 
2024-11-06 11:01:47,585 - [Epoch  29 /  30] bpr_loss: 41.9182 reg_loss: 3.0659 ss_loss: 29.6274 
2024-11-06 11:01:47,991 - Epoch  29 Test set [recall@10: 0.0280 recall@20: 0.0459 recall@40: 0.0708 ] Test set [ndcg@10: 0.0360 ndcg@20: 0.0442 ndcg@40: 0.0556 ] 
2024-11-06 11:01:48,360 - Test set [recall@10: 0.0280 recall@20: 0.0459 recall@40: 0.0708 ] Test set [ndcg@10: 0.0360 ndcg@20: 0.0442 ndcg@40: 0.0556 ] 
2024-11-06 11:01:48,367 - Save model parameters to ./checkpoint/mhcn/mhcn-1730890908.pth
2024-11-06 11:01:48,734 - Test set [recall@10: 0.0280 recall@20: 0.0459 recall@40: 0.0708 ] Test set [ndcg@10: 0.0360 ndcg@20: 0.0442 ndcg@40: 0.0556 ] 
