2024-11-06 11:15:13,902 - {'optimizer': {'name': 'adam', 'lr': 0.001, 'weight_decay': 0}, 'train': {'epoch': 30, 'batch_size': 2000, 'save_model': True, 'loss': 'pairwise', 'test_step': 1, 'reproducible': True, 'seed': 2023, 'tensorboard': True, 'log_loss': True, 'early_stop': False}, 'test': {'metrics': ['recall', 'ndcg'], 'k': [10, 20, 40], 'batch_size': 512}, 'data': {'type': 'social', 'name': 'epinions', 'user_num': 18081, 'item_num': 251722}, 'model': {'name': 'mhcn', 'layer_num': 2, 'reg_weight': 0.001, 'embedding_size': 64, 'ss_rate': 0.01}, 'tune': {'enable': False, 'hyperparameters': ['layer_num', 'reg_weight'], 'layer_num': [1, 2, 3], 'reg_weight': [0.1, 0.01, 0.001]}, 'device': 'cuda', 'log': True}
2024-11-06 11:16:20,881 - [Epoch   0 /  30] bpr_loss: 168.7166 reg_loss: 1.8707 ss_loss: 584.3575 
2024-11-06 11:16:36,443 - Epoch   0 Test set [recall@10: 0.0168 recall@20: 0.0261 recall@40: 0.0416 ] Test set [ndcg@10: 0.0088 ndcg@20: 0.0112 ndcg@40: 0.0143 ] 
2024-11-06 11:17:42,789 - [Epoch   1 /  30] bpr_loss: 113.5625 reg_loss: 3.7277 ss_loss: 507.0971 
2024-11-06 11:17:57,373 - Epoch   1 Test set [recall@10: 0.0175 recall@20: 0.0281 recall@40: 0.0469 ] Test set [ndcg@10: 0.0093 ndcg@20: 0.0119 ndcg@40: 0.0158 ] 
2024-11-06 11:19:04,412 - [Epoch   2 /  30] bpr_loss: 96.8282 reg_loss: 5.6295 ss_loss: 490.7188 
2024-11-06 11:19:18,251 - Epoch   2 Test set [recall@10: 0.0185 recall@20: 0.0304 recall@40: 0.0476 ] Test set [ndcg@10: 0.0093 ndcg@20: 0.0123 ndcg@40: 0.0158 ] 
2024-11-06 11:20:25,279 - [Epoch   3 /  30] bpr_loss: 85.3695 reg_loss: 7.5669 ss_loss: 479.1811 
2024-11-06 11:20:39,809 - Epoch   3 Test set [recall@10: 0.0180 recall@20: 0.0305 recall@40: 0.0475 ] Test set [ndcg@10: 0.0093 ndcg@20: 0.0124 ndcg@40: 0.0159 ] 
2024-11-06 11:21:46,206 - [Epoch   4 /  30] bpr_loss: 76.7340 reg_loss: 9.5372 ss_loss: 465.3686 
2024-11-06 11:22:01,232 - Epoch   4 Test set [recall@10: 0.0185 recall@20: 0.0305 recall@40: 0.0484 ] Test set [ndcg@10: 0.0091 ndcg@20: 0.0121 ndcg@40: 0.0158 ] 
2024-11-06 11:23:07,513 - [Epoch   5 /  30] bpr_loss: 69.8844 reg_loss: 11.5348 ss_loss: 458.2315 
2024-11-06 11:23:22,607 - Epoch   5 Test set [recall@10: 0.0182 recall@20: 0.0314 recall@40: 0.0482 ] Test set [ndcg@10: 0.0091 ndcg@20: 0.0124 ndcg@40: 0.0158 ] 
2024-11-06 11:24:30,290 - [Epoch   6 /  30] bpr_loss: 63.1670 reg_loss: 13.5180 ss_loss: 451.4174 
2024-11-06 11:24:44,706 - Epoch   6 Test set [recall@10: 0.0193 recall@20: 0.0317 recall@40: 0.0480 ] Test set [ndcg@10: 0.0097 ndcg@20: 0.0129 ndcg@40: 0.0162 ] 
2024-11-06 11:25:51,535 - [Epoch   7 /  30] bpr_loss: 58.3765 reg_loss: 15.4273 ss_loss: 440.6265 
2024-11-06 11:26:06,195 - Epoch   7 Test set [recall@10: 0.0190 recall@20: 0.0315 recall@40: 0.0489 ] Test set [ndcg@10: 0.0093 ndcg@20: 0.0125 ndcg@40: 0.0160 ] 
2024-11-06 11:27:13,134 - [Epoch   8 /  30] bpr_loss: 52.8820 reg_loss: 17.2360 ss_loss: 434.7708 
2024-11-06 11:27:27,957 - Epoch   8 Test set [recall@10: 0.0187 recall@20: 0.0307 recall@40: 0.0479 ] Test set [ndcg@10: 0.0093 ndcg@20: 0.0123 ndcg@40: 0.0158 ] 
2024-11-06 11:28:34,967 - [Epoch   9 /  30] bpr_loss: 48.6503 reg_loss: 18.9566 ss_loss: 427.6588 
2024-11-06 11:28:50,079 - Epoch   9 Test set [recall@10: 0.0196 recall@20: 0.0312 recall@40: 0.0490 ] Test set [ndcg@10: 0.0095 ndcg@20: 0.0124 ndcg@40: 0.0161 ] 
2024-11-06 11:29:56,930 - [Epoch  10 /  30] bpr_loss: 44.7562 reg_loss: 20.6156 ss_loss: 418.7702 
2024-11-06 11:30:11,650 - Epoch  10 Test set [recall@10: 0.0195 recall@20: 0.0308 recall@40: 0.0479 ] Test set [ndcg@10: 0.0093 ndcg@20: 0.0122 ndcg@40: 0.0157 ] 
2024-11-06 11:31:19,236 - [Epoch  11 /  30] bpr_loss: 42.1959 reg_loss: 22.2287 ss_loss: 410.9477 
2024-11-06 11:31:34,194 - Epoch  11 Test set [recall@10: 0.0191 recall@20: 0.0312 recall@40: 0.0470 ] Test set [ndcg@10: 0.0093 ndcg@20: 0.0123 ndcg@40: 0.0155 ] 
2024-11-06 11:32:41,202 - [Epoch  12 /  30] bpr_loss: 39.2275 reg_loss: 23.8172 ss_loss: 403.8694 
2024-11-06 11:32:56,162 - Epoch  12 Test set [recall@10: 0.0190 recall@20: 0.0302 recall@40: 0.0467 ] Test set [ndcg@10: 0.0092 ndcg@20: 0.0120 ndcg@40: 0.0154 ] 
2024-11-06 11:34:02,660 - [Epoch  13 /  30] bpr_loss: 36.8676 reg_loss: 25.3992 ss_loss: 398.0066 
2024-11-06 11:34:18,124 - Epoch  13 Test set [recall@10: 0.0192 recall@20: 0.0301 recall@40: 0.0473 ] Test set [ndcg@10: 0.0096 ndcg@20: 0.0124 ndcg@40: 0.0159 ] 
2024-11-06 11:35:24,362 - [Epoch  14 /  30] bpr_loss: 34.8770 reg_loss: 26.9233 ss_loss: 394.0161 
2024-11-06 11:35:39,309 - Epoch  14 Test set [recall@10: 0.0192 recall@20: 0.0300 recall@40: 0.0473 ] Test set [ndcg@10: 0.0093 ndcg@20: 0.0121 ndcg@40: 0.0156 ] 
2024-11-06 11:36:45,384 - [Epoch  15 /  30] bpr_loss: 33.2479 reg_loss: 28.4723 ss_loss: 390.3449 
2024-11-06 11:37:00,169 - Epoch  15 Test set [recall@10: 0.0185 recall@20: 0.0300 recall@40: 0.0470 ] Test set [ndcg@10: 0.0090 ndcg@20: 0.0118 ndcg@40: 0.0153 ] 
2024-11-06 11:38:07,003 - [Epoch  16 /  30] bpr_loss: 31.4272 reg_loss: 30.0254 ss_loss: 386.1135 
2024-11-06 11:38:21,502 - Epoch  16 Test set [recall@10: 0.0178 recall@20: 0.0289 recall@40: 0.0459 ] Test set [ndcg@10: 0.0086 ndcg@20: 0.0114 ndcg@40: 0.0149 ] 
2024-11-06 11:39:27,616 - [Epoch  17 /  30] bpr_loss: 30.4276 reg_loss: 31.5869 ss_loss: 380.0491 
2024-11-06 11:39:42,890 - Epoch  17 Test set [recall@10: 0.0183 recall@20: 0.0289 recall@40: 0.0470 ] Test set [ndcg@10: 0.0087 ndcg@20: 0.0114 ndcg@40: 0.0150 ] 
2024-11-06 11:40:49,184 - [Epoch  18 /  30] bpr_loss: 29.2326 reg_loss: 33.1636 ss_loss: 374.0980 
2024-11-06 11:41:04,458 - Epoch  18 Test set [recall@10: 0.0175 recall@20: 0.0292 recall@40: 0.0467 ] Test set [ndcg@10: 0.0086 ndcg@20: 0.0116 ndcg@40: 0.0151 ] 
2024-11-06 11:42:10,546 - [Epoch  19 /  30] bpr_loss: 28.2446 reg_loss: 34.6294 ss_loss: 373.5286 
2024-11-06 11:42:25,506 - Epoch  19 Test set [recall@10: 0.0177 recall@20: 0.0290 recall@40: 0.0462 ] Test set [ndcg@10: 0.0087 ndcg@20: 0.0115 ndcg@40: 0.0150 ] 
2024-11-06 11:43:31,643 - [Epoch  20 /  30] bpr_loss: 27.3926 reg_loss: 36.0152 ss_loss: 368.9604 
2024-11-06 11:43:46,562 - Epoch  20 Test set [recall@10: 0.0171 recall@20: 0.0285 recall@40: 0.0457 ] Test set [ndcg@10: 0.0084 ndcg@20: 0.0112 ndcg@40: 0.0147 ] 
2024-11-06 11:44:52,910 - [Epoch  21 /  30] bpr_loss: 26.4938 reg_loss: 37.3297 ss_loss: 363.7929 
2024-11-06 11:45:08,702 - Epoch  21 Test set [recall@10: 0.0168 recall@20: 0.0282 recall@40: 0.0457 ] Test set [ndcg@10: 0.0083 ndcg@20: 0.0112 ndcg@40: 0.0148 ] 
2024-11-06 11:46:14,771 - [Epoch  22 /  30] bpr_loss: 26.1536 reg_loss: 38.6104 ss_loss: 359.2802 
2024-11-06 11:46:30,787 - Epoch  22 Test set [recall@10: 0.0176 recall@20: 0.0285 recall@40: 0.0468 ] Test set [ndcg@10: 0.0087 ndcg@20: 0.0115 ndcg@40: 0.0152 ] 
2024-11-06 11:47:37,140 - [Epoch  23 /  30] bpr_loss: 25.3206 reg_loss: 39.8147 ss_loss: 359.0867 
2024-11-06 11:47:51,852 - Epoch  23 Test set [recall@10: 0.0172 recall@20: 0.0295 recall@40: 0.0454 ] Test set [ndcg@10: 0.0085 ndcg@20: 0.0116 ndcg@40: 0.0148 ] 
2024-11-06 11:48:58,003 - [Epoch  24 /  30] bpr_loss: 24.4593 reg_loss: 40.8224 ss_loss: 356.6460 
2024-11-06 11:49:13,572 - Epoch  24 Test set [recall@10: 0.0174 recall@20: 0.0292 recall@40: 0.0446 ] Test set [ndcg@10: 0.0085 ndcg@20: 0.0115 ndcg@40: 0.0146 ] 
2024-11-06 11:50:19,832 - [Epoch  25 /  30] bpr_loss: 23.9249 reg_loss: 41.7702 ss_loss: 353.5497 
2024-11-06 11:50:34,298 - Epoch  25 Test set [recall@10: 0.0177 recall@20: 0.0295 recall@40: 0.0462 ] Test set [ndcg@10: 0.0085 ndcg@20: 0.0115 ndcg@40: 0.0149 ] 
2024-11-06 11:51:40,665 - [Epoch  26 /  30] bpr_loss: 23.6827 reg_loss: 42.6489 ss_loss: 353.9137 
2024-11-06 11:51:56,371 - Epoch  26 Test set [recall@10: 0.0174 recall@20: 0.0290 recall@40: 0.0452 ] Test set [ndcg@10: 0.0083 ndcg@20: 0.0112 ndcg@40: 0.0145 ] 
2024-11-06 11:53:02,752 - [Epoch  27 /  30] bpr_loss: 23.3827 reg_loss: 43.3540 ss_loss: 353.7439 
2024-11-06 11:53:18,149 - Epoch  27 Test set [recall@10: 0.0176 recall@20: 0.0287 recall@40: 0.0457 ] Test set [ndcg@10: 0.0086 ndcg@20: 0.0114 ndcg@40: 0.0149 ] 
2024-11-06 11:54:24,497 - [Epoch  28 /  30] bpr_loss: 22.7498 reg_loss: 44.0094 ss_loss: 350.9021 
2024-11-06 11:54:39,043 - Epoch  28 Test set [recall@10: 0.0169 recall@20: 0.0276 recall@40: 0.0436 ] Test set [ndcg@10: 0.0083 ndcg@20: 0.0110 ndcg@40: 0.0143 ] 
2024-11-06 11:55:45,154 - [Epoch  29 /  30] bpr_loss: 22.1547 reg_loss: 44.5285 ss_loss: 351.0726 
2024-11-06 11:56:00,753 - Epoch  29 Test set [recall@10: 0.0179 recall@20: 0.0271 recall@40: 0.0449 ] Test set [ndcg@10: 0.0087 ndcg@20: 0.0110 ndcg@40: 0.0146 ] 
2024-11-06 11:56:15,443 - Test set [recall@10: 0.0179 recall@20: 0.0271 recall@40: 0.0449 ] Test set [ndcg@10: 0.0087 ndcg@20: 0.0110 ndcg@40: 0.0146 ] 
2024-11-06 11:56:15,531 - Save model parameters to ./checkpoint/mhcn/mhcn-1730894175.pth
2024-11-06 11:56:30,366 - Test set [recall@10: 0.0179 recall@20: 0.0271 recall@40: 0.0449 ] Test set [ndcg@10: 0.0087 ndcg@20: 0.0110 ndcg@40: 0.0146 ] 
