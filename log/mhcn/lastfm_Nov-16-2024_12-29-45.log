2024-11-16 12:29:45,404 - {'optimizer': {'name': 'adam', 'lr': 0.001, 'weight_decay': 0}, 'train': {'epoch': 30, 'batch_size': 2000, 'save_model': True, 'loss': 'pairwise', 'test_step': 1, 'reproducible': True, 'seed': 2023, 'tensorboard': True, 'log_loss': True, 'early_stop': False}, 'test': {'metrics': ['recall', 'ndcg'], 'k': [10, 20, 40], 'batch_size': 512}, 'data': {'type': 'social', 'name': 'lastfm', 'user_num': 1892, 'item_num': 17632}, 'model': {'name': 'mhcn', 'layer_num': 2, 'reg_weight': 0.001, 'embedding_size': 64, 'ss_rate': 0.01}, 'tune': {'enable': False, 'hyperparameters': ['layer_num', 'reg_weight'], 'layer_num': [1, 2, 3], 'reg_weight': [0.1, 0.01, 0.001]}, 'device': 'cuda', 'log': True}
2024-11-16 12:29:47,598 - [Epoch   0 /  30] bpr_loss: 189.7339 reg_loss: 0.5016 ss_loss: 67.8487 
2024-11-16 12:29:48,185 - Epoch   0 Test set [recall@10: 0.1500 recall@20: 0.2150 recall@40: 0.2942 ] Test set [ndcg@10: 0.1886 ndcg@20: 0.2120 ndcg@40: 0.2470 ] 
2024-11-16 12:29:49,294 - [Epoch   1 /  30] bpr_loss: 123.3574 reg_loss: 0.5760 ss_loss: 51.7169 
2024-11-16 12:29:49,694 - Epoch   1 Test set [recall@10: 0.1596 recall@20: 0.2251 recall@40: 0.3105 ] Test set [ndcg@10: 0.2014 ndcg@20: 0.2245 ndcg@40: 0.2621 ] 
2024-11-16 12:29:50,829 - [Epoch   2 /  30] bpr_loss: 106.7284 reg_loss: 0.6512 ss_loss: 45.5227 
2024-11-16 12:29:51,303 - Epoch   2 Test set [recall@10: 0.1626 recall@20: 0.2341 recall@40: 0.3195 ] Test set [ndcg@10: 0.2072 ndcg@20: 0.2329 ndcg@40: 0.2706 ] 
2024-11-16 12:29:52,987 - [Epoch   3 /  30] bpr_loss: 97.1147 reg_loss: 0.7364 ss_loss: 42.1910 
2024-11-16 12:29:53,576 - Epoch   3 Test set [recall@10: 0.1695 recall@20: 0.2390 recall@40: 0.3277 ] Test set [ndcg@10: 0.2160 ndcg@20: 0.2398 ndcg@40: 0.2789 ] 
2024-11-16 12:29:54,877 - [Epoch   4 /  30] bpr_loss: 91.6564 reg_loss: 0.8288 ss_loss: 40.2917 
2024-11-16 12:29:55,373 - Epoch   4 Test set [recall@10: 0.1702 recall@20: 0.2427 recall@40: 0.3313 ] Test set [ndcg@10: 0.2177 ndcg@20: 0.2430 ndcg@40: 0.2822 ] 
2024-11-16 12:29:56,621 - [Epoch   5 /  30] bpr_loss: 86.5176 reg_loss: 0.9260 ss_loss: 38.4711 
2024-11-16 12:29:56,998 - Epoch   5 Test set [recall@10: 0.1719 recall@20: 0.2455 recall@40: 0.3357 ] Test set [ndcg@10: 0.2201 ndcg@20: 0.2460 ndcg@40: 0.2858 ] 
2024-11-16 12:29:58,482 - [Epoch   6 /  30] bpr_loss: 81.6788 reg_loss: 1.0267 ss_loss: 38.0010 
2024-11-16 12:29:58,966 - Epoch   6 Test set [recall@10: 0.1770 recall@20: 0.2509 recall@40: 0.3396 ] Test set [ndcg@10: 0.2258 ndcg@20: 0.2512 ndcg@40: 0.2905 ] 
2024-11-16 12:30:00,224 - [Epoch   7 /  30] bpr_loss: 76.8818 reg_loss: 1.1297 ss_loss: 36.4468 
2024-11-16 12:30:00,652 - Epoch   7 Test set [recall@10: 0.1776 recall@20: 0.2527 recall@40: 0.3431 ] Test set [ndcg@10: 0.2275 ndcg@20: 0.2537 ndcg@40: 0.2936 ] 
2024-11-16 12:30:01,860 - [Epoch   8 /  30] bpr_loss: 74.4243 reg_loss: 1.2334 ss_loss: 35.6911 
2024-11-16 12:30:02,339 - Epoch   8 Test set [recall@10: 0.1787 recall@20: 0.2544 recall@40: 0.3456 ] Test set [ndcg@10: 0.2287 ndcg@20: 0.2548 ndcg@40: 0.2952 ] 
2024-11-16 12:30:03,846 - [Epoch   9 /  30] bpr_loss: 70.6353 reg_loss: 1.3377 ss_loss: 35.3620 
2024-11-16 12:30:04,324 - Epoch   9 Test set [recall@10: 0.1798 recall@20: 0.2562 recall@40: 0.3462 ] Test set [ndcg@10: 0.2305 ndcg@20: 0.2570 ndcg@40: 0.2970 ] 
2024-11-16 12:30:05,531 - [Epoch  10 /  30] bpr_loss: 68.3845 reg_loss: 1.4408 ss_loss: 34.4503 
2024-11-16 12:30:06,011 - Epoch  10 Test set [recall@10: 0.1834 recall@20: 0.2578 recall@40: 0.3469 ] Test set [ndcg@10: 0.2330 ndcg@20: 0.2581 ndcg@40: 0.2976 ] 
2024-11-16 12:30:07,380 - [Epoch  11 /  30] bpr_loss: 65.9652 reg_loss: 1.5434 ss_loss: 33.8690 
2024-11-16 12:30:07,865 - Epoch  11 Test set [recall@10: 0.1826 recall@20: 0.2589 recall@40: 0.3496 ] Test set [ndcg@10: 0.2321 ndcg@20: 0.2581 ndcg@40: 0.2983 ] 
2024-11-16 12:30:09,247 - [Epoch  12 /  30] bpr_loss: 63.8806 reg_loss: 1.6444 ss_loss: 33.8747 
2024-11-16 12:30:09,727 - Epoch  12 Test set [recall@10: 0.1847 recall@20: 0.2609 recall@40: 0.3536 ] Test set [ndcg@10: 0.2345 ndcg@20: 0.2604 ndcg@40: 0.3017 ] 
2024-11-16 12:30:11,060 - [Epoch  13 /  30] bpr_loss: 61.1003 reg_loss: 1.7439 ss_loss: 32.7649 
2024-11-16 12:30:11,451 - Epoch  13 Test set [recall@10: 0.1862 recall@20: 0.2616 recall@40: 0.3545 ] Test set [ndcg@10: 0.2351 ndcg@20: 0.2608 ndcg@40: 0.3021 ] 
2024-11-16 12:30:12,912 - [Epoch  14 /  30] bpr_loss: 59.6120 reg_loss: 1.8430 ss_loss: 33.1391 
2024-11-16 12:30:13,380 - Epoch  14 Test set [recall@10: 0.1854 recall@20: 0.2600 recall@40: 0.3555 ] Test set [ndcg@10: 0.2367 ndcg@20: 0.2618 ndcg@40: 0.3042 ] 
2024-11-16 12:30:14,838 - [Epoch  15 /  30] bpr_loss: 58.6274 reg_loss: 1.9404 ss_loss: 33.3142 
2024-11-16 12:30:15,237 - Epoch  15 Test set [recall@10: 0.1873 recall@20: 0.2631 recall@40: 0.3577 ] Test set [ndcg@10: 0.2379 ndcg@20: 0.2635 ndcg@40: 0.3054 ] 
2024-11-16 12:30:16,463 - [Epoch  16 /  30] bpr_loss: 58.7122 reg_loss: 2.0349 ss_loss: 32.1512 
2024-11-16 12:30:16,944 - Epoch  16 Test set [recall@10: 0.1865 recall@20: 0.2640 recall@40: 0.3567 ] Test set [ndcg@10: 0.2379 ndcg@20: 0.2643 ndcg@40: 0.3055 ] 
2024-11-16 12:30:18,057 - [Epoch  17 /  30] bpr_loss: 54.7335 reg_loss: 2.1273 ss_loss: 32.4568 
2024-11-16 12:30:18,537 - Epoch  17 Test set [recall@10: 0.1880 recall@20: 0.2667 recall@40: 0.3589 ] Test set [ndcg@10: 0.2397 ndcg@20: 0.2667 ndcg@40: 0.3076 ] 
2024-11-16 12:30:19,767 - [Epoch  18 /  30] bpr_loss: 54.0649 reg_loss: 2.2171 ss_loss: 32.2487 
2024-11-16 12:30:20,190 - Epoch  18 Test set [recall@10: 0.1899 recall@20: 0.2687 recall@40: 0.3598 ] Test set [ndcg@10: 0.2413 ndcg@20: 0.2684 ndcg@40: 0.3088 ] 
2024-11-16 12:30:21,588 - [Epoch  19 /  30] bpr_loss: 52.0713 reg_loss: 2.3067 ss_loss: 31.2794 
2024-11-16 12:30:22,100 - Epoch  19 Test set [recall@10: 0.1892 recall@20: 0.2684 recall@40: 0.3608 ] Test set [ndcg@10: 0.2417 ndcg@20: 0.2689 ndcg@40: 0.3100 ] 
2024-11-16 12:30:23,405 - [Epoch  20 /  30] bpr_loss: 52.0476 reg_loss: 2.3942 ss_loss: 31.8980 
2024-11-16 12:30:23,886 - Epoch  20 Test set [recall@10: 0.1912 recall@20: 0.2707 recall@40: 0.3626 ] Test set [ndcg@10: 0.2446 ndcg@20: 0.2718 ndcg@40: 0.3126 ] 
2024-11-16 12:30:25,206 - [Epoch  21 /  30] bpr_loss: 49.8644 reg_loss: 2.4796 ss_loss: 31.3358 
2024-11-16 12:30:25,688 - Epoch  21 Test set [recall@10: 0.1889 recall@20: 0.2682 recall@40: 0.3651 ] Test set [ndcg@10: 0.2429 ndcg@20: 0.2700 ndcg@40: 0.3130 ] 
2024-11-16 12:30:27,113 - [Epoch  22 /  30] bpr_loss: 49.3888 reg_loss: 2.5627 ss_loss: 31.1935 
2024-11-16 12:30:27,619 - Epoch  22 Test set [recall@10: 0.1890 recall@20: 0.2682 recall@40: 0.3613 ] Test set [ndcg@10: 0.2420 ndcg@20: 0.2688 ndcg@40: 0.3103 ] 
2024-11-16 12:30:28,960 - [Epoch  23 /  30] bpr_loss: 49.5345 reg_loss: 2.6437 ss_loss: 31.4865 
2024-11-16 12:30:29,456 - Epoch  23 Test set [recall@10: 0.1906 recall@20: 0.2696 recall@40: 0.3638 ] Test set [ndcg@10: 0.2442 ndcg@20: 0.2709 ndcg@40: 0.3128 ] 
2024-11-16 12:30:30,763 - [Epoch  24 /  30] bpr_loss: 46.7817 reg_loss: 2.7243 ss_loss: 31.1374 
2024-11-16 12:30:31,163 - Epoch  24 Test set [recall@10: 0.1904 recall@20: 0.2691 recall@40: 0.3652 ] Test set [ndcg@10: 0.2445 ndcg@20: 0.2711 ndcg@40: 0.3137 ] 
2024-11-16 12:30:32,416 - [Epoch  25 /  30] bpr_loss: 46.3105 reg_loss: 2.8037 ss_loss: 30.8062 
2024-11-16 12:30:32,822 - Epoch  25 Test set [recall@10: 0.1919 recall@20: 0.2708 recall@40: 0.3643 ] Test set [ndcg@10: 0.2449 ndcg@20: 0.2714 ndcg@40: 0.3127 ] 
2024-11-16 12:30:34,166 - [Epoch  26 /  30] bpr_loss: 45.6160 reg_loss: 2.8814 ss_loss: 30.7503 
2024-11-16 12:30:34,547 - Epoch  26 Test set [recall@10: 0.1916 recall@20: 0.2708 recall@40: 0.3651 ] Test set [ndcg@10: 0.2441 ndcg@20: 0.2709 ndcg@40: 0.3127 ] 
2024-11-16 12:30:35,786 - [Epoch  27 /  30] bpr_loss: 44.2120 reg_loss: 2.9585 ss_loss: 30.2812 
2024-11-16 12:30:36,219 - Epoch  27 Test set [recall@10: 0.1912 recall@20: 0.2706 recall@40: 0.3653 ] Test set [ndcg@10: 0.2446 ndcg@20: 0.2715 ndcg@40: 0.3135 ] 
2024-11-16 12:30:37,462 - [Epoch  28 /  30] bpr_loss: 43.0429 reg_loss: 3.0337 ss_loss: 30.2950 
2024-11-16 12:30:37,855 - Epoch  28 Test set [recall@10: 0.1915 recall@20: 0.2680 recall@40: 0.3661 ] Test set [ndcg@10: 0.2437 ndcg@20: 0.2693 ndcg@40: 0.3128 ] 
2024-11-16 12:30:39,161 - [Epoch  29 /  30] bpr_loss: 43.1806 reg_loss: 3.1076 ss_loss: 30.0509 
2024-11-16 12:30:39,550 - Epoch  29 Test set [recall@10: 0.1946 recall@20: 0.2707 recall@40: 0.3673 ] Test set [ndcg@10: 0.2469 ndcg@20: 0.2721 ndcg@40: 0.3149 ] 
2024-11-16 12:30:39,910 - Test set [recall@10: 0.1946 recall@20: 0.2707 recall@40: 0.3673 ] Test set [ndcg@10: 0.2469 ndcg@20: 0.2721 ndcg@40: 0.3149 ] 
2024-11-16 12:30:39,917 - Save model parameters to ./checkpoint/mhcn/mhcn-1731760239.pth
2024-11-16 12:30:40,277 - Test set [recall@10: 0.1946 recall@20: 0.2707 recall@40: 0.3673 ] Test set [ndcg@10: 0.2469 ndcg@20: 0.2721 ndcg@40: 0.3149 ] 
