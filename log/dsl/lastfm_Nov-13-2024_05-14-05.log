2024-11-13 05:14:05,415 - {'optimizer': {'name': 'adam', 'lr': 0.0001, 'weight_decay': 0.0}, 'train': {'epoch': 330, 'batch_size': 4096, 's_batch': 2048, 'save_model': True, 'log_loss': True, 'loss': 'pairwise', 'test_step': 5, 'reproducible': True, 'seed': 2023, 'tensorboard': True, 'early_stop': True, 'patience': 4}, 'test': {'metrics': ['recall', 'ndcg'], 'k': [10, 20, 40], 'batch_size': 4096}, 'data': {'type': 'social', 'name': 'lastfm', 'user_num': 1892, 'item_num': 17632}, 'model': {'name': 'dsl', 'embedding_size': 64, 'gnn_layer': 3, 'uugnn_layer': 2, 'dropout_rate': 0.5, 'leaky': 0.5, 'reg_weight': 0.01, 'soc_weight': 0.01, 'sal_weight': 0.001}, 'tune': {'enable': False, 'hyperparameters': ['gnn_layer', 'uugnn_layer'], 'gnn_layer': [1, 2, 3], 'uugnn_layer': [1, 2, 3]}, 'device': 'cuda', 'log': True}
2024-11-13 05:14:07,127 - [Epoch   0 / 330] rec_loss: 2772.3912 reg_loss: 2.7275 soc_loss: 27.6520 sal_loss: 4.0213 
2024-11-13 05:14:07,644 - Epoch   0 Test set [recall@10: 0.0016 recall@20: 0.0030 recall@40: 0.0052 ] Test set [ndcg@10: 0.0013 ndcg@20: 0.0020 ndcg@40: 0.0030 ] 
2024-11-13 05:14:07,645 - Validation score increased.  Copying the best model ...
2024-11-13 05:14:08,721 - [Epoch   1 / 330] rec_loss: 2766.3252 reg_loss: 2.7466 soc_loss: 27.6211 sal_loss: 4.0199 
2024-11-13 05:14:09,906 - [Epoch   2 / 330] rec_loss: 2754.7271 reg_loss: 2.7809 soc_loss: 27.5610 sal_loss: 4.0159 
2024-11-13 05:14:11,006 - [Epoch   3 / 330] rec_loss: 2731.9856 reg_loss: 2.8358 soc_loss: 27.4569 sal_loss: 4.0073 
2024-11-13 05:14:12,061 - [Epoch   4 / 330] rec_loss: 2692.1620 reg_loss: 2.9240 soc_loss: 27.2918 sal_loss: 3.9914 
2024-11-13 05:14:13,093 - [Epoch   5 / 330] rec_loss: 2630.1868 reg_loss: 3.0597 soc_loss: 27.0644 sal_loss: 3.9656 
2024-11-13 05:14:13,543 - Epoch   5 Test set [recall@10: 0.0392 recall@20: 0.0688 recall@40: 0.1121 ] Test set [ndcg@10: 0.0419 ndcg@20: 0.0563 ndcg@40: 0.0761 ] 
2024-11-13 05:14:13,544 - Validation score increased.  Copying the best model ...
2024-11-13 05:14:14,675 - [Epoch   6 / 330] rec_loss: 2543.9091 reg_loss: 3.2560 soc_loss: 26.7747 sal_loss: 3.9277 
2024-11-13 05:14:15,731 - [Epoch   7 / 330] rec_loss: 2436.2407 reg_loss: 3.5211 soc_loss: 26.4372 sal_loss: 3.8755 
2024-11-13 05:14:16,686 - [Epoch   8 / 330] rec_loss: 2312.5175 reg_loss: 3.8572 soc_loss: 26.0394 sal_loss: 3.8069 
2024-11-13 05:14:17,681 - [Epoch   9 / 330] rec_loss: 2179.4072 reg_loss: 4.2601 soc_loss: 25.6269 sal_loss: 3.7198 
2024-11-13 05:14:18,727 - [Epoch  10 / 330] rec_loss: 2045.0256 reg_loss: 4.7205 soc_loss: 25.1925 sal_loss: 3.6151 
2024-11-13 05:14:19,260 - Epoch  10 Test set [recall@10: 0.0413 recall@20: 0.0713 recall@40: 0.1171 ] Test set [ndcg@10: 0.0427 ndcg@20: 0.0574 ndcg@40: 0.0783 ] 
2024-11-13 05:14:19,262 - Validation score increased.  Copying the best model ...
2024-11-13 05:14:20,257 - [Epoch  11 / 330] rec_loss: 1916.2434 reg_loss: 5.2270 soc_loss: 24.7796 sal_loss: 3.4937 
2024-11-13 05:14:21,283 - [Epoch  12 / 330] rec_loss: 1794.1815 reg_loss: 5.7671 soc_loss: 24.3652 sal_loss: 3.3578 
2024-11-13 05:14:22,227 - [Epoch  13 / 330] rec_loss: 1689.5583 reg_loss: 6.3283 soc_loss: 23.9562 sal_loss: 3.2143 
2024-11-13 05:14:23,199 - [Epoch  14 / 330] rec_loss: 1590.3792 reg_loss: 6.8976 soc_loss: 23.5895 sal_loss: 3.0796 
2024-11-13 05:14:24,261 - [Epoch  15 / 330] rec_loss: 1507.7305 reg_loss: 7.4693 soc_loss: 23.2164 sal_loss: 2.9505 
2024-11-13 05:14:24,637 - Epoch  15 Test set [recall@10: 0.0400 recall@20: 0.0709 recall@40: 0.1173 ] Test set [ndcg@10: 0.0419 ndcg@20: 0.0572 ndcg@40: 0.0784 ] 
2024-11-13 05:14:24,637 - Early stop counter: 1 out of 4
2024-11-13 05:14:25,649 - [Epoch  16 / 330] rec_loss: 1430.0080 reg_loss: 8.0375 soc_loss: 22.9169 sal_loss: 2.8294 
2024-11-13 05:14:26,806 - [Epoch  17 / 330] rec_loss: 1366.4965 reg_loss: 8.5999 soc_loss: 22.6377 sal_loss: 2.7048 
2024-11-13 05:14:27,795 - [Epoch  18 / 330] rec_loss: 1313.3751 reg_loss: 9.1524 soc_loss: 22.3104 sal_loss: 2.6014 
2024-11-13 05:14:28,805 - [Epoch  19 / 330] rec_loss: 1257.5340 reg_loss: 9.6930 soc_loss: 22.0314 sal_loss: 2.4952 
2024-11-13 05:14:29,741 - [Epoch  20 / 330] rec_loss: 1211.8535 reg_loss: 10.2253 soc_loss: 21.8738 sal_loss: 2.4068 
2024-11-13 05:14:30,252 - Epoch  20 Test set [recall@10: 0.0397 recall@20: 0.0699 recall@40: 0.1162 ] Test set [ndcg@10: 0.0415 ndcg@20: 0.0565 ndcg@40: 0.0777 ] 
2024-11-13 05:14:30,252 - Early stop counter: 2 out of 4
2024-11-13 05:14:31,285 - [Epoch  21 / 330] rec_loss: 1175.2750 reg_loss: 10.7461 soc_loss: 21.5825 sal_loss: 2.3112 
2024-11-13 05:14:32,241 - [Epoch  22 / 330] rec_loss: 1141.2969 reg_loss: 11.2558 soc_loss: 21.2420 sal_loss: 2.2302 
2024-11-13 05:14:33,297 - [Epoch  23 / 330] rec_loss: 1106.0933 reg_loss: 11.7541 soc_loss: 21.0903 sal_loss: 2.1577 
2024-11-13 05:14:34,597 - [Epoch  24 / 330] rec_loss: 1077.0735 reg_loss: 12.2417 soc_loss: 20.8091 sal_loss: 2.0887 
2024-11-13 05:14:35,528 - [Epoch  25 / 330] rec_loss: 1051.2261 reg_loss: 12.7209 soc_loss: 20.6858 sal_loss: 2.0279 
2024-11-13 05:14:35,888 - Epoch  25 Test set [recall@10: 0.0392 recall@20: 0.0687 recall@40: 0.1149 ] Test set [ndcg@10: 0.0412 ndcg@20: 0.0559 ndcg@40: 0.0771 ] 
2024-11-13 05:14:35,889 - Early stop counter: 3 out of 4
2024-11-13 05:14:36,927 - [Epoch  26 / 330] rec_loss: 1026.6028 reg_loss: 13.1899 soc_loss: 20.5295 sal_loss: 1.9638 
2024-11-13 05:14:38,003 - [Epoch  27 / 330] rec_loss: 1005.4928 reg_loss: 13.6476 soc_loss: 20.2371 sal_loss: 1.9102 
2024-11-13 05:14:39,068 - [Epoch  28 / 330] rec_loss: 981.3074 reg_loss: 14.0980 soc_loss: 20.0644 sal_loss: 1.8575 
2024-11-13 05:14:40,060 - [Epoch  29 / 330] rec_loss: 962.5122 reg_loss: 14.5424 soc_loss: 19.9331 sal_loss: 1.8154 
2024-11-13 05:14:40,996 - [Epoch  30 / 330] rec_loss: 940.6297 reg_loss: 14.9787 soc_loss: 19.7460 sal_loss: 1.7680 
2024-11-13 05:14:41,360 - Epoch  30 Test set [recall@10: 0.0397 recall@20: 0.0681 recall@40: 0.1138 ] Test set [ndcg@10: 0.0420 ndcg@20: 0.0559 ndcg@40: 0.0769 ] 
2024-11-13 05:14:41,360 - Early stop counter: 4 out of 4
2024-11-13 05:14:41,360 - Best Epoch 10
2024-11-13 05:14:41,811 - Test set [recall@10: 0.0413 recall@20: 0.0713 recall@40: 0.1171 ] Test set [ndcg@10: 0.0427 ndcg@20: 0.0574 ndcg@40: 0.0783 ] 
2024-11-13 05:14:42,186 - Test set [recall@10: 0.0413 recall@20: 0.0713 recall@40: 0.1171 ] Test set [ndcg@10: 0.0427 ndcg@20: 0.0574 ndcg@40: 0.0783 ] 
2024-11-13 05:14:42,192 - Save model parameters to ./checkpoint/dsl/dsl-1731474882.pth
2024-11-13 05:14:42,601 - Test set [recall@10: 0.0413 recall@20: 0.0713 recall@40: 0.1171 ] Test set [ndcg@10: 0.0427 ndcg@20: 0.0574 ndcg@40: 0.0783 ] 
