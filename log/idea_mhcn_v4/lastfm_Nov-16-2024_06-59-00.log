2024-11-16 06:59:00,107 - {'optimizer': {'name': 'adam', 'lr': 0.001, 'weight_decay': 0}, 'train': {'epoch': 30, 'batch_size': 2000, 'save_model': False, 'loss': 'pairwise', 'test_step': 1, 'reproducible': True, 'seed': 2023, 'tensorboard': True, 'log_loss': True, 'early_stop': False}, 'test': {'metrics': ['recall', 'ndcg'], 'k': [10, 20, 40], 'batch_size': 512}, 'data': {'type': 'social', 'name': 'lastfm', 'user_num': 1892, 'item_num': 17632}, 'model': {'name': 'idea_mhcn_v4', 'layer_num': 2, 'reg_weight': 0.001, 'embedding_size': 64, 'ss_rate': 0.01}, 'tune': {'enable': False, 'hyperparameters': ['cl_weight', 'temperature', 'sampling_ratio'], 'cl_weight': [1.0, 0.1, 0.01, 0.001], 'temperature': [0.1, 0.2, 0.3, 0.4, 0.5], 'sampling_ratio': [0.5, 0.6, 0.7, 0.8, 0.9, 1.0]}, 'device': 'cuda', 'log': True}
2024-11-16 06:59:01,834 - [Epoch   0 /  30] bpr_loss: 197.5655 reg_loss: 0.4957 ss_loss: 85.5037 
2024-11-16 06:59:02,371 - Epoch   0 Test set [recall@10: 0.0263 recall@20: 0.0417 recall@40: 0.0650 ] Test set [ndcg@10: 0.0313 ndcg@20: 0.0383 ndcg@40: 0.0490 ] 
2024-11-16 06:59:03,942 - [Epoch   1 /  30] bpr_loss: 122.7551 reg_loss: 0.5605 ss_loss: 75.3718 
2024-11-16 06:59:04,544 - Epoch   1 Test set [recall@10: 0.0253 recall@20: 0.0406 recall@40: 0.0625 ] Test set [ndcg@10: 0.0314 ndcg@20: 0.0383 ndcg@40: 0.0484 ] 
2024-11-16 06:59:05,707 - [Epoch   2 /  30] bpr_loss: 105.2679 reg_loss: 0.6237 ss_loss: 72.3577 
2024-11-16 06:59:06,394 - Epoch   2 Test set [recall@10: 0.0257 recall@20: 0.0403 recall@40: 0.0633 ] Test set [ndcg@10: 0.0318 ndcg@20: 0.0383 ndcg@40: 0.0488 ] 
2024-11-16 06:59:07,551 - [Epoch   3 /  30] bpr_loss: 96.3176 reg_loss: 0.6935 ss_loss: 70.3354 
2024-11-16 06:59:07,932 - Epoch   3 Test set [recall@10: 0.0253 recall@20: 0.0403 recall@40: 0.0617 ] Test set [ndcg@10: 0.0312 ndcg@20: 0.0378 ndcg@40: 0.0477 ] 
2024-11-16 06:59:09,411 - [Epoch   4 /  30] bpr_loss: 91.5907 reg_loss: 0.7691 ss_loss: 69.1253 
2024-11-16 06:59:09,922 - Epoch   4 Test set [recall@10: 0.0259 recall@20: 0.0400 recall@40: 0.0637 ] Test set [ndcg@10: 0.0322 ndcg@20: 0.0384 ndcg@40: 0.0492 ] 
2024-11-16 06:59:11,407 - [Epoch   5 /  30] bpr_loss: 84.9961 reg_loss: 0.8483 ss_loss: 68.5062 
2024-11-16 06:59:11,896 - Epoch   5 Test set [recall@10: 0.0261 recall@20: 0.0407 recall@40: 0.0628 ] Test set [ndcg@10: 0.0324 ndcg@20: 0.0388 ndcg@40: 0.0490 ] 
2024-11-16 06:59:13,099 - [Epoch   6 /  30] bpr_loss: 81.4153 reg_loss: 0.9294 ss_loss: 68.4538 
2024-11-16 06:59:13,499 - Epoch   6 Test set [recall@10: 0.0272 recall@20: 0.0424 recall@40: 0.0649 ] Test set [ndcg@10: 0.0335 ndcg@20: 0.0401 ndcg@40: 0.0504 ] 
2024-11-16 06:59:14,740 - [Epoch   7 /  30] bpr_loss: 77.3141 reg_loss: 1.0127 ss_loss: 68.0947 
2024-11-16 06:59:15,147 - Epoch   7 Test set [recall@10: 0.0270 recall@20: 0.0422 recall@40: 0.0659 ] Test set [ndcg@10: 0.0331 ndcg@20: 0.0398 ndcg@40: 0.0508 ] 
2024-11-16 06:59:16,430 - [Epoch   8 /  30] bpr_loss: 73.3677 reg_loss: 1.0970 ss_loss: 67.4480 
2024-11-16 06:59:16,840 - Epoch   8 Test set [recall@10: 0.0264 recall@20: 0.0417 recall@40: 0.0647 ] Test set [ndcg@10: 0.0327 ndcg@20: 0.0394 ndcg@40: 0.0501 ] 
2024-11-16 06:59:18,107 - [Epoch   9 /  30] bpr_loss: 71.8068 reg_loss: 1.1800 ss_loss: 67.3911 
2024-11-16 06:59:18,576 - Epoch   9 Test set [recall@10: 0.0263 recall@20: 0.0424 recall@40: 0.0654 ] Test set [ndcg@10: 0.0325 ndcg@20: 0.0397 ndcg@40: 0.0504 ] 
2024-11-16 06:59:20,047 - [Epoch  10 /  30] bpr_loss: 68.5557 reg_loss: 1.2640 ss_loss: 66.5802 
2024-11-16 06:59:20,492 - Epoch  10 Test set [recall@10: 0.0270 recall@20: 0.0431 recall@40: 0.0663 ] Test set [ndcg@10: 0.0330 ndcg@20: 0.0402 ndcg@40: 0.0509 ] 
2024-11-16 06:59:21,656 - [Epoch  11 /  30] bpr_loss: 66.4523 reg_loss: 1.3485 ss_loss: 66.6290 
2024-11-16 06:59:22,154 - Epoch  11 Test set [recall@10: 0.0267 recall@20: 0.0433 recall@40: 0.0679 ] Test set [ndcg@10: 0.0331 ndcg@20: 0.0407 ndcg@40: 0.0520 ] 
2024-11-16 06:59:23,393 - [Epoch  12 /  30] bpr_loss: 63.0852 reg_loss: 1.4306 ss_loss: 66.3646 
2024-11-16 06:59:23,890 - Epoch  12 Test set [recall@10: 0.0269 recall@20: 0.0435 recall@40: 0.0663 ] Test set [ndcg@10: 0.0337 ndcg@20: 0.0412 ndcg@40: 0.0517 ] 
2024-11-16 06:59:25,041 - [Epoch  13 /  30] bpr_loss: 61.6688 reg_loss: 1.5110 ss_loss: 66.2442 
2024-11-16 06:59:25,537 - Epoch  13 Test set [recall@10: 0.0271 recall@20: 0.0443 recall@40: 0.0664 ] Test set [ndcg@10: 0.0337 ndcg@20: 0.0414 ndcg@40: 0.0516 ] 
2024-11-16 06:59:26,659 - [Epoch  14 /  30] bpr_loss: 59.0379 reg_loss: 1.5897 ss_loss: 65.8832 
2024-11-16 06:59:27,181 - Epoch  14 Test set [recall@10: 0.0273 recall@20: 0.0430 recall@40: 0.0673 ] Test set [ndcg@10: 0.0338 ndcg@20: 0.0407 ndcg@40: 0.0519 ] 
2024-11-16 06:59:28,289 - [Epoch  15 /  30] bpr_loss: 58.8206 reg_loss: 1.6674 ss_loss: 66.7317 
2024-11-16 06:59:28,787 - Epoch  15 Test set [recall@10: 0.0273 recall@20: 0.0442 recall@40: 0.0683 ] Test set [ndcg@10: 0.0338 ndcg@20: 0.0413 ndcg@40: 0.0524 ] 
2024-11-16 06:59:29,901 - [Epoch  16 /  30] bpr_loss: 57.0157 reg_loss: 1.7432 ss_loss: 65.8731 
2024-11-16 06:59:30,427 - Epoch  16 Test set [recall@10: 0.0277 recall@20: 0.0446 recall@40: 0.0671 ] Test set [ndcg@10: 0.0342 ndcg@20: 0.0417 ndcg@40: 0.0521 ] 
2024-11-16 06:59:31,672 - [Epoch  17 /  30] bpr_loss: 54.4344 reg_loss: 1.8181 ss_loss: 66.0843 
2024-11-16 06:59:32,084 - Epoch  17 Test set [recall@10: 0.0279 recall@20: 0.0448 recall@40: 0.0675 ] Test set [ndcg@10: 0.0344 ndcg@20: 0.0421 ndcg@40: 0.0525 ] 
2024-11-16 06:59:33,263 - [Epoch  18 /  30] bpr_loss: 53.8533 reg_loss: 1.8913 ss_loss: 65.2689 
2024-11-16 06:59:33,645 - Epoch  18 Test set [recall@10: 0.0287 recall@20: 0.0444 recall@40: 0.0684 ] Test set [ndcg@10: 0.0351 ndcg@20: 0.0420 ndcg@40: 0.0531 ] 
2024-11-16 06:59:34,763 - [Epoch  19 /  30] bpr_loss: 52.0572 reg_loss: 1.9629 ss_loss: 65.3713 
2024-11-16 06:59:35,197 - Epoch  19 Test set [recall@10: 0.0291 recall@20: 0.0460 recall@40: 0.0691 ] Test set [ndcg@10: 0.0361 ndcg@20: 0.0436 ndcg@40: 0.0543 ] 
2024-11-16 06:59:36,321 - [Epoch  20 /  30] bpr_loss: 50.8573 reg_loss: 2.0327 ss_loss: 65.2096 
2024-11-16 06:59:36,711 - Epoch  20 Test set [recall@10: 0.0282 recall@20: 0.0453 recall@40: 0.0685 ] Test set [ndcg@10: 0.0352 ndcg@20: 0.0428 ndcg@40: 0.0535 ] 
2024-11-16 06:59:38,066 - [Epoch  21 /  30] bpr_loss: 50.1890 reg_loss: 2.1031 ss_loss: 65.6192 
2024-11-16 06:59:38,484 - Epoch  21 Test set [recall@10: 0.0280 recall@20: 0.0445 recall@40: 0.0690 ] Test set [ndcg@10: 0.0344 ndcg@20: 0.0418 ndcg@40: 0.0531 ] 
2024-11-16 06:59:39,642 - [Epoch  22 /  30] bpr_loss: 48.7568 reg_loss: 2.1725 ss_loss: 65.0572 
2024-11-16 06:59:40,135 - Epoch  22 Test set [recall@10: 0.0281 recall@20: 0.0445 recall@40: 0.0682 ] Test set [ndcg@10: 0.0350 ndcg@20: 0.0422 ndcg@40: 0.0532 ] 
2024-11-16 06:59:41,386 - [Epoch  23 /  30] bpr_loss: 47.6416 reg_loss: 2.2396 ss_loss: 65.1501 
2024-11-16 06:59:41,890 - Epoch  23 Test set [recall@10: 0.0290 recall@20: 0.0457 recall@40: 0.0700 ] Test set [ndcg@10: 0.0359 ndcg@20: 0.0433 ndcg@40: 0.0545 ] 
2024-11-16 06:59:43,104 - [Epoch  24 /  30] bpr_loss: 46.7606 reg_loss: 2.3055 ss_loss: 65.0186 
2024-11-16 06:59:43,539 - Epoch  24 Test set [recall@10: 0.0284 recall@20: 0.0447 recall@40: 0.0695 ] Test set [ndcg@10: 0.0358 ndcg@20: 0.0430 ndcg@40: 0.0544 ] 
2024-11-16 06:59:44,742 - [Epoch  25 /  30] bpr_loss: 45.9041 reg_loss: 2.3691 ss_loss: 64.8730 
2024-11-16 06:59:45,127 - Epoch  25 Test set [recall@10: 0.0289 recall@20: 0.0459 recall@40: 0.0708 ] Test set [ndcg@10: 0.0364 ndcg@20: 0.0440 ndcg@40: 0.0554 ] 
2024-11-16 06:59:46,463 - [Epoch  26 /  30] bpr_loss: 45.6447 reg_loss: 2.4323 ss_loss: 64.7566 
2024-11-16 06:59:46,867 - Epoch  26 Test set [recall@10: 0.0289 recall@20: 0.0452 recall@40: 0.0704 ] Test set [ndcg@10: 0.0364 ndcg@20: 0.0436 ndcg@40: 0.0551 ] 
2024-11-16 06:59:48,019 - [Epoch  27 /  30] bpr_loss: 44.0061 reg_loss: 2.4964 ss_loss: 64.8260 
2024-11-16 06:59:48,421 - Epoch  27 Test set [recall@10: 0.0287 recall@20: 0.0451 recall@40: 0.0702 ] Test set [ndcg@10: 0.0363 ndcg@20: 0.0435 ndcg@40: 0.0551 ] 
2024-11-16 06:59:49,687 - [Epoch  28 /  30] bpr_loss: 43.1192 reg_loss: 2.5583 ss_loss: 64.6670 
2024-11-16 06:59:50,222 - Epoch  28 Test set [recall@10: 0.0282 recall@20: 0.0444 recall@40: 0.0697 ] Test set [ndcg@10: 0.0359 ndcg@20: 0.0431 ndcg@40: 0.0546 ] 
2024-11-16 06:59:51,555 - [Epoch  29 /  30] bpr_loss: 41.5038 reg_loss: 2.6179 ss_loss: 64.1890 
2024-11-16 06:59:52,062 - Epoch  29 Test set [recall@10: 0.0284 recall@20: 0.0454 recall@40: 0.0693 ] Test set [ndcg@10: 0.0360 ndcg@20: 0.0435 ndcg@40: 0.0545 ] 
2024-11-16 06:59:52,554 - Test set [recall@10: 0.0284 recall@20: 0.0454 recall@40: 0.0693 ] Test set [ndcg@10: 0.0360 ndcg@20: 0.0435 ndcg@40: 0.0545 ] 
2024-11-16 06:59:53,047 - Test set [recall@10: 0.0284 recall@20: 0.0454 recall@40: 0.0693 ] Test set [ndcg@10: 0.0360 ndcg@20: 0.0435 ndcg@40: 0.0545 ] 
