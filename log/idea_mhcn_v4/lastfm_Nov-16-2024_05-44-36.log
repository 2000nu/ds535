2024-11-16 05:44:36,274 - {'optimizer': {'name': 'adam', 'lr': 0.001, 'weight_decay': 0}, 'train': {'epoch': 30, 'batch_size': 2000, 'save_model': False, 'loss': 'pairwise', 'test_step': 1, 'reproducible': True, 'seed': 2023, 'tensorboard': True, 'log_loss': True, 'early_stop': False}, 'test': {'metrics': ['recall', 'ndcg'], 'k': [10, 20, 40], 'batch_size': 512}, 'data': {'type': 'social', 'name': 'lastfm', 'user_num': 1892, 'item_num': 17632}, 'model': {'name': 'idea_mhcn_v4', 'layer_num': 2, 'reg_weight': 0.001, 'embedding_size': 64, 'ss_rate': 0.01}, 'tune': {'enable': False, 'hyperparameters': ['cl_weight', 'temperature', 'sampling_ratio'], 'cl_weight': [1.0, 0.1, 0.01, 0.001], 'temperature': [0.1, 0.2, 0.3, 0.4, 0.5], 'sampling_ratio': [0.5, 0.6, 0.7, 0.8, 0.9, 1.0]}, 'device': 'cuda', 'log': True}
2024-11-16 05:44:38,379 - [Epoch   0 /  30] bpr_loss: 190.4716 reg_loss: 0.4984 ss_loss: 68.5237 
2024-11-16 05:44:38,937 - Epoch   0 Test set [recall@10: 0.0263 recall@20: 0.0406 recall@40: 0.0640 ] Test set [ndcg@10: 0.0318 ndcg@20: 0.0381 ndcg@40: 0.0488 ] 
2024-11-16 05:44:40,245 - [Epoch   1 /  30] bpr_loss: 121.9667 reg_loss: 0.5713 ss_loss: 52.4869 
2024-11-16 05:44:40,729 - Epoch   1 Test set [recall@10: 0.0255 recall@20: 0.0405 recall@40: 0.0620 ] Test set [ndcg@10: 0.0319 ndcg@20: 0.0386 ndcg@40: 0.0486 ] 
2024-11-16 05:44:41,971 - [Epoch   2 /  30] bpr_loss: 105.6071 reg_loss: 0.6463 ss_loss: 46.6540 
2024-11-16 05:44:42,681 - Epoch   2 Test set [recall@10: 0.0262 recall@20: 0.0406 recall@40: 0.0636 ] Test set [ndcg@10: 0.0329 ndcg@20: 0.0391 ndcg@40: 0.0497 ] 
2024-11-16 05:44:44,028 - [Epoch   3 /  30] bpr_loss: 96.6280 reg_loss: 0.7305 ss_loss: 43.3260 
2024-11-16 05:44:44,492 - Epoch   3 Test set [recall@10: 0.0259 recall@20: 0.0405 recall@40: 0.0622 ] Test set [ndcg@10: 0.0326 ndcg@20: 0.0389 ndcg@40: 0.0490 ] 
2024-11-16 05:44:45,967 - [Epoch   4 /  30] bpr_loss: 92.2456 reg_loss: 0.8217 ss_loss: 41.1164 
2024-11-16 05:44:46,374 - Epoch   4 Test set [recall@10: 0.0263 recall@20: 0.0413 recall@40: 0.0635 ] Test set [ndcg@10: 0.0332 ndcg@20: 0.0398 ndcg@40: 0.0500 ] 
2024-11-16 05:44:47,573 - [Epoch   5 /  30] bpr_loss: 85.6281 reg_loss: 0.9175 ss_loss: 39.4438 
2024-11-16 05:44:47,963 - Epoch   5 Test set [recall@10: 0.0268 recall@20: 0.0413 recall@40: 0.0641 ] Test set [ndcg@10: 0.0336 ndcg@20: 0.0399 ndcg@40: 0.0503 ] 
2024-11-16 05:44:49,550 - [Epoch   6 /  30] bpr_loss: 82.0485 reg_loss: 1.0164 ss_loss: 39.1937 
2024-11-16 05:44:50,037 - Epoch   6 Test set [recall@10: 0.0276 recall@20: 0.0428 recall@40: 0.0659 ] Test set [ndcg@10: 0.0345 ndcg@20: 0.0411 ndcg@40: 0.0518 ] 
2024-11-16 05:44:51,270 - [Epoch   7 /  30] bpr_loss: 77.7993 reg_loss: 1.1172 ss_loss: 37.7599 
2024-11-16 05:44:51,715 - Epoch   7 Test set [recall@10: 0.0276 recall@20: 0.0418 recall@40: 0.0660 ] Test set [ndcg@10: 0.0343 ndcg@20: 0.0404 ndcg@40: 0.0516 ] 
2024-11-16 05:44:52,949 - [Epoch   8 /  30] bpr_loss: 73.5792 reg_loss: 1.2187 ss_loss: 37.0920 
2024-11-16 05:44:53,351 - Epoch   8 Test set [recall@10: 0.0275 recall@20: 0.0422 recall@40: 0.0654 ] Test set [ndcg@10: 0.0340 ndcg@20: 0.0404 ndcg@40: 0.0511 ] 
2024-11-16 05:44:54,736 - [Epoch   9 /  30] bpr_loss: 72.2024 reg_loss: 1.3190 ss_loss: 36.8243 
2024-11-16 05:44:55,235 - Epoch   9 Test set [recall@10: 0.0271 recall@20: 0.0425 recall@40: 0.0659 ] Test set [ndcg@10: 0.0335 ndcg@20: 0.0403 ndcg@40: 0.0511 ] 
2024-11-16 05:44:56,824 - [Epoch  10 /  30] bpr_loss: 68.9453 reg_loss: 1.4200 ss_loss: 36.2729 
2024-11-16 05:44:57,304 - Epoch  10 Test set [recall@10: 0.0269 recall@20: 0.0432 recall@40: 0.0680 ] Test set [ndcg@10: 0.0334 ndcg@20: 0.0408 ndcg@40: 0.0521 ] 
2024-11-16 05:44:58,552 - [Epoch  11 /  30] bpr_loss: 66.8766 reg_loss: 1.5200 ss_loss: 35.7848 
2024-11-16 05:44:58,942 - Epoch  11 Test set [recall@10: 0.0269 recall@20: 0.0440 recall@40: 0.0682 ] Test set [ndcg@10: 0.0340 ndcg@20: 0.0416 ndcg@40: 0.0528 ] 
2024-11-16 05:45:00,288 - [Epoch  12 /  30] bpr_loss: 63.4641 reg_loss: 1.6179 ss_loss: 35.7341 
2024-11-16 05:45:00,677 - Epoch  12 Test set [recall@10: 0.0278 recall@20: 0.0436 recall@40: 0.0673 ] Test set [ndcg@10: 0.0343 ndcg@20: 0.0413 ndcg@40: 0.0522 ] 
2024-11-16 05:45:01,967 - [Epoch  13 /  30] bpr_loss: 61.9751 reg_loss: 1.7139 ss_loss: 35.0586 
2024-11-16 05:45:02,376 - Epoch  13 Test set [recall@10: 0.0270 recall@20: 0.0437 recall@40: 0.0682 ] Test set [ndcg@10: 0.0341 ndcg@20: 0.0417 ndcg@40: 0.0529 ] 
2024-11-16 05:45:03,860 - [Epoch  14 /  30] bpr_loss: 59.4542 reg_loss: 1.8081 ss_loss: 34.6607 
2024-11-16 05:45:04,261 - Epoch  14 Test set [recall@10: 0.0273 recall@20: 0.0438 recall@40: 0.0679 ] Test set [ndcg@10: 0.0342 ndcg@20: 0.0415 ndcg@40: 0.0527 ] 
2024-11-16 05:45:05,618 - [Epoch  15 /  30] bpr_loss: 59.2843 reg_loss: 1.9011 ss_loss: 35.2583 
2024-11-16 05:45:06,111 - Epoch  15 Test set [recall@10: 0.0273 recall@20: 0.0441 recall@40: 0.0682 ] Test set [ndcg@10: 0.0344 ndcg@20: 0.0420 ndcg@40: 0.0531 ] 
2024-11-16 05:45:07,482 - [Epoch  16 /  30] bpr_loss: 57.3606 reg_loss: 1.9926 ss_loss: 34.3724 
2024-11-16 05:45:07,998 - Epoch  16 Test set [recall@10: 0.0274 recall@20: 0.0444 recall@40: 0.0686 ] Test set [ndcg@10: 0.0344 ndcg@20: 0.0421 ndcg@40: 0.0533 ] 
2024-11-16 05:45:09,350 - [Epoch  17 /  30] bpr_loss: 54.8346 reg_loss: 2.0813 ss_loss: 34.2625 
2024-11-16 05:45:09,750 - Epoch  17 Test set [recall@10: 0.0278 recall@20: 0.0455 recall@40: 0.0689 ] Test set [ndcg@10: 0.0350 ndcg@20: 0.0430 ndcg@40: 0.0538 ] 
2024-11-16 05:45:10,881 - [Epoch  18 /  30] bpr_loss: 54.1469 reg_loss: 2.1681 ss_loss: 33.7551 
2024-11-16 05:45:11,263 - Epoch  18 Test set [recall@10: 0.0283 recall@20: 0.0454 recall@40: 0.0685 ] Test set [ndcg@10: 0.0353 ndcg@20: 0.0430 ndcg@40: 0.0536 ] 
2024-11-16 05:45:12,649 - [Epoch  19 /  30] bpr_loss: 52.3120 reg_loss: 2.2532 ss_loss: 33.6624 
2024-11-16 05:45:13,149 - Epoch  19 Test set [recall@10: 0.0288 recall@20: 0.0456 recall@40: 0.0706 ] Test set [ndcg@10: 0.0362 ndcg@20: 0.0437 ndcg@40: 0.0551 ] 
2024-11-16 05:45:14,356 - [Epoch  20 /  30] bpr_loss: 51.2147 reg_loss: 2.3368 ss_loss: 33.5871 
2024-11-16 05:45:14,752 - Epoch  20 Test set [recall@10: 0.0287 recall@20: 0.0455 recall@40: 0.0696 ] Test set [ndcg@10: 0.0359 ndcg@20: 0.0434 ndcg@40: 0.0545 ] 
2024-11-16 05:45:16,212 - [Epoch  21 /  30] bpr_loss: 50.6502 reg_loss: 2.4195 ss_loss: 33.5972 
2024-11-16 05:45:16,618 - Epoch  21 Test set [recall@10: 0.0285 recall@20: 0.0453 recall@40: 0.0694 ] Test set [ndcg@10: 0.0353 ndcg@20: 0.0427 ndcg@40: 0.0538 ] 
2024-11-16 05:45:17,877 - [Epoch  22 /  30] bpr_loss: 49.0516 reg_loss: 2.5010 ss_loss: 33.2679 
2024-11-16 05:45:18,348 - Epoch  22 Test set [recall@10: 0.0286 recall@20: 0.0453 recall@40: 0.0703 ] Test set [ndcg@10: 0.0358 ndcg@20: 0.0432 ndcg@40: 0.0547 ] 
2024-11-16 05:45:19,642 - [Epoch  23 /  30] bpr_loss: 47.8344 reg_loss: 2.5793 ss_loss: 33.0975 
2024-11-16 05:45:20,063 - Epoch  23 Test set [recall@10: 0.0293 recall@20: 0.0454 recall@40: 0.0703 ] Test set [ndcg@10: 0.0368 ndcg@20: 0.0438 ndcg@40: 0.0553 ] 
2024-11-16 05:45:21,237 - [Epoch  24 /  30] bpr_loss: 47.1565 reg_loss: 2.6565 ss_loss: 33.0927 
2024-11-16 05:45:21,619 - Epoch  24 Test set [recall@10: 0.0286 recall@20: 0.0457 recall@40: 0.0707 ] Test set [ndcg@10: 0.0364 ndcg@20: 0.0440 ndcg@40: 0.0554 ] 
2024-11-16 05:45:22,641 - [Epoch  25 /  30] bpr_loss: 46.3658 reg_loss: 2.7313 ss_loss: 32.4054 
2024-11-16 05:45:23,015 - Epoch  25 Test set [recall@10: 0.0288 recall@20: 0.0456 recall@40: 0.0707 ] Test set [ndcg@10: 0.0366 ndcg@20: 0.0441 ndcg@40: 0.0556 ] 
2024-11-16 05:45:24,090 - [Epoch  26 /  30] bpr_loss: 46.0617 reg_loss: 2.8058 ss_loss: 32.6964 
2024-11-16 05:45:24,464 - Epoch  26 Test set [recall@10: 0.0287 recall@20: 0.0452 recall@40: 0.0708 ] Test set [ndcg@10: 0.0367 ndcg@20: 0.0440 ndcg@40: 0.0557 ] 
2024-11-16 05:45:25,502 - [Epoch  27 /  30] bpr_loss: 44.3367 reg_loss: 2.8811 ss_loss: 31.8381 
2024-11-16 05:45:26,024 - Epoch  27 Test set [recall@10: 0.0281 recall@20: 0.0453 recall@40: 0.0699 ] Test set [ndcg@10: 0.0359 ndcg@20: 0.0436 ndcg@40: 0.0549 ] 
2024-11-16 05:45:27,133 - [Epoch  28 /  30] bpr_loss: 43.5060 reg_loss: 2.9541 ss_loss: 31.9641 
2024-11-16 05:45:27,627 - Epoch  28 Test set [recall@10: 0.0281 recall@20: 0.0449 recall@40: 0.0693 ] Test set [ndcg@10: 0.0359 ndcg@20: 0.0434 ndcg@40: 0.0546 ] 
2024-11-16 05:45:28,734 - [Epoch  29 /  30] bpr_loss: 41.7922 reg_loss: 3.0233 ss_loss: 31.8823 
2024-11-16 05:45:29,110 - Epoch  29 Test set [recall@10: 0.0282 recall@20: 0.0456 recall@40: 0.0709 ] Test set [ndcg@10: 0.0361 ndcg@20: 0.0440 ndcg@40: 0.0556 ] 
2024-11-16 05:45:29,479 - Test set [recall@10: 0.0282 recall@20: 0.0456 recall@40: 0.0709 ] Test set [ndcg@10: 0.0361 ndcg@20: 0.0440 ndcg@40: 0.0556 ] 
2024-11-16 05:45:29,849 - Test set [recall@10: 0.0282 recall@20: 0.0456 recall@40: 0.0709 ] Test set [ndcg@10: 0.0361 ndcg@20: 0.0440 ndcg@40: 0.0556 ] 
