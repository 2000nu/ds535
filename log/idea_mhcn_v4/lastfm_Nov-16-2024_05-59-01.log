2024-11-16 05:59:01,779 - {'optimizer': {'name': 'adam', 'lr': 0.001, 'weight_decay': 0}, 'train': {'epoch': 30, 'batch_size': 2000, 'save_model': False, 'loss': 'pairwise', 'test_step': 1, 'reproducible': True, 'seed': 2023, 'tensorboard': True, 'log_loss': True, 'early_stop': False}, 'test': {'metrics': ['recall', 'ndcg'], 'k': [10, 20, 40], 'batch_size': 512}, 'data': {'type': 'social', 'name': 'lastfm', 'user_num': 1892, 'item_num': 17632}, 'model': {'name': 'idea_mhcn_v4', 'layer_num': 2, 'reg_weight': 0.001, 'embedding_size': 64, 'ss_rate': 0.01}, 'tune': {'enable': False, 'hyperparameters': ['cl_weight', 'temperature', 'sampling_ratio'], 'cl_weight': [1.0, 0.1, 0.01, 0.001], 'temperature': [0.1, 0.2, 0.3, 0.4, 0.5], 'sampling_ratio': [0.5, 0.6, 0.7, 0.8, 0.9, 1.0]}, 'device': 'cuda', 'log': True}
2024-11-16 05:59:03,593 - [Epoch   0 /  30] bpr_loss: 190.2727 reg_loss: 0.4985 ss_loss: 68.3580 
2024-11-16 05:59:04,026 - Epoch   0 Test set [recall@10: 0.0262 recall@20: 0.0405 recall@40: 0.0642 ] Test set [ndcg@10: 0.0317 ndcg@20: 0.0380 ndcg@40: 0.0489 ] 
2024-11-16 05:59:05,198 - [Epoch   1 /  30] bpr_loss: 121.9617 reg_loss: 0.5715 ss_loss: 52.3681 
2024-11-16 05:59:05,651 - Epoch   1 Test set [recall@10: 0.0255 recall@20: 0.0404 recall@40: 0.0625 ] Test set [ndcg@10: 0.0320 ndcg@20: 0.0386 ndcg@40: 0.0488 ] 
2024-11-16 05:59:06,868 - [Epoch   2 /  30] bpr_loss: 105.5730 reg_loss: 0.6466 ss_loss: 46.5388 
2024-11-16 05:59:07,497 - Epoch   2 Test set [recall@10: 0.0263 recall@20: 0.0407 recall@40: 0.0634 ] Test set [ndcg@10: 0.0329 ndcg@20: 0.0391 ndcg@40: 0.0496 ] 
2024-11-16 05:59:09,045 - [Epoch   3 /  30] bpr_loss: 96.6428 reg_loss: 0.7308 ss_loss: 43.1710 
2024-11-16 05:59:09,449 - Epoch   3 Test set [recall@10: 0.0258 recall@20: 0.0405 recall@40: 0.0624 ] Test set [ndcg@10: 0.0325 ndcg@20: 0.0389 ndcg@40: 0.0490 ] 
2024-11-16 05:59:10,658 - [Epoch   4 /  30] bpr_loss: 92.2420 reg_loss: 0.8222 ss_loss: 41.0054 
2024-11-16 05:59:11,037 - Epoch   4 Test set [recall@10: 0.0265 recall@20: 0.0410 recall@40: 0.0637 ] Test set [ndcg@10: 0.0334 ndcg@20: 0.0397 ndcg@40: 0.0501 ] 
2024-11-16 05:59:12,263 - [Epoch   5 /  30] bpr_loss: 85.6146 reg_loss: 0.9180 ss_loss: 39.3850 
2024-11-16 05:59:12,654 - Epoch   5 Test set [recall@10: 0.0267 recall@20: 0.0410 recall@40: 0.0640 ] Test set [ndcg@10: 0.0335 ndcg@20: 0.0397 ndcg@40: 0.0503 ] 
2024-11-16 05:59:13,930 - [Epoch   6 /  30] bpr_loss: 82.0263 reg_loss: 1.0169 ss_loss: 39.0648 
2024-11-16 05:59:14,320 - Epoch   6 Test set [recall@10: 0.0279 recall@20: 0.0426 recall@40: 0.0658 ] Test set [ndcg@10: 0.0346 ndcg@20: 0.0410 ndcg@40: 0.0517 ] 
2024-11-16 05:59:15,752 - [Epoch   7 /  30] bpr_loss: 77.8013 reg_loss: 1.1177 ss_loss: 37.5949 
2024-11-16 05:59:16,169 - Epoch   7 Test set [recall@10: 0.0276 recall@20: 0.0417 recall@40: 0.0659 ] Test set [ndcg@10: 0.0343 ndcg@20: 0.0403 ndcg@40: 0.0515 ] 
2024-11-16 05:59:17,319 - [Epoch   8 /  30] bpr_loss: 73.6066 reg_loss: 1.2192 ss_loss: 36.9711 
2024-11-16 05:59:17,703 - Epoch   8 Test set [recall@10: 0.0273 recall@20: 0.0422 recall@40: 0.0654 ] Test set [ndcg@10: 0.0338 ndcg@20: 0.0404 ndcg@40: 0.0511 ] 
2024-11-16 05:59:18,877 - [Epoch   9 /  30] bpr_loss: 72.2366 reg_loss: 1.3194 ss_loss: 36.7060 
2024-11-16 05:59:19,265 - Epoch   9 Test set [recall@10: 0.0272 recall@20: 0.0428 recall@40: 0.0657 ] Test set [ndcg@10: 0.0335 ndcg@20: 0.0404 ndcg@40: 0.0510 ] 
2024-11-16 05:59:20,702 - [Epoch  10 /  30] bpr_loss: 68.9307 reg_loss: 1.4202 ss_loss: 36.1283 
2024-11-16 05:59:21,167 - Epoch  10 Test set [recall@10: 0.0270 recall@20: 0.0429 recall@40: 0.0676 ] Test set [ndcg@10: 0.0335 ndcg@20: 0.0406 ndcg@40: 0.0520 ] 
2024-11-16 05:59:22,617 - [Epoch  11 /  30] bpr_loss: 66.8840 reg_loss: 1.5200 ss_loss: 35.7015 
2024-11-16 05:59:23,026 - Epoch  11 Test set [recall@10: 0.0271 recall@20: 0.0439 recall@40: 0.0684 ] Test set [ndcg@10: 0.0341 ndcg@20: 0.0415 ndcg@40: 0.0529 ] 
2024-11-16 05:59:24,239 - [Epoch  12 /  30] bpr_loss: 63.4737 reg_loss: 1.6179 ss_loss: 35.5603 
2024-11-16 05:59:24,620 - Epoch  12 Test set [recall@10: 0.0277 recall@20: 0.0437 recall@40: 0.0676 ] Test set [ndcg@10: 0.0344 ndcg@20: 0.0415 ndcg@40: 0.0524 ] 
2024-11-16 05:59:26,034 - [Epoch  13 /  30] bpr_loss: 61.9843 reg_loss: 1.7138 ss_loss: 34.9080 
2024-11-16 05:59:26,468 - Epoch  13 Test set [recall@10: 0.0272 recall@20: 0.0440 recall@40: 0.0680 ] Test set [ndcg@10: 0.0342 ndcg@20: 0.0417 ndcg@40: 0.0528 ] 
2024-11-16 05:59:27,982 - [Epoch  14 /  30] bpr_loss: 59.4234 reg_loss: 1.8079 ss_loss: 34.3854 
2024-11-16 05:59:28,384 - Epoch  14 Test set [recall@10: 0.0275 recall@20: 0.0438 recall@40: 0.0680 ] Test set [ndcg@10: 0.0343 ndcg@20: 0.0416 ndcg@40: 0.0527 ] 
2024-11-16 05:59:29,589 - [Epoch  15 /  30] bpr_loss: 59.2875 reg_loss: 1.9008 ss_loss: 35.0282 
2024-11-16 05:59:30,079 - Epoch  15 Test set [recall@10: 0.0275 recall@20: 0.0440 recall@40: 0.0685 ] Test set [ndcg@10: 0.0348 ndcg@20: 0.0422 ndcg@40: 0.0534 ] 
2024-11-16 05:59:31,216 - [Epoch  16 /  30] bpr_loss: 57.3587 reg_loss: 1.9921 ss_loss: 34.2021 
2024-11-16 05:59:31,707 - Epoch  16 Test set [recall@10: 0.0273 recall@20: 0.0450 recall@40: 0.0686 ] Test set [ndcg@10: 0.0344 ndcg@20: 0.0424 ndcg@40: 0.0533 ] 
2024-11-16 05:59:33,021 - [Epoch  17 /  30] bpr_loss: 54.8088 reg_loss: 2.0807 ss_loss: 34.2151 
2024-11-16 05:59:33,421 - Epoch  17 Test set [recall@10: 0.0284 recall@20: 0.0454 recall@40: 0.0687 ] Test set [ndcg@10: 0.0353 ndcg@20: 0.0430 ndcg@40: 0.0537 ] 
2024-11-16 05:59:34,644 - [Epoch  18 /  30] bpr_loss: 54.1290 reg_loss: 2.1671 ss_loss: 33.5416 
2024-11-16 05:59:35,092 - Epoch  18 Test set [recall@10: 0.0281 recall@20: 0.0453 recall@40: 0.0686 ] Test set [ndcg@10: 0.0350 ndcg@20: 0.0428 ndcg@40: 0.0536 ] 
2024-11-16 05:59:36,460 - [Epoch  19 /  30] bpr_loss: 52.2914 reg_loss: 2.2520 ss_loss: 33.5445 
2024-11-16 05:59:36,873 - Epoch  19 Test set [recall@10: 0.0287 recall@20: 0.0459 recall@40: 0.0706 ] Test set [ndcg@10: 0.0361 ndcg@20: 0.0438 ndcg@40: 0.0551 ] 
2024-11-16 05:59:38,012 - [Epoch  20 /  30] bpr_loss: 51.1986 reg_loss: 2.3352 ss_loss: 33.4462 
2024-11-16 05:59:38,421 - Epoch  20 Test set [recall@10: 0.0286 recall@20: 0.0457 recall@40: 0.0697 ] Test set [ndcg@10: 0.0359 ndcg@20: 0.0436 ndcg@40: 0.0545 ] 
2024-11-16 05:59:39,752 - [Epoch  21 /  30] bpr_loss: 50.6380 reg_loss: 2.4177 ss_loss: 33.3665 
2024-11-16 05:59:40,161 - Epoch  21 Test set [recall@10: 0.0285 recall@20: 0.0451 recall@40: 0.0691 ] Test set [ndcg@10: 0.0352 ndcg@20: 0.0426 ndcg@40: 0.0536 ] 
2024-11-16 05:59:41,588 - [Epoch  22 /  30] bpr_loss: 49.0711 reg_loss: 2.4991 ss_loss: 33.1163 
2024-11-16 05:59:42,036 - Epoch  22 Test set [recall@10: 0.0288 recall@20: 0.0452 recall@40: 0.0702 ] Test set [ndcg@10: 0.0360 ndcg@20: 0.0432 ndcg@40: 0.0547 ] 
2024-11-16 05:59:43,264 - [Epoch  23 /  30] bpr_loss: 47.8328 reg_loss: 2.5773 ss_loss: 33.0010 
2024-11-16 05:59:43,754 - Epoch  23 Test set [recall@10: 0.0294 recall@20: 0.0453 recall@40: 0.0706 ] Test set [ndcg@10: 0.0371 ndcg@20: 0.0439 ndcg@40: 0.0555 ] 
2024-11-16 05:59:44,857 - [Epoch  24 /  30] bpr_loss: 47.1546 reg_loss: 2.6545 ss_loss: 32.9492 
2024-11-16 05:59:45,348 - Epoch  24 Test set [recall@10: 0.0289 recall@20: 0.0457 recall@40: 0.0708 ] Test set [ndcg@10: 0.0365 ndcg@20: 0.0439 ndcg@40: 0.0554 ] 
2024-11-16 05:59:46,488 - [Epoch  25 /  30] bpr_loss: 46.3636 reg_loss: 2.7294 ss_loss: 32.3350 
2024-11-16 05:59:46,865 - Epoch  25 Test set [recall@10: 0.0291 recall@20: 0.0458 recall@40: 0.0705 ] Test set [ndcg@10: 0.0368 ndcg@20: 0.0441 ndcg@40: 0.0555 ] 
2024-11-16 05:59:48,079 - [Epoch  26 /  30] bpr_loss: 46.0727 reg_loss: 2.8039 ss_loss: 32.5468 
2024-11-16 05:59:48,489 - Epoch  26 Test set [recall@10: 0.0288 recall@20: 0.0451 recall@40: 0.0707 ] Test set [ndcg@10: 0.0368 ndcg@20: 0.0440 ndcg@40: 0.0557 ] 
2024-11-16 05:59:49,628 - [Epoch  27 /  30] bpr_loss: 44.3484 reg_loss: 2.8794 ss_loss: 31.6353 
2024-11-16 05:59:50,015 - Epoch  27 Test set [recall@10: 0.0282 recall@20: 0.0452 recall@40: 0.0694 ] Test set [ndcg@10: 0.0360 ndcg@20: 0.0435 ndcg@40: 0.0547 ] 
2024-11-16 05:59:51,079 - [Epoch  28 /  30] bpr_loss: 43.5174 reg_loss: 2.9524 ss_loss: 31.8340 
2024-11-16 05:59:51,579 - Epoch  28 Test set [recall@10: 0.0282 recall@20: 0.0452 recall@40: 0.0692 ] Test set [ndcg@10: 0.0362 ndcg@20: 0.0437 ndcg@40: 0.0547 ] 
2024-11-16 05:59:52,909 - [Epoch  29 /  30] bpr_loss: 41.8015 reg_loss: 3.0218 ss_loss: 31.7481 
2024-11-16 05:59:53,293 - Epoch  29 Test set [recall@10: 0.0284 recall@20: 0.0457 recall@40: 0.0708 ] Test set [ndcg@10: 0.0364 ndcg@20: 0.0441 ndcg@40: 0.0556 ] 
2024-11-16 05:59:53,659 - Test set [recall@10: 0.0284 recall@20: 0.0457 recall@40: 0.0708 ] Test set [ndcg@10: 0.0364 ndcg@20: 0.0441 ndcg@40: 0.0556 ] 
2024-11-16 05:59:54,024 - Test set [recall@10: 0.0284 recall@20: 0.0457 recall@40: 0.0708 ] Test set [ndcg@10: 0.0364 ndcg@20: 0.0441 ndcg@40: 0.0556 ] 
