2024-11-16 07:26:50,112 - {'optimizer': {'name': 'adam', 'lr': 0.001, 'weight_decay': 0}, 'train': {'epoch': 30, 'batch_size': 2000, 'save_model': False, 'loss': 'pairwise', 'test_step': 1, 'reproducible': True, 'seed': 2023, 'tensorboard': True, 'log_loss': True, 'early_stop': False}, 'test': {'metrics': ['recall', 'ndcg'], 'k': [10, 20, 40], 'batch_size': 512}, 'data': {'type': 'social', 'name': 'lastfm', 'user_num': 1892, 'item_num': 17632}, 'model': {'name': 'idea_mhcn_v4', 'layer_num': 2, 'reg_weight': 0.001, 'embedding_size': 64, 'ss_rate': 0.01}, 'tune': {'enable': False, 'hyperparameters': ['cl_weight', 'temperature', 'sampling_ratio'], 'cl_weight': [1.0, 0.1, 0.01, 0.001], 'temperature': [0.1, 0.2, 0.3, 0.4, 0.5], 'sampling_ratio': [0.5, 0.6, 0.7, 0.8, 0.9, 1.0]}, 'device': 'cuda', 'log': True}
2024-11-16 07:26:52,219 - [Epoch   0 /  30] bpr_loss: 201.7046 reg_loss: 0.4992 ss_loss: 80.4373 
2024-11-16 07:26:52,826 - Epoch   0 Test set [recall@10: 0.0256 recall@20: 0.0407 recall@40: 0.0654 ] Test set [ndcg@10: 0.0310 ndcg@20: 0.0378 ndcg@40: 0.0491 ] 
2024-11-16 07:26:54,060 - [Epoch   1 /  30] bpr_loss: 123.0505 reg_loss: 0.5685 ss_loss: 67.9799 
2024-11-16 07:26:54,547 - Epoch   1 Test set [recall@10: 0.0250 recall@20: 0.0401 recall@40: 0.0622 ] Test set [ndcg@10: 0.0310 ndcg@20: 0.0377 ndcg@40: 0.0480 ] 
2024-11-16 07:26:55,773 - [Epoch   2 /  30] bpr_loss: 105.5666 reg_loss: 0.6354 ss_loss: 64.0768 
2024-11-16 07:26:56,149 - Epoch   2 Test set [recall@10: 0.0255 recall@20: 0.0405 recall@40: 0.0634 ] Test set [ndcg@10: 0.0314 ndcg@20: 0.0381 ndcg@40: 0.0486 ] 
2024-11-16 07:26:57,510 - [Epoch   3 /  30] bpr_loss: 96.4357 reg_loss: 0.7093 ss_loss: 61.2700 
2024-11-16 07:26:57,941 - Epoch   3 Test set [recall@10: 0.0254 recall@20: 0.0406 recall@40: 0.0622 ] Test set [ndcg@10: 0.0312 ndcg@20: 0.0380 ndcg@40: 0.0479 ] 
2024-11-16 07:26:59,112 - [Epoch   4 /  30] bpr_loss: 91.4642 reg_loss: 0.7889 ss_loss: 60.2012 
2024-11-16 07:26:59,504 - Epoch   4 Test set [recall@10: 0.0261 recall@20: 0.0405 recall@40: 0.0635 ] Test set [ndcg@10: 0.0324 ndcg@20: 0.0387 ndcg@40: 0.0492 ] 
2024-11-16 07:27:00,745 - [Epoch   5 /  30] bpr_loss: 84.7872 reg_loss: 0.8715 ss_loss: 59.3132 
2024-11-16 07:27:01,203 - Epoch   5 Test set [recall@10: 0.0261 recall@20: 0.0407 recall@40: 0.0629 ] Test set [ndcg@10: 0.0323 ndcg@20: 0.0388 ndcg@40: 0.0490 ] 
2024-11-16 07:27:02,502 - [Epoch   6 /  30] bpr_loss: 81.2280 reg_loss: 0.9560 ss_loss: 58.8895 
2024-11-16 07:27:02,924 - Epoch   6 Test set [recall@10: 0.0276 recall@20: 0.0420 recall@40: 0.0659 ] Test set [ndcg@10: 0.0335 ndcg@20: 0.0398 ndcg@40: 0.0507 ] 
2024-11-16 07:27:04,098 - [Epoch   7 /  30] bpr_loss: 76.9881 reg_loss: 1.0423 ss_loss: 58.7418 
2024-11-16 07:27:04,524 - Epoch   7 Test set [recall@10: 0.0272 recall@20: 0.0421 recall@40: 0.0658 ] Test set [ndcg@10: 0.0331 ndcg@20: 0.0397 ndcg@40: 0.0507 ] 
2024-11-16 07:27:05,771 - [Epoch   8 /  30] bpr_loss: 73.0644 reg_loss: 1.1297 ss_loss: 57.5470 
2024-11-16 07:27:06,194 - Epoch   8 Test set [recall@10: 0.0273 recall@20: 0.0421 recall@40: 0.0652 ] Test set [ndcg@10: 0.0330 ndcg@20: 0.0396 ndcg@40: 0.0502 ] 
2024-11-16 07:27:07,556 - [Epoch   9 /  30] bpr_loss: 71.4000 reg_loss: 1.2166 ss_loss: 57.6455 
2024-11-16 07:27:08,090 - Epoch   9 Test set [recall@10: 0.0262 recall@20: 0.0429 recall@40: 0.0666 ] Test set [ndcg@10: 0.0321 ndcg@20: 0.0398 ndcg@40: 0.0507 ] 
2024-11-16 07:27:09,450 - [Epoch  10 /  30] bpr_loss: 68.2266 reg_loss: 1.3037 ss_loss: 56.5813 
2024-11-16 07:27:09,954 - Epoch  10 Test set [recall@10: 0.0271 recall@20: 0.0429 recall@40: 0.0667 ] Test set [ndcg@10: 0.0329 ndcg@20: 0.0401 ndcg@40: 0.0511 ] 
2024-11-16 07:27:11,201 - [Epoch  11 /  30] bpr_loss: 65.8968 reg_loss: 1.3920 ss_loss: 56.8465 
2024-11-16 07:27:11,726 - Epoch  11 Test set [recall@10: 0.0274 recall@20: 0.0435 recall@40: 0.0687 ] Test set [ndcg@10: 0.0331 ndcg@20: 0.0404 ndcg@40: 0.0520 ] 
2024-11-16 07:27:12,967 - [Epoch  12 /  30] bpr_loss: 62.7464 reg_loss: 1.4783 ss_loss: 56.4990 
2024-11-16 07:27:13,477 - Epoch  12 Test set [recall@10: 0.0280 recall@20: 0.0434 recall@40: 0.0672 ] Test set [ndcg@10: 0.0338 ndcg@20: 0.0407 ndcg@40: 0.0516 ] 
2024-11-16 07:27:14,798 - [Epoch  13 /  30] bpr_loss: 61.1677 reg_loss: 1.5637 ss_loss: 55.7814 
2024-11-16 07:27:15,320 - Epoch  13 Test set [recall@10: 0.0278 recall@20: 0.0435 recall@40: 0.0678 ] Test set [ndcg@10: 0.0336 ndcg@20: 0.0405 ndcg@40: 0.0518 ] 
2024-11-16 07:27:16,590 - [Epoch  14 /  30] bpr_loss: 58.6464 reg_loss: 1.6477 ss_loss: 55.6270 
2024-11-16 07:27:17,098 - Epoch  14 Test set [recall@10: 0.0273 recall@20: 0.0427 recall@40: 0.0682 ] Test set [ndcg@10: 0.0331 ndcg@20: 0.0401 ndcg@40: 0.0518 ] 
2024-11-16 07:27:18,464 - [Epoch  15 /  30] bpr_loss: 58.3218 reg_loss: 1.7299 ss_loss: 56.4962 
2024-11-16 07:27:18,975 - Epoch  15 Test set [recall@10: 0.0281 recall@20: 0.0439 recall@40: 0.0682 ] Test set [ndcg@10: 0.0338 ndcg@20: 0.0408 ndcg@40: 0.0520 ] 
2024-11-16 07:27:20,335 - [Epoch  16 /  30] bpr_loss: 56.5425 reg_loss: 1.8104 ss_loss: 55.4424 
2024-11-16 07:27:20,887 - Epoch  16 Test set [recall@10: 0.0279 recall@20: 0.0442 recall@40: 0.0687 ] Test set [ndcg@10: 0.0336 ndcg@20: 0.0409 ndcg@40: 0.0522 ] 
2024-11-16 07:27:22,115 - [Epoch  17 /  30] bpr_loss: 54.1147 reg_loss: 1.8895 ss_loss: 56.1049 
2024-11-16 07:27:22,639 - Epoch  17 Test set [recall@10: 0.0284 recall@20: 0.0437 recall@40: 0.0698 ] Test set [ndcg@10: 0.0340 ndcg@20: 0.0408 ndcg@40: 0.0528 ] 
2024-11-16 07:27:23,712 - [Epoch  18 /  30] bpr_loss: 53.4102 reg_loss: 1.9665 ss_loss: 55.0238 
2024-11-16 07:27:24,206 - Epoch  18 Test set [recall@10: 0.0283 recall@20: 0.0440 recall@40: 0.0695 ] Test set [ndcg@10: 0.0339 ndcg@20: 0.0410 ndcg@40: 0.0528 ] 
2024-11-16 07:27:25,280 - [Epoch  19 /  30] bpr_loss: 51.5486 reg_loss: 2.0414 ss_loss: 55.0223 
2024-11-16 07:27:25,774 - Epoch  19 Test set [recall@10: 0.0289 recall@20: 0.0448 recall@40: 0.0711 ] Test set [ndcg@10: 0.0349 ndcg@20: 0.0419 ndcg@40: 0.0540 ] 
2024-11-16 07:27:26,926 - [Epoch  20 /  30] bpr_loss: 50.3784 reg_loss: 2.1155 ss_loss: 54.8429 
2024-11-16 07:27:27,315 - Epoch  20 Test set [recall@10: 0.0288 recall@20: 0.0444 recall@40: 0.0698 ] Test set [ndcg@10: 0.0346 ndcg@20: 0.0416 ndcg@40: 0.0532 ] 
2024-11-16 07:27:28,526 - [Epoch  21 /  30] bpr_loss: 49.5475 reg_loss: 2.1896 ss_loss: 55.1189 
2024-11-16 07:27:28,927 - Epoch  21 Test set [recall@10: 0.0284 recall@20: 0.0443 recall@40: 0.0698 ] Test set [ndcg@10: 0.0338 ndcg@20: 0.0409 ndcg@40: 0.0526 ] 
2024-11-16 07:27:30,340 - [Epoch  22 /  30] bpr_loss: 48.3102 reg_loss: 2.2621 ss_loss: 55.1281 
2024-11-16 07:27:30,741 - Epoch  22 Test set [recall@10: 0.0278 recall@20: 0.0447 recall@40: 0.0698 ] Test set [ndcg@10: 0.0339 ndcg@20: 0.0416 ndcg@40: 0.0531 ] 
2024-11-16 07:27:32,149 - [Epoch  23 /  30] bpr_loss: 46.9753 reg_loss: 2.3320 ss_loss: 54.7378 
2024-11-16 07:27:32,617 - Epoch  23 Test set [recall@10: 0.0288 recall@20: 0.0446 recall@40: 0.0707 ] Test set [ndcg@10: 0.0351 ndcg@20: 0.0421 ndcg@40: 0.0541 ] 
2024-11-16 07:27:34,031 - [Epoch  24 /  30] bpr_loss: 46.3849 reg_loss: 2.4015 ss_loss: 54.6278 
2024-11-16 07:27:34,439 - Epoch  24 Test set [recall@10: 0.0283 recall@20: 0.0446 recall@40: 0.0704 ] Test set [ndcg@10: 0.0348 ndcg@20: 0.0421 ndcg@40: 0.0540 ] 
2024-11-16 07:27:35,597 - [Epoch  25 /  30] bpr_loss: 45.4461 reg_loss: 2.4690 ss_loss: 54.3140 
2024-11-16 07:27:35,971 - Epoch  25 Test set [recall@10: 0.0292 recall@20: 0.0450 recall@40: 0.0708 ] Test set [ndcg@10: 0.0356 ndcg@20: 0.0426 ndcg@40: 0.0544 ] 
2024-11-16 07:27:37,056 - [Epoch  26 /  30] bpr_loss: 45.2198 reg_loss: 2.5379 ss_loss: 54.1119 
2024-11-16 07:27:37,548 - Epoch  26 Test set [recall@10: 0.0286 recall@20: 0.0447 recall@40: 0.0714 ] Test set [ndcg@10: 0.0349 ndcg@20: 0.0421 ndcg@40: 0.0544 ] 
2024-11-16 07:27:38,871 - [Epoch  27 /  30] bpr_loss: 43.3965 reg_loss: 2.6071 ss_loss: 53.9108 
2024-11-16 07:27:39,364 - Epoch  27 Test set [recall@10: 0.0282 recall@20: 0.0440 recall@40: 0.0704 ] Test set [ndcg@10: 0.0349 ndcg@20: 0.0419 ndcg@40: 0.0541 ] 
2024-11-16 07:27:40,450 - [Epoch  28 /  30] bpr_loss: 42.7772 reg_loss: 2.6729 ss_loss: 54.3561 
2024-11-16 07:27:41,009 - Epoch  28 Test set [recall@10: 0.0276 recall@20: 0.0443 recall@40: 0.0701 ] Test set [ndcg@10: 0.0341 ndcg@20: 0.0416 ndcg@40: 0.0535 ] 
2024-11-16 07:27:42,083 - [Epoch  29 /  30] bpr_loss: 41.0214 reg_loss: 2.7366 ss_loss: 53.7625 
2024-11-16 07:27:42,579 - Epoch  29 Test set [recall@10: 0.0284 recall@20: 0.0447 recall@40: 0.0701 ] Test set [ndcg@10: 0.0347 ndcg@20: 0.0420 ndcg@40: 0.0536 ] 
2024-11-16 07:27:43,060 - Test set [recall@10: 0.0284 recall@20: 0.0447 recall@40: 0.0701 ] Test set [ndcg@10: 0.0347 ndcg@20: 0.0420 ndcg@40: 0.0536 ] 
2024-11-16 07:27:43,541 - Test set [recall@10: 0.0284 recall@20: 0.0447 recall@40: 0.0701 ] Test set [ndcg@10: 0.0347 ndcg@20: 0.0420 ndcg@40: 0.0536 ] 
