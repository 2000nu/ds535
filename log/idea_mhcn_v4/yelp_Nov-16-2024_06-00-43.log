2024-11-16 06:00:43,879 - {'optimizer': {'name': 'adam', 'lr': 0.001, 'weight_decay': 0}, 'train': {'epoch': 30, 'batch_size': 2000, 'save_model': False, 'loss': 'pairwise', 'test_step': 1, 'reproducible': True, 'seed': 2023, 'tensorboard': True, 'log_loss': True, 'early_stop': False}, 'test': {'metrics': ['recall', 'ndcg'], 'k': [10, 20, 40], 'batch_size': 512}, 'data': {'type': 'social', 'name': 'yelp', 'user_num': 43043, 'item_num': 66576}, 'model': {'name': 'idea_mhcn_v4', 'layer_num': 2, 'reg_weight': 0.001, 'embedding_size': 64, 'ss_rate': 0.01}, 'tune': {'enable': False, 'hyperparameters': ['cl_weight', 'temperature', 'sampling_ratio'], 'cl_weight': [1.0, 0.1, 0.01, 0.001], 'temperature': [0.1, 0.2, 0.3, 0.4, 0.5], 'sampling_ratio': [0.5, 0.6, 0.7, 0.8, 0.9, 1.0]}, 'device': 'cuda', 'log': True}
2024-11-16 06:00:56,040 - [Epoch   0 /  30] bpr_loss: 208.4122 reg_loss: 0.9872 ss_loss: 1300.0456 
2024-11-16 06:01:12,612 - Epoch   0 Test set [recall@10: 0.0236 recall@20: 0.0394 recall@40: 0.0630 ] Test set [ndcg@10: 0.0117 ndcg@20: 0.0156 ndcg@40: 0.0204 ] 
2024-11-16 06:01:23,226 - [Epoch   1 /  30] bpr_loss: 148.4821 reg_loss: 1.6886 ss_loss: 1058.7536 
2024-11-16 06:01:38,101 - Epoch   1 Test set [recall@10: 0.0257 recall@20: 0.0420 recall@40: 0.0700 ] Test set [ndcg@10: 0.0127 ndcg@20: 0.0168 ndcg@40: 0.0225 ] 
2024-11-16 06:01:48,842 - [Epoch   2 /  30] bpr_loss: 124.8590 reg_loss: 2.3560 ss_loss: 1027.3517 
2024-11-16 06:02:03,080 - Epoch   2 Test set [recall@10: 0.0270 recall@20: 0.0443 recall@40: 0.0732 ] Test set [ndcg@10: 0.0137 ndcg@20: 0.0180 ndcg@40: 0.0239 ] 
2024-11-16 06:02:13,054 - [Epoch   3 /  30] bpr_loss: 113.0911 reg_loss: 3.0332 ss_loss: 1002.7819 
2024-11-16 06:02:27,253 - Epoch   3 Test set [recall@10: 0.0283 recall@20: 0.0465 recall@40: 0.0738 ] Test set [ndcg@10: 0.0141 ndcg@20: 0.0186 ndcg@40: 0.0242 ] 
2024-11-16 06:02:37,394 - [Epoch   4 /  30] bpr_loss: 104.1197 reg_loss: 3.7102 ss_loss: 995.7909 
2024-11-16 06:02:51,114 - Epoch   4 Test set [recall@10: 0.0284 recall@20: 0.0477 recall@40: 0.0756 ] Test set [ndcg@10: 0.0141 ndcg@20: 0.0190 ndcg@40: 0.0247 ] 
2024-11-16 06:03:00,908 - [Epoch   5 /  30] bpr_loss: 97.9005 reg_loss: 4.4035 ss_loss: 985.1478 
2024-11-16 06:03:15,367 - Epoch   5 Test set [recall@10: 0.0296 recall@20: 0.0495 recall@40: 0.0781 ] Test set [ndcg@10: 0.0147 ndcg@20: 0.0197 ndcg@40: 0.0255 ] 
2024-11-16 06:03:25,840 - [Epoch   6 /  30] bpr_loss: 92.9581 reg_loss: 5.1139 ss_loss: 973.9741 
2024-11-16 06:03:41,046 - Epoch   6 Test set [recall@10: 0.0298 recall@20: 0.0496 recall@40: 0.0776 ] Test set [ndcg@10: 0.0151 ndcg@20: 0.0201 ndcg@40: 0.0258 ] 
2024-11-16 06:03:51,112 - [Epoch   7 /  30] bpr_loss: 88.0592 reg_loss: 5.8583 ss_loss: 969.1792 
2024-11-16 06:04:06,083 - Epoch   7 Test set [recall@10: 0.0300 recall@20: 0.0493 recall@40: 0.0785 ] Test set [ndcg@10: 0.0149 ndcg@20: 0.0197 ndcg@40: 0.0257 ] 
2024-11-16 06:04:16,321 - [Epoch   8 /  30] bpr_loss: 83.8203 reg_loss: 6.6323 ss_loss: 973.3078 
2024-11-16 06:04:31,128 - Epoch   8 Test set [recall@10: 0.0313 recall@20: 0.0507 recall@40: 0.0797 ] Test set [ndcg@10: 0.0156 ndcg@20: 0.0205 ndcg@40: 0.0264 ] 
2024-11-16 06:04:41,068 - [Epoch   9 /  30] bpr_loss: 80.5983 reg_loss: 7.4156 ss_loss: 957.5309 
2024-11-16 06:04:56,195 - Epoch   9 Test set [recall@10: 0.0301 recall@20: 0.0498 recall@40: 0.0795 ] Test set [ndcg@10: 0.0151 ndcg@20: 0.0200 ndcg@40: 0.0261 ] 
2024-11-16 06:05:06,526 - [Epoch  10 /  30] bpr_loss: 77.0956 reg_loss: 8.2032 ss_loss: 960.9169 
2024-11-16 06:05:21,465 - Epoch  10 Test set [recall@10: 0.0301 recall@20: 0.0496 recall@40: 0.0803 ] Test set [ndcg@10: 0.0148 ndcg@20: 0.0197 ndcg@40: 0.0260 ] 
2024-11-16 06:05:31,578 - [Epoch  11 /  30] bpr_loss: 75.0228 reg_loss: 9.0221 ss_loss: 953.0664 
2024-11-16 06:05:46,029 - Epoch  11 Test set [recall@10: 0.0303 recall@20: 0.0499 recall@40: 0.0803 ] Test set [ndcg@10: 0.0150 ndcg@20: 0.0200 ndcg@40: 0.0262 ] 
2024-11-16 06:05:56,809 - [Epoch  12 /  30] bpr_loss: 73.0210 reg_loss: 9.8796 ss_loss: 941.5292 
2024-11-16 06:06:11,607 - Epoch  12 Test set [recall@10: 0.0297 recall@20: 0.0492 recall@40: 0.0785 ] Test set [ndcg@10: 0.0149 ndcg@20: 0.0198 ndcg@40: 0.0258 ] 
2024-11-16 06:06:22,494 - [Epoch  13 /  30] bpr_loss: 71.0459 reg_loss: 10.7755 ss_loss: 944.8396 
2024-11-16 06:06:37,498 - Epoch  13 Test set [recall@10: 0.0297 recall@20: 0.0489 recall@40: 0.0783 ] Test set [ndcg@10: 0.0149 ndcg@20: 0.0197 ndcg@40: 0.0257 ] 
2024-11-16 06:06:47,784 - [Epoch  14 /  30] bpr_loss: 68.4004 reg_loss: 11.7077 ss_loss: 940.8425 
2024-11-16 06:07:02,714 - Epoch  14 Test set [recall@10: 0.0298 recall@20: 0.0489 recall@40: 0.0794 ] Test set [ndcg@10: 0.0148 ndcg@20: 0.0196 ndcg@40: 0.0258 ] 
2024-11-16 06:07:13,565 - [Epoch  15 /  30] bpr_loss: 66.5254 reg_loss: 12.6628 ss_loss: 936.7208 
2024-11-16 06:07:28,984 - Epoch  15 Test set [recall@10: 0.0288 recall@20: 0.0486 recall@40: 0.0795 ] Test set [ndcg@10: 0.0145 ndcg@20: 0.0194 ndcg@40: 0.0257 ] 
2024-11-16 06:07:39,872 - [Epoch  16 /  30] bpr_loss: 65.2915 reg_loss: 13.6655 ss_loss: 938.2944 
2024-11-16 06:07:54,963 - Epoch  16 Test set [recall@10: 0.0286 recall@20: 0.0486 recall@40: 0.0788 ] Test set [ndcg@10: 0.0145 ndcg@20: 0.0196 ndcg@40: 0.0257 ] 
2024-11-16 06:08:06,488 - [Epoch  17 /  30] bpr_loss: 62.8986 reg_loss: 14.6992 ss_loss: 930.6199 
2024-11-16 06:08:21,224 - Epoch  17 Test set [recall@10: 0.0288 recall@20: 0.0481 recall@40: 0.0789 ] Test set [ndcg@10: 0.0146 ndcg@20: 0.0195 ndcg@40: 0.0257 ] 
2024-11-16 06:08:32,892 - [Epoch  18 /  30] bpr_loss: 61.8945 reg_loss: 15.7750 ss_loss: 923.9213 
2024-11-16 06:08:47,679 - Epoch  18 Test set [recall@10: 0.0291 recall@20: 0.0486 recall@40: 0.0787 ] Test set [ndcg@10: 0.0146 ndcg@20: 0.0195 ndcg@40: 0.0256 ] 
2024-11-16 06:09:00,050 - [Epoch  19 /  30] bpr_loss: 59.8023 reg_loss: 16.8469 ss_loss: 911.1336 
2024-11-16 06:09:15,639 - Epoch  19 Test set [recall@10: 0.0292 recall@20: 0.0484 recall@40: 0.0779 ] Test set [ndcg@10: 0.0146 ndcg@20: 0.0194 ndcg@40: 0.0254 ] 
2024-11-16 06:09:26,397 - [Epoch  20 /  30] bpr_loss: 58.5018 reg_loss: 17.9335 ss_loss: 905.4898 
2024-11-16 06:09:42,041 - Epoch  20 Test set [recall@10: 0.0280 recall@20: 0.0465 recall@40: 0.0767 ] Test set [ndcg@10: 0.0141 ndcg@20: 0.0187 ndcg@40: 0.0249 ] 
2024-11-16 06:09:54,729 - [Epoch  21 /  30] bpr_loss: 56.9722 reg_loss: 19.0581 ss_loss: 893.3288 
2024-11-16 06:10:08,677 - Epoch  21 Test set [recall@10: 0.0276 recall@20: 0.0468 recall@40: 0.0757 ] Test set [ndcg@10: 0.0140 ndcg@20: 0.0189 ndcg@40: 0.0247 ] 
2024-11-16 06:10:19,388 - [Epoch  22 /  30] bpr_loss: 55.6757 reg_loss: 20.2426 ss_loss: 895.2910 
2024-11-16 06:10:33,028 - Epoch  22 Test set [recall@10: 0.0280 recall@20: 0.0473 recall@40: 0.0750 ] Test set [ndcg@10: 0.0142 ndcg@20: 0.0190 ndcg@40: 0.0246 ] 
2024-11-16 06:10:44,740 - [Epoch  23 /  30] bpr_loss: 54.7923 reg_loss: 21.4426 ss_loss: 895.0262 
2024-11-16 06:10:59,533 - Epoch  23 Test set [recall@10: 0.0280 recall@20: 0.0461 recall@40: 0.0744 ] Test set [ndcg@10: 0.0143 ndcg@20: 0.0188 ndcg@40: 0.0246 ] 
2024-11-16 06:11:10,079 - [Epoch  24 /  30] bpr_loss: 52.9346 reg_loss: 22.6733 ss_loss: 887.0210 
2024-11-16 06:11:25,276 - Epoch  24 Test set [recall@10: 0.0279 recall@20: 0.0456 recall@40: 0.0751 ] Test set [ndcg@10: 0.0140 ndcg@20: 0.0184 ndcg@40: 0.0244 ] 
2024-11-16 06:11:35,990 - [Epoch  25 /  30] bpr_loss: 51.3511 reg_loss: 23.9364 ss_loss: 883.6673 
2024-11-16 06:11:49,681 - Epoch  25 Test set [recall@10: 0.0280 recall@20: 0.0460 recall@40: 0.0736 ] Test set [ndcg@10: 0.0141 ndcg@20: 0.0186 ndcg@40: 0.0242 ] 
2024-11-16 06:12:00,771 - [Epoch  26 /  30] bpr_loss: 50.3453 reg_loss: 25.2027 ss_loss: 890.8388 
2024-11-16 06:12:14,315 - Epoch  26 Test set [recall@10: 0.0268 recall@20: 0.0456 recall@40: 0.0728 ] Test set [ndcg@10: 0.0136 ndcg@20: 0.0183 ndcg@40: 0.0239 ] 
2024-11-16 06:12:24,331 - [Epoch  27 /  30] bpr_loss: 48.9385 reg_loss: 26.4869 ss_loss: 879.8646 
2024-11-16 06:12:37,548 - Epoch  27 Test set [recall@10: 0.0270 recall@20: 0.0456 recall@40: 0.0726 ] Test set [ndcg@10: 0.0138 ndcg@20: 0.0184 ndcg@40: 0.0240 ] 
2024-11-16 06:12:47,704 - [Epoch  28 /  30] bpr_loss: 47.8973 reg_loss: 27.7798 ss_loss: 874.5250 
2024-11-16 06:13:01,761 - Epoch  28 Test set [recall@10: 0.0270 recall@20: 0.0454 recall@40: 0.0713 ] Test set [ndcg@10: 0.0135 ndcg@20: 0.0181 ndcg@40: 0.0233 ] 
2024-11-16 06:13:11,925 - [Epoch  29 /  30] bpr_loss: 45.8524 reg_loss: 29.0625 ss_loss: 861.9759 
2024-11-16 06:13:25,476 - Epoch  29 Test set [recall@10: 0.0261 recall@20: 0.0446 recall@40: 0.0708 ] Test set [ndcg@10: 0.0133 ndcg@20: 0.0179 ndcg@40: 0.0233 ] 
2024-11-16 06:13:39,135 - Test set [recall@10: 0.0261 recall@20: 0.0446 recall@40: 0.0708 ] Test set [ndcg@10: 0.0133 ndcg@20: 0.0179 ndcg@40: 0.0233 ] 
2024-11-16 06:13:52,435 - Test set [recall@10: 0.0261 recall@20: 0.0446 recall@40: 0.0708 ] Test set [ndcg@10: 0.0133 ndcg@20: 0.0179 ndcg@40: 0.0233 ] 
