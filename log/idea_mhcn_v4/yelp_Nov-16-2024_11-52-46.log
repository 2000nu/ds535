2024-11-16 11:52:46,477 - {'optimizer': {'name': 'adam', 'lr': 0.001, 'weight_decay': 0}, 'train': {'epoch': 30, 'batch_size': 2000, 'save_model': False, 'loss': 'pairwise', 'test_step': 1, 'reproducible': True, 'seed': 2023, 'tensorboard': True, 'log_loss': True, 'early_stop': False}, 'test': {'metrics': ['recall', 'ndcg'], 'k': [10, 20, 40], 'batch_size': 512}, 'data': {'type': 'social', 'name': 'yelp', 'user_num': 43043, 'item_num': 66576}, 'model': {'name': 'idea_mhcn_v4', 'layer_num': 2, 'reg_weight': 0.001, 'embedding_size': 64, 'ss_rate': 0.01}, 'tune': {'enable': False, 'hyperparameters': ['cl_weight', 'temperature', 'sampling_ratio'], 'cl_weight': [1.0, 0.1, 0.01, 0.001], 'temperature': [0.1, 0.2, 0.3, 0.4, 0.5], 'sampling_ratio': [0.5, 0.6, 0.7, 0.8, 0.9, 1.0]}, 'device': 'cuda', 'log': True}
2024-11-16 11:52:59,561 - [Epoch   0 /  30] bpr_loss: 190.9788 reg_loss: 0.9378 ss_loss: 1868.7151 
2024-11-16 11:53:16,272 - Epoch   0 Test set [recall@10: 0.0216 recall@20: 0.0367 recall@40: 0.0615 ] Test set [ndcg@10: 0.0110 ndcg@20: 0.0147 ndcg@40: 0.0198 ] 
2024-11-16 11:53:27,497 - [Epoch   1 /  30] bpr_loss: 131.8815 reg_loss: 1.5334 ss_loss: 1708.9779 
2024-11-16 11:53:44,514 - Epoch   1 Test set [recall@10: 0.0251 recall@20: 0.0421 recall@40: 0.0678 ] Test set [ndcg@10: 0.0124 ndcg@20: 0.0167 ndcg@40: 0.0219 ] 
2024-11-16 11:53:55,073 - [Epoch   2 /  30] bpr_loss: 111.7254 reg_loss: 2.0712 ss_loss: 1689.7515 
2024-11-16 11:54:11,950 - Epoch   2 Test set [recall@10: 0.0269 recall@20: 0.0447 recall@40: 0.0736 ] Test set [ndcg@10: 0.0137 ndcg@20: 0.0182 ndcg@40: 0.0241 ] 
2024-11-16 11:54:23,136 - [Epoch   3 /  30] bpr_loss: 102.0536 reg_loss: 2.6079 ss_loss: 1676.4090 
2024-11-16 11:54:39,980 - Epoch   3 Test set [recall@10: 0.0282 recall@20: 0.0467 recall@40: 0.0747 ] Test set [ndcg@10: 0.0142 ndcg@20: 0.0189 ndcg@40: 0.0246 ] 
2024-11-16 11:54:50,457 - [Epoch   4 /  30] bpr_loss: 93.9423 reg_loss: 3.1499 ss_loss: 1672.0082 
2024-11-16 11:55:07,416 - Epoch   4 Test set [recall@10: 0.0292 recall@20: 0.0473 recall@40: 0.0762 ] Test set [ndcg@10: 0.0147 ndcg@20: 0.0192 ndcg@40: 0.0251 ] 
2024-11-16 11:55:18,316 - [Epoch   5 /  30] bpr_loss: 88.1006 reg_loss: 3.6957 ss_loss: 1662.8160 
2024-11-16 11:55:35,442 - Epoch   5 Test set [recall@10: 0.0297 recall@20: 0.0495 recall@40: 0.0789 ] Test set [ndcg@10: 0.0152 ndcg@20: 0.0201 ndcg@40: 0.0261 ] 
2024-11-16 11:55:45,897 - [Epoch   6 /  30] bpr_loss: 83.3947 reg_loss: 4.2442 ss_loss: 1662.8298 
2024-11-16 11:56:04,786 - Epoch   6 Test set [recall@10: 0.0308 recall@20: 0.0503 recall@40: 0.0791 ] Test set [ndcg@10: 0.0156 ndcg@20: 0.0205 ndcg@40: 0.0263 ] 
2024-11-16 11:56:15,275 - [Epoch   7 /  30] bpr_loss: 79.0528 reg_loss: 4.8170 ss_loss: 1661.8186 
2024-11-16 11:56:32,172 - Epoch   7 Test set [recall@10: 0.0309 recall@20: 0.0501 recall@40: 0.0797 ] Test set [ndcg@10: 0.0155 ndcg@20: 0.0203 ndcg@40: 0.0263 ] 
2024-11-16 11:56:42,605 - [Epoch   8 /  30] bpr_loss: 75.2214 reg_loss: 5.4124 ss_loss: 1655.6461 
2024-11-16 11:56:59,577 - Epoch   8 Test set [recall@10: 0.0315 recall@20: 0.0516 recall@40: 0.0809 ] Test set [ndcg@10: 0.0159 ndcg@20: 0.0209 ndcg@40: 0.0269 ] 
2024-11-16 11:57:10,035 - [Epoch   9 /  30] bpr_loss: 72.1494 reg_loss: 6.0207 ss_loss: 1656.1399 
2024-11-16 11:57:26,911 - Epoch   9 Test set [recall@10: 0.0310 recall@20: 0.0506 recall@40: 0.0814 ] Test set [ndcg@10: 0.0156 ndcg@20: 0.0205 ndcg@40: 0.0268 ] 
2024-11-16 11:57:40,495 - [Epoch  10 /  30] bpr_loss: 69.4161 reg_loss: 6.6427 ss_loss: 1651.3647 
2024-11-16 11:57:57,587 - Epoch  10 Test set [recall@10: 0.0300 recall@20: 0.0508 recall@40: 0.0806 ] Test set [ndcg@10: 0.0153 ndcg@20: 0.0205 ndcg@40: 0.0266 ] 
2024-11-16 11:58:08,047 - [Epoch  11 /  30] bpr_loss: 67.4816 reg_loss: 7.2913 ss_loss: 1648.1227 
2024-11-16 11:58:24,707 - Epoch  11 Test set [recall@10: 0.0309 recall@20: 0.0501 recall@40: 0.0799 ] Test set [ndcg@10: 0.0156 ndcg@20: 0.0204 ndcg@40: 0.0265 ] 
2024-11-16 11:58:35,358 - [Epoch  12 /  30] bpr_loss: 65.0096 reg_loss: 7.9575 ss_loss: 1645.1908 
2024-11-16 11:58:52,308 - Epoch  12 Test set [recall@10: 0.0308 recall@20: 0.0505 recall@40: 0.0794 ] Test set [ndcg@10: 0.0157 ndcg@20: 0.0206 ndcg@40: 0.0265 ] 
2024-11-16 11:59:02,593 - [Epoch  13 /  30] bpr_loss: 63.0271 reg_loss: 8.6545 ss_loss: 1646.9393 
2024-11-16 11:59:18,785 - Epoch  13 Test set [recall@10: 0.0312 recall@20: 0.0499 recall@40: 0.0807 ] Test set [ndcg@10: 0.0159 ndcg@20: 0.0206 ndcg@40: 0.0269 ] 
2024-11-16 11:59:29,981 - [Epoch  14 /  30] bpr_loss: 60.3456 reg_loss: 9.3619 ss_loss: 1643.7398 
2024-11-16 11:59:46,891 - Epoch  14 Test set [recall@10: 0.0306 recall@20: 0.0513 recall@40: 0.0807 ] Test set [ndcg@10: 0.0156 ndcg@20: 0.0208 ndcg@40: 0.0268 ] 
2024-11-16 11:59:57,319 - [Epoch  15 /  30] bpr_loss: 58.3077 reg_loss: 10.0799 ss_loss: 1642.0165 
2024-11-16 12:00:15,556 - Epoch  15 Test set [recall@10: 0.0309 recall@20: 0.0504 recall@40: 0.0812 ] Test set [ndcg@10: 0.0155 ndcg@20: 0.0205 ndcg@40: 0.0267 ] 
2024-11-16 12:00:26,766 - [Epoch  16 /  30] bpr_loss: 56.6171 reg_loss: 10.8139 ss_loss: 1639.2967 
2024-11-16 12:00:43,873 - Epoch  16 Test set [recall@10: 0.0307 recall@20: 0.0502 recall@40: 0.0805 ] Test set [ndcg@10: 0.0157 ndcg@20: 0.0206 ndcg@40: 0.0267 ] 
2024-11-16 12:00:54,632 - [Epoch  17 /  30] bpr_loss: 53.9697 reg_loss: 11.5699 ss_loss: 1638.2630 
2024-11-16 12:01:12,051 - Epoch  17 Test set [recall@10: 0.0304 recall@20: 0.0500 recall@40: 0.0813 ] Test set [ndcg@10: 0.0156 ndcg@20: 0.0205 ndcg@40: 0.0269 ] 
2024-11-16 12:01:22,831 - [Epoch  18 /  30] bpr_loss: 52.3566 reg_loss: 12.3266 ss_loss: 1635.2547 
2024-11-16 12:01:39,006 - Epoch  18 Test set [recall@10: 0.0301 recall@20: 0.0502 recall@40: 0.0805 ] Test set [ndcg@10: 0.0155 ndcg@20: 0.0205 ndcg@40: 0.0266 ] 
2024-11-16 12:01:49,285 - [Epoch  19 /  30] bpr_loss: 50.8445 reg_loss: 13.0957 ss_loss: 1627.2842 
2024-11-16 12:02:05,639 - Epoch  19 Test set [recall@10: 0.0307 recall@20: 0.0508 recall@40: 0.0807 ] Test set [ndcg@10: 0.0158 ndcg@20: 0.0208 ndcg@40: 0.0269 ] 
2024-11-16 12:02:16,321 - [Epoch  20 /  30] bpr_loss: 49.4754 reg_loss: 13.8929 ss_loss: 1625.7670 
2024-11-16 12:02:31,873 - Epoch  20 Test set [recall@10: 0.0296 recall@20: 0.0498 recall@40: 0.0805 ] Test set [ndcg@10: 0.0154 ndcg@20: 0.0205 ndcg@40: 0.0267 ] 
2024-11-16 12:02:42,196 - [Epoch  21 /  30] bpr_loss: 47.7576 reg_loss: 14.7006 ss_loss: 1619.7787 
2024-11-16 12:02:57,637 - Epoch  21 Test set [recall@10: 0.0299 recall@20: 0.0500 recall@40: 0.0798 ] Test set [ndcg@10: 0.0153 ndcg@20: 0.0204 ndcg@40: 0.0264 ] 
2024-11-16 12:03:08,176 - [Epoch  22 /  30] bpr_loss: 46.0548 reg_loss: 15.5231 ss_loss: 1619.9333 
2024-11-16 12:03:24,644 - Epoch  22 Test set [recall@10: 0.0299 recall@20: 0.0492 recall@40: 0.0794 ] Test set [ndcg@10: 0.0155 ndcg@20: 0.0203 ndcg@40: 0.0265 ] 
2024-11-16 12:03:35,127 - [Epoch  23 /  30] bpr_loss: 44.8635 reg_loss: 16.3396 ss_loss: 1617.9228 
2024-11-16 12:03:50,953 - Epoch  23 Test set [recall@10: 0.0306 recall@20: 0.0490 recall@40: 0.0800 ] Test set [ndcg@10: 0.0157 ndcg@20: 0.0203 ndcg@40: 0.0266 ] 
2024-11-16 12:04:01,768 - [Epoch  24 /  30] bpr_loss: 43.1353 reg_loss: 17.1595 ss_loss: 1612.0256 
2024-11-16 12:04:18,241 - Epoch  24 Test set [recall@10: 0.0306 recall@20: 0.0489 recall@40: 0.0801 ] Test set [ndcg@10: 0.0156 ndcg@20: 0.0202 ndcg@40: 0.0265 ] 
2024-11-16 12:04:28,651 - [Epoch  25 /  30] bpr_loss: 41.7474 reg_loss: 18.0168 ss_loss: 1610.8522 
2024-11-16 12:04:44,945 - Epoch  25 Test set [recall@10: 0.0306 recall@20: 0.0497 recall@40: 0.0807 ] Test set [ndcg@10: 0.0157 ndcg@20: 0.0204 ndcg@40: 0.0268 ] 
2024-11-16 12:04:55,598 - [Epoch  26 /  30] bpr_loss: 41.2783 reg_loss: 18.8748 ss_loss: 1607.8804 
2024-11-16 12:05:13,459 - Epoch  26 Test set [recall@10: 0.0298 recall@20: 0.0498 recall@40: 0.0801 ] Test set [ndcg@10: 0.0153 ndcg@20: 0.0203 ndcg@40: 0.0265 ] 
2024-11-16 12:05:24,020 - [Epoch  27 /  30] bpr_loss: 39.7391 reg_loss: 19.7408 ss_loss: 1603.9683 
2024-11-16 12:05:41,534 - Epoch  27 Test set [recall@10: 0.0301 recall@20: 0.0502 recall@40: 0.0805 ] Test set [ndcg@10: 0.0155 ndcg@20: 0.0205 ndcg@40: 0.0267 ] 
2024-11-16 12:05:55,159 - [Epoch  28 /  30] bpr_loss: 38.5771 reg_loss: 20.6360 ss_loss: 1600.1960 
2024-11-16 12:06:12,239 - Epoch  28 Test set [recall@10: 0.0301 recall@20: 0.0498 recall@40: 0.0804 ] Test set [ndcg@10: 0.0156 ndcg@20: 0.0205 ndcg@40: 0.0267 ] 
2024-11-16 12:06:22,706 - [Epoch  29 /  30] bpr_loss: 37.1738 reg_loss: 21.5126 ss_loss: 1599.6616 
2024-11-16 12:06:39,370 - Epoch  29 Test set [recall@10: 0.0301 recall@20: 0.0505 recall@40: 0.0801 ] Test set [ndcg@10: 0.0155 ndcg@20: 0.0206 ndcg@40: 0.0266 ] 
2024-11-16 12:06:56,394 - Test set [recall@10: 0.0301 recall@20: 0.0505 recall@40: 0.0801 ] Test set [ndcg@10: 0.0155 ndcg@20: 0.0206 ndcg@40: 0.0266 ] 
2024-11-16 12:07:14,578 - Test set [recall@10: 0.0301 recall@20: 0.0505 recall@40: 0.0801 ] Test set [ndcg@10: 0.0155 ndcg@20: 0.0206 ndcg@40: 0.0266 ] 
