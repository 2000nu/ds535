2024-11-16 05:43:00,848 - {'optimizer': {'name': 'adam', 'lr': 0.001, 'weight_decay': 0}, 'train': {'epoch': 30, 'batch_size': 2000, 'save_model': False, 'loss': 'pairwise', 'test_step': 1, 'reproducible': True, 'seed': 2023, 'tensorboard': True, 'log_loss': True, 'early_stop': False}, 'test': {'metrics': ['recall', 'ndcg'], 'k': [10, 20, 40], 'batch_size': 512}, 'data': {'type': 'social', 'name': 'lastfm', 'user_num': 1892, 'item_num': 17632}, 'model': {'name': 'idea_mhcn_v4', 'layer_num': 2, 'reg_weight': 0.001, 'embedding_size': 64, 'ss_rate': 0.01}, 'tune': {'enable': False, 'hyperparameters': ['cl_weight', 'temperature', 'sampling_ratio'], 'cl_weight': [1.0, 0.1, 0.01, 0.001], 'temperature': [0.1, 0.2, 0.3, 0.4, 0.5], 'sampling_ratio': [0.5, 0.6, 0.7, 0.8, 0.9, 1.0]}, 'device': 'cuda', 'log': True}
2024-11-16 05:43:02,960 - [Epoch   0 /  30] bpr_loss: 190.4564 reg_loss: 0.4984 ss_loss: 68.4970 
2024-11-16 05:43:03,500 - Epoch   0 Test set [recall@10: 0.0264 recall@20: 0.0405 recall@40: 0.0640 ] Test set [ndcg@10: 0.0319 ndcg@20: 0.0381 ndcg@40: 0.0489 ] 
2024-11-16 05:43:04,905 - [Epoch   1 /  30] bpr_loss: 121.9554 reg_loss: 0.5713 ss_loss: 52.4728 
2024-11-16 05:43:05,403 - Epoch   1 Test set [recall@10: 0.0255 recall@20: 0.0407 recall@40: 0.0620 ] Test set [ndcg@10: 0.0320 ndcg@20: 0.0388 ndcg@40: 0.0486 ] 
2024-11-16 05:43:06,542 - [Epoch   2 /  30] bpr_loss: 105.5879 reg_loss: 0.6463 ss_loss: 46.6454 
2024-11-16 05:43:07,115 - Epoch   2 Test set [recall@10: 0.0263 recall@20: 0.0408 recall@40: 0.0635 ] Test set [ndcg@10: 0.0329 ndcg@20: 0.0392 ndcg@40: 0.0496 ] 
2024-11-16 05:43:08,309 - [Epoch   3 /  30] bpr_loss: 96.6246 reg_loss: 0.7304 ss_loss: 43.3174 
2024-11-16 05:43:08,704 - Epoch   3 Test set [recall@10: 0.0258 recall@20: 0.0405 recall@40: 0.0622 ] Test set [ndcg@10: 0.0325 ndcg@20: 0.0389 ndcg@40: 0.0489 ] 
2024-11-16 05:43:10,077 - [Epoch   4 /  30] bpr_loss: 92.2328 reg_loss: 0.8217 ss_loss: 41.1019 
2024-11-16 05:43:10,496 - Epoch   4 Test set [recall@10: 0.0263 recall@20: 0.0411 recall@40: 0.0636 ] Test set [ndcg@10: 0.0332 ndcg@20: 0.0396 ndcg@40: 0.0500 ] 
2024-11-16 05:43:11,723 - [Epoch   5 /  30] bpr_loss: 85.6173 reg_loss: 0.9174 ss_loss: 39.4201 
2024-11-16 05:43:12,206 - Epoch   5 Test set [recall@10: 0.0268 recall@20: 0.0413 recall@40: 0.0641 ] Test set [ndcg@10: 0.0336 ndcg@20: 0.0399 ndcg@40: 0.0503 ] 
2024-11-16 05:43:13,419 - [Epoch   6 /  30] bpr_loss: 82.0363 reg_loss: 1.0163 ss_loss: 39.1607 
2024-11-16 05:43:13,814 - Epoch   6 Test set [recall@10: 0.0276 recall@20: 0.0428 recall@40: 0.0659 ] Test set [ndcg@10: 0.0345 ndcg@20: 0.0411 ndcg@40: 0.0518 ] 
2024-11-16 05:43:15,005 - [Epoch   7 /  30] bpr_loss: 77.7907 reg_loss: 1.1170 ss_loss: 37.7515 
2024-11-16 05:43:15,414 - Epoch   7 Test set [recall@10: 0.0275 recall@20: 0.0420 recall@40: 0.0661 ] Test set [ndcg@10: 0.0343 ndcg@20: 0.0405 ndcg@40: 0.0517 ] 
2024-11-16 05:43:16,647 - [Epoch   8 /  30] bpr_loss: 73.5726 reg_loss: 1.2185 ss_loss: 37.0778 
2024-11-16 05:43:17,147 - Epoch   8 Test set [recall@10: 0.0274 recall@20: 0.0423 recall@40: 0.0654 ] Test set [ndcg@10: 0.0340 ndcg@20: 0.0405 ndcg@40: 0.0512 ] 
2024-11-16 05:43:18,676 - [Epoch   9 /  30] bpr_loss: 72.1922 reg_loss: 1.3186 ss_loss: 36.8205 
2024-11-16 05:43:19,081 - Epoch   9 Test set [recall@10: 0.0271 recall@20: 0.0426 recall@40: 0.0657 ] Test set [ndcg@10: 0.0335 ndcg@20: 0.0403 ndcg@40: 0.0511 ] 
2024-11-16 05:43:20,257 - [Epoch  10 /  30] bpr_loss: 68.9359 reg_loss: 1.4194 ss_loss: 36.2575 
2024-11-16 05:43:20,644 - Epoch  10 Test set [recall@10: 0.0270 recall@20: 0.0430 recall@40: 0.0676 ] Test set [ndcg@10: 0.0335 ndcg@20: 0.0407 ndcg@40: 0.0520 ] 
2024-11-16 05:43:22,073 - [Epoch  11 /  30] bpr_loss: 66.8751 reg_loss: 1.5194 ss_loss: 35.7396 
2024-11-16 05:43:22,481 - Epoch  11 Test set [recall@10: 0.0270 recall@20: 0.0440 recall@40: 0.0682 ] Test set [ndcg@10: 0.0339 ndcg@20: 0.0416 ndcg@40: 0.0528 ] 
2024-11-16 05:43:23,912 - [Epoch  12 /  30] bpr_loss: 63.4624 reg_loss: 1.6173 ss_loss: 35.7018 
2024-11-16 05:43:24,409 - Epoch  12 Test set [recall@10: 0.0277 recall@20: 0.0436 recall@40: 0.0674 ] Test set [ndcg@10: 0.0343 ndcg@20: 0.0414 ndcg@40: 0.0523 ] 
2024-11-16 05:43:25,584 - [Epoch  13 /  30] bpr_loss: 61.9736 reg_loss: 1.7133 ss_loss: 35.0408 
2024-11-16 05:43:25,989 - Epoch  13 Test set [recall@10: 0.0271 recall@20: 0.0436 recall@40: 0.0681 ] Test set [ndcg@10: 0.0341 ndcg@20: 0.0416 ndcg@40: 0.0528 ] 
2024-11-16 05:43:27,398 - [Epoch  14 /  30] bpr_loss: 59.4363 reg_loss: 1.8075 ss_loss: 34.6139 
2024-11-16 05:43:27,798 - Epoch  14 Test set [recall@10: 0.0273 recall@20: 0.0440 recall@40: 0.0681 ] Test set [ndcg@10: 0.0342 ndcg@20: 0.0416 ndcg@40: 0.0527 ] 
2024-11-16 05:43:29,227 - [Epoch  15 /  30] bpr_loss: 59.2824 reg_loss: 1.9004 ss_loss: 35.2097 
2024-11-16 05:43:29,629 - Epoch  15 Test set [recall@10: 0.0273 recall@20: 0.0440 recall@40: 0.0684 ] Test set [ndcg@10: 0.0345 ndcg@20: 0.0420 ndcg@40: 0.0532 ] 
2024-11-16 05:43:30,744 - [Epoch  16 /  30] bpr_loss: 57.3582 reg_loss: 1.9919 ss_loss: 34.3301 
2024-11-16 05:43:31,241 - Epoch  16 Test set [recall@10: 0.0274 recall@20: 0.0443 recall@40: 0.0687 ] Test set [ndcg@10: 0.0344 ndcg@20: 0.0421 ndcg@40: 0.0533 ] 
2024-11-16 05:43:32,615 - [Epoch  17 /  30] bpr_loss: 54.8247 reg_loss: 2.0806 ss_loss: 34.2426 
2024-11-16 05:43:33,112 - Epoch  17 Test set [recall@10: 0.0281 recall@20: 0.0452 recall@40: 0.0688 ] Test set [ndcg@10: 0.0351 ndcg@20: 0.0428 ndcg@40: 0.0537 ] 
2024-11-16 05:43:34,463 - [Epoch  18 /  30] bpr_loss: 54.1334 reg_loss: 2.1673 ss_loss: 33.7189 
2024-11-16 05:43:34,857 - Epoch  18 Test set [recall@10: 0.0283 recall@20: 0.0455 recall@40: 0.0688 ] Test set [ndcg@10: 0.0352 ndcg@20: 0.0430 ndcg@40: 0.0537 ] 
2024-11-16 05:43:36,228 - [Epoch  19 /  30] bpr_loss: 52.3059 reg_loss: 2.2524 ss_loss: 33.6654 
2024-11-16 05:43:36,645 - Epoch  19 Test set [recall@10: 0.0286 recall@20: 0.0457 recall@40: 0.0705 ] Test set [ndcg@10: 0.0361 ndcg@20: 0.0437 ndcg@40: 0.0551 ] 
2024-11-16 05:43:37,853 - [Epoch  20 /  30] bpr_loss: 51.2065 reg_loss: 2.3359 ss_loss: 33.5788 
2024-11-16 05:43:38,264 - Epoch  20 Test set [recall@10: 0.0286 recall@20: 0.0454 recall@40: 0.0697 ] Test set [ndcg@10: 0.0359 ndcg@20: 0.0434 ndcg@40: 0.0545 ] 
2024-11-16 05:43:39,735 - [Epoch  21 /  30] bpr_loss: 50.6413 reg_loss: 2.4186 ss_loss: 33.5310 
2024-11-16 05:43:40,122 - Epoch  21 Test set [recall@10: 0.0282 recall@20: 0.0451 recall@40: 0.0693 ] Test set [ndcg@10: 0.0350 ndcg@20: 0.0425 ndcg@40: 0.0537 ] 
2024-11-16 05:43:41,410 - [Epoch  22 /  30] bpr_loss: 49.0483 reg_loss: 2.5001 ss_loss: 33.2362 
2024-11-16 05:43:41,904 - Epoch  22 Test set [recall@10: 0.0287 recall@20: 0.0453 recall@40: 0.0703 ] Test set [ndcg@10: 0.0359 ndcg@20: 0.0431 ndcg@40: 0.0546 ] 
2024-11-16 05:43:43,106 - [Epoch  23 /  30] bpr_loss: 47.8211 reg_loss: 2.5783 ss_loss: 33.0792 
2024-11-16 05:43:43,506 - Epoch  23 Test set [recall@10: 0.0294 recall@20: 0.0453 recall@40: 0.0703 ] Test set [ndcg@10: 0.0368 ndcg@20: 0.0437 ndcg@40: 0.0553 ] 
2024-11-16 05:43:44,673 - [Epoch  24 /  30] bpr_loss: 47.1476 reg_loss: 2.6555 ss_loss: 33.0752 
2024-11-16 05:43:45,055 - Epoch  24 Test set [recall@10: 0.0286 recall@20: 0.0457 recall@40: 0.0705 ] Test set [ndcg@10: 0.0364 ndcg@20: 0.0440 ndcg@40: 0.0554 ] 
2024-11-16 05:43:46,457 - [Epoch  25 /  30] bpr_loss: 46.3604 reg_loss: 2.7304 ss_loss: 32.3840 
2024-11-16 05:43:46,851 - Epoch  25 Test set [recall@10: 0.0289 recall@20: 0.0458 recall@40: 0.0708 ] Test set [ndcg@10: 0.0366 ndcg@20: 0.0441 ndcg@40: 0.0556 ] 
2024-11-16 05:43:48,126 - [Epoch  26 /  30] bpr_loss: 46.0618 reg_loss: 2.8049 ss_loss: 32.6705 
2024-11-16 05:43:48,525 - Epoch  26 Test set [recall@10: 0.0288 recall@20: 0.0452 recall@40: 0.0707 ] Test set [ndcg@10: 0.0368 ndcg@20: 0.0440 ndcg@40: 0.0557 ] 
2024-11-16 05:43:49,718 - [Epoch  27 /  30] bpr_loss: 44.3293 reg_loss: 2.8803 ss_loss: 31.8004 
2024-11-16 05:43:50,113 - Epoch  27 Test set [recall@10: 0.0282 recall@20: 0.0452 recall@40: 0.0699 ] Test set [ndcg@10: 0.0359 ndcg@20: 0.0435 ndcg@40: 0.0548 ] 
2024-11-16 05:43:51,511 - [Epoch  28 /  30] bpr_loss: 43.4979 reg_loss: 2.9533 ss_loss: 31.9480 
2024-11-16 05:43:51,917 - Epoch  28 Test set [recall@10: 0.0281 recall@20: 0.0451 recall@40: 0.0693 ] Test set [ndcg@10: 0.0359 ndcg@20: 0.0435 ndcg@40: 0.0546 ] 
2024-11-16 05:43:53,174 - [Epoch  29 /  30] bpr_loss: 41.7877 reg_loss: 3.0226 ss_loss: 31.8175 
2024-11-16 05:43:53,594 - Epoch  29 Test set [recall@10: 0.0281 recall@20: 0.0460 recall@40: 0.0709 ] Test set [ndcg@10: 0.0360 ndcg@20: 0.0441 ndcg@40: 0.0555 ] 
2024-11-16 05:43:53,961 - Test set [recall@10: 0.0281 recall@20: 0.0460 recall@40: 0.0709 ] Test set [ndcg@10: 0.0360 ndcg@20: 0.0441 ndcg@40: 0.0555 ] 
2024-11-16 05:43:54,326 - Test set [recall@10: 0.0281 recall@20: 0.0460 recall@40: 0.0709 ] Test set [ndcg@10: 0.0360 ndcg@20: 0.0441 ndcg@40: 0.0555 ] 
