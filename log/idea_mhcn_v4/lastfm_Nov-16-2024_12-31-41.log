2024-11-16 12:31:41,066 - {'optimizer': {'name': 'adam', 'lr': 0.001, 'weight_decay': 0}, 'train': {'epoch': 30, 'batch_size': 2000, 'save_model': False, 'loss': 'pairwise', 'test_step': 1, 'reproducible': True, 'seed': 2023, 'tensorboard': True, 'log_loss': True, 'early_stop': False}, 'test': {'metrics': ['recall', 'ndcg'], 'k': [10, 20, 40], 'batch_size': 512}, 'data': {'type': 'social', 'name': 'lastfm', 'user_num': 1892, 'item_num': 17632}, 'model': {'name': 'idea_mhcn_v4', 'layer_num': 2, 'reg_weight': 0.001, 'embedding_size': 64, 'ss_rate': 0.01}, 'tune': {'enable': False, 'hyperparameters': ['cl_weight', 'temperature', 'sampling_ratio'], 'cl_weight': [1.0, 0.1, 0.01, 0.001], 'temperature': [0.1, 0.2, 0.3, 0.4, 0.5], 'sampling_ratio': [0.5, 0.6, 0.7, 0.8, 0.9, 1.0]}, 'device': 'cuda', 'log': True}
2024-11-16 12:31:43,207 - [Epoch   0 /  30] bpr_loss: 189.9064 reg_loss: 0.5016 ss_loss: 68.3290 
2024-11-16 12:31:43,800 - Epoch   0 Test set [recall@10: 0.1500 recall@20: 0.2169 recall@40: 0.2954 ] Test set [ndcg@10: 0.1891 ndcg@20: 0.2134 ndcg@40: 0.2482 ] 
2024-11-16 12:31:45,378 - [Epoch   1 /  30] bpr_loss: 122.4290 reg_loss: 0.5758 ss_loss: 52.3177 
2024-11-16 12:31:45,857 - Epoch   1 Test set [recall@10: 0.1606 recall@20: 0.2267 recall@40: 0.3116 ] Test set [ndcg@10: 0.2031 ndcg@20: 0.2262 ndcg@40: 0.2636 ] 
2024-11-16 12:31:47,174 - [Epoch   2 /  30] bpr_loss: 105.9739 reg_loss: 0.6498 ss_loss: 46.2938 
2024-11-16 12:31:47,652 - Epoch   2 Test set [recall@10: 0.1640 recall@20: 0.2358 recall@40: 0.3209 ] Test set [ndcg@10: 0.2093 ndcg@20: 0.2349 ndcg@40: 0.2725 ] 
2024-11-16 12:31:49,350 - [Epoch   3 /  30] bpr_loss: 96.4056 reg_loss: 0.7335 ss_loss: 42.8923 
2024-11-16 12:31:49,838 - Epoch   3 Test set [recall@10: 0.1686 recall@20: 0.2398 recall@40: 0.3283 ] Test set [ndcg@10: 0.2159 ndcg@20: 0.2405 ndcg@40: 0.2796 ] 
2024-11-16 12:31:51,133 - [Epoch   4 /  30] bpr_loss: 90.9633 reg_loss: 0.8245 ss_loss: 41.2274 
2024-11-16 12:31:51,525 - Epoch   4 Test set [recall@10: 0.1720 recall@20: 0.2432 recall@40: 0.3326 ] Test set [ndcg@10: 0.2194 ndcg@20: 0.2437 ndcg@40: 0.2833 ] 
2024-11-16 12:31:52,769 - [Epoch   5 /  30] bpr_loss: 85.8455 reg_loss: 0.9192 ss_loss: 39.7456 
2024-11-16 12:31:53,175 - Epoch   5 Test set [recall@10: 0.1730 recall@20: 0.2484 recall@40: 0.3371 ] Test set [ndcg@10: 0.2222 ndcg@20: 0.2488 ndcg@40: 0.2880 ] 
2024-11-16 12:31:54,632 - [Epoch   6 /  30] bpr_loss: 80.9776 reg_loss: 1.0168 ss_loss: 39.2342 
2024-11-16 12:31:55,095 - Epoch   6 Test set [recall@10: 0.1774 recall@20: 0.2517 recall@40: 0.3414 ] Test set [ndcg@10: 0.2273 ndcg@20: 0.2527 ndcg@40: 0.2924 ] 
2024-11-16 12:31:56,334 - [Epoch   7 /  30] bpr_loss: 76.2802 reg_loss: 1.1174 ss_loss: 37.7410 
2024-11-16 12:31:56,739 - Epoch   7 Test set [recall@10: 0.1768 recall@20: 0.2547 recall@40: 0.3449 ] Test set [ndcg@10: 0.2279 ndcg@20: 0.2553 ndcg@40: 0.2952 ] 
2024-11-16 12:31:57,938 - [Epoch   8 /  30] bpr_loss: 73.7967 reg_loss: 1.2190 ss_loss: 37.1539 
2024-11-16 12:31:58,394 - Epoch   8 Test set [recall@10: 0.1783 recall@20: 0.2553 recall@40: 0.3460 ] Test set [ndcg@10: 0.2297 ndcg@20: 0.2564 ndcg@40: 0.2965 ] 
2024-11-16 12:31:59,679 - [Epoch   9 /  30] bpr_loss: 69.9760 reg_loss: 1.3212 ss_loss: 36.7454 
2024-11-16 12:32:00,089 - Epoch   9 Test set [recall@10: 0.1811 recall@20: 0.2577 recall@40: 0.3495 ] Test set [ndcg@10: 0.2319 ndcg@20: 0.2581 ndcg@40: 0.2989 ] 
2024-11-16 12:32:01,501 - [Epoch  10 /  30] bpr_loss: 67.7621 reg_loss: 1.4222 ss_loss: 36.1082 
2024-11-16 12:32:01,914 - Epoch  10 Test set [recall@10: 0.1836 recall@20: 0.2575 recall@40: 0.3481 ] Test set [ndcg@10: 0.2339 ndcg@20: 0.2587 ndcg@40: 0.2990 ] 
2024-11-16 12:32:03,225 - [Epoch  11 /  30] bpr_loss: 65.4317 reg_loss: 1.5224 ss_loss: 35.5218 
2024-11-16 12:32:03,688 - Epoch  11 Test set [recall@10: 0.1840 recall@20: 0.2605 recall@40: 0.3511 ] Test set [ndcg@10: 0.2346 ndcg@20: 0.2607 ndcg@40: 0.3009 ] 
2024-11-16 12:32:04,826 - [Epoch  12 /  30] bpr_loss: 63.2752 reg_loss: 1.6213 ss_loss: 35.2816 
2024-11-16 12:32:05,253 - Epoch  12 Test set [recall@10: 0.1854 recall@20: 0.2619 recall@40: 0.3549 ] Test set [ndcg@10: 0.2366 ndcg@20: 0.2626 ndcg@40: 0.3039 ] 
2024-11-16 12:32:06,633 - [Epoch  13 /  30] bpr_loss: 60.5094 reg_loss: 1.7191 ss_loss: 34.4434 
2024-11-16 12:32:07,079 - Epoch  13 Test set [recall@10: 0.1870 recall@20: 0.2627 recall@40: 0.3551 ] Test set [ndcg@10: 0.2370 ndcg@20: 0.2626 ndcg@40: 0.3038 ] 
2024-11-16 12:32:08,360 - [Epoch  14 /  30] bpr_loss: 58.9588 reg_loss: 1.8167 ss_loss: 34.8290 
2024-11-16 12:32:08,762 - Epoch  14 Test set [recall@10: 0.1859 recall@20: 0.2614 recall@40: 0.3557 ] Test set [ndcg@10: 0.2378 ndcg@20: 0.2632 ndcg@40: 0.3052 ] 
2024-11-16 12:32:10,006 - [Epoch  15 /  30] bpr_loss: 58.0786 reg_loss: 1.9123 ss_loss: 35.0809 
2024-11-16 12:32:10,403 - Epoch  15 Test set [recall@10: 0.1888 recall@20: 0.2643 recall@40: 0.3588 ] Test set [ndcg@10: 0.2402 ndcg@20: 0.2656 ndcg@40: 0.3075 ] 
2024-11-16 12:32:11,551 - [Epoch  16 /  30] bpr_loss: 58.2365 reg_loss: 2.0053 ss_loss: 33.7900 
2024-11-16 12:32:11,984 - Epoch  16 Test set [recall@10: 0.1879 recall@20: 0.2658 recall@40: 0.3589 ] Test set [ndcg@10: 0.2401 ndcg@20: 0.2664 ndcg@40: 0.3078 ] 
2024-11-16 12:32:13,306 - [Epoch  17 /  30] bpr_loss: 54.2155 reg_loss: 2.0967 ss_loss: 34.3456 
2024-11-16 12:32:13,694 - Epoch  17 Test set [recall@10: 0.1878 recall@20: 0.2683 recall@40: 0.3623 ] Test set [ndcg@10: 0.2414 ndcg@20: 0.2693 ndcg@40: 0.3109 ] 
2024-11-16 12:32:14,982 - [Epoch  18 /  30] bpr_loss: 53.5100 reg_loss: 2.1851 ss_loss: 33.8844 
2024-11-16 12:32:15,461 - Epoch  18 Test set [recall@10: 0.1896 recall@20: 0.2710 recall@40: 0.3610 ] Test set [ndcg@10: 0.2426 ndcg@20: 0.2710 ndcg@40: 0.3109 ] 
2024-11-16 12:32:16,797 - [Epoch  19 /  30] bpr_loss: 51.6257 reg_loss: 2.2737 ss_loss: 33.0699 
2024-11-16 12:32:17,213 - Epoch  19 Test set [recall@10: 0.1886 recall@20: 0.2699 recall@40: 0.3623 ] Test set [ndcg@10: 0.2433 ndcg@20: 0.2716 ndcg@40: 0.3127 ] 
2024-11-16 12:32:18,490 - [Epoch  20 /  30] bpr_loss: 51.4494 reg_loss: 2.3599 ss_loss: 33.4958 
2024-11-16 12:32:18,893 - Epoch  20 Test set [recall@10: 0.1919 recall@20: 0.2722 recall@40: 0.3637 ] Test set [ndcg@10: 0.2458 ndcg@20: 0.2732 ndcg@40: 0.3138 ] 
2024-11-16 12:32:20,447 - [Epoch  21 /  30] bpr_loss: 49.3137 reg_loss: 2.4445 ss_loss: 33.5131 
2024-11-16 12:32:20,857 - Epoch  21 Test set [recall@10: 0.1917 recall@20: 0.2702 recall@40: 0.3661 ] Test set [ndcg@10: 0.2449 ndcg@20: 0.2713 ndcg@40: 0.3139 ] 
2024-11-16 12:32:22,385 - [Epoch  22 /  30] bpr_loss: 48.7922 reg_loss: 2.5264 ss_loss: 33.3286 
2024-11-16 12:32:22,798 - Epoch  22 Test set [recall@10: 0.1911 recall@20: 0.2694 recall@40: 0.3633 ] Test set [ndcg@10: 0.2440 ndcg@20: 0.2704 ndcg@40: 0.3120 ] 
2024-11-16 12:32:24,133 - [Epoch  23 /  30] bpr_loss: 49.0796 reg_loss: 2.6064 ss_loss: 33.0599 
2024-11-16 12:32:24,578 - Epoch  23 Test set [recall@10: 0.1912 recall@20: 0.2720 recall@40: 0.3649 ] Test set [ndcg@10: 0.2450 ndcg@20: 0.2725 ndcg@40: 0.3138 ] 
2024-11-16 12:32:25,869 - [Epoch  24 /  30] bpr_loss: 46.2330 reg_loss: 2.6858 ss_loss: 32.9715 
2024-11-16 12:32:26,359 - Epoch  24 Test set [recall@10: 0.1915 recall@20: 0.2731 recall@40: 0.3657 ] Test set [ndcg@10: 0.2460 ndcg@20: 0.2737 ndcg@40: 0.3148 ] 
2024-11-16 12:32:27,599 - [Epoch  25 /  30] bpr_loss: 45.8220 reg_loss: 2.7645 ss_loss: 32.2715 
2024-11-16 12:32:27,998 - Epoch  25 Test set [recall@10: 0.1928 recall@20: 0.2719 recall@40: 0.3662 ] Test set [ndcg@10: 0.2457 ndcg@20: 0.2724 ndcg@40: 0.3141 ] 
2024-11-16 12:32:29,459 - [Epoch  26 /  30] bpr_loss: 45.1063 reg_loss: 2.8414 ss_loss: 32.7945 
2024-11-16 12:32:29,970 - Epoch  26 Test set [recall@10: 0.1922 recall@20: 0.2716 recall@40: 0.3675 ] Test set [ndcg@10: 0.2454 ndcg@20: 0.2724 ndcg@40: 0.3149 ] 
2024-11-16 12:32:31,261 - [Epoch  27 /  30] bpr_loss: 43.7486 reg_loss: 2.9179 ss_loss: 32.4909 
2024-11-16 12:32:31,656 - Epoch  27 Test set [recall@10: 0.1923 recall@20: 0.2731 recall@40: 0.3672 ] Test set [ndcg@10: 0.2455 ndcg@20: 0.2729 ndcg@40: 0.3147 ] 
2024-11-16 12:32:32,895 - [Epoch  28 /  30] bpr_loss: 42.5455 reg_loss: 2.9927 ss_loss: 32.1707 
2024-11-16 12:32:33,276 - Epoch  28 Test set [recall@10: 0.1918 recall@20: 0.2704 recall@40: 0.3679 ] Test set [ndcg@10: 0.2446 ndcg@20: 0.2713 ndcg@40: 0.3145 ] 
2024-11-16 12:32:34,724 - [Epoch  29 /  30] bpr_loss: 42.7264 reg_loss: 3.0667 ss_loss: 31.8766 
2024-11-16 12:32:35,128 - Epoch  29 Test set [recall@10: 0.1958 recall@20: 0.2720 recall@40: 0.3666 ] Test set [ndcg@10: 0.2486 ndcg@20: 0.2736 ndcg@40: 0.3158 ] 
2024-11-16 12:32:35,559 - Test set [recall@10: 0.1958 recall@20: 0.2720 recall@40: 0.3666 ] Test set [ndcg@10: 0.2486 ndcg@20: 0.2736 ndcg@40: 0.3158 ] 
2024-11-16 12:32:35,930 - Test set [recall@10: 0.1958 recall@20: 0.2720 recall@40: 0.3666 ] Test set [ndcg@10: 0.2486 ndcg@20: 0.2736 ndcg@40: 0.3158 ] 
