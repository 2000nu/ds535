2024-11-16 05:41:31,937 - {'optimizer': {'name': 'adam', 'lr': 0.001, 'weight_decay': 0}, 'train': {'epoch': 30, 'batch_size': 2000, 'save_model': False, 'loss': 'pairwise', 'test_step': 1, 'reproducible': True, 'seed': 2023, 'tensorboard': True, 'log_loss': True, 'early_stop': False}, 'test': {'metrics': ['recall', 'ndcg'], 'k': [10, 20, 40], 'batch_size': 512}, 'data': {'type': 'social', 'name': 'lastfm', 'user_num': 1892, 'item_num': 17632}, 'model': {'name': 'idea_mhcn_v4', 'layer_num': 2, 'reg_weight': 0.001, 'embedding_size': 64, 'ss_rate': 0.01}, 'tune': {'enable': False, 'hyperparameters': ['cl_weight', 'temperature', 'sampling_ratio'], 'cl_weight': [1.0, 0.1, 0.01, 0.001], 'temperature': [0.1, 0.2, 0.3, 0.4, 0.5], 'sampling_ratio': [0.5, 0.6, 0.7, 0.8, 0.9, 1.0]}, 'device': 'cuda', 'log': True}
2024-11-16 05:41:33,736 - [Epoch   0 /  30] bpr_loss: 190.3305 reg_loss: 0.4986 ss_loss: 67.4714 
2024-11-16 05:41:34,292 - Epoch   0 Test set [recall@10: 0.0260 recall@20: 0.0413 recall@40: 0.0643 ] Test set [ndcg@10: 0.0318 ndcg@20: 0.0386 ndcg@40: 0.0492 ] 
2024-11-16 05:41:35,587 - [Epoch   1 /  30] bpr_loss: 121.8929 reg_loss: 0.5720 ss_loss: 51.2039 
2024-11-16 05:41:36,072 - Epoch   1 Test set [recall@10: 0.0255 recall@20: 0.0404 recall@40: 0.0621 ] Test set [ndcg@10: 0.0322 ndcg@20: 0.0388 ndcg@40: 0.0488 ] 
2024-11-16 05:41:37,417 - [Epoch   2 /  30] bpr_loss: 105.5871 reg_loss: 0.6478 ss_loss: 45.1919 
2024-11-16 05:41:38,071 - Epoch   2 Test set [recall@10: 0.0262 recall@20: 0.0408 recall@40: 0.0639 ] Test set [ndcg@10: 0.0327 ndcg@20: 0.0391 ndcg@40: 0.0497 ] 
2024-11-16 05:41:39,582 - [Epoch   3 /  30] bpr_loss: 96.5978 reg_loss: 0.7331 ss_loss: 41.7861 
2024-11-16 05:41:40,099 - Epoch   3 Test set [recall@10: 0.0259 recall@20: 0.0406 recall@40: 0.0622 ] Test set [ndcg@10: 0.0327 ndcg@20: 0.0391 ndcg@40: 0.0491 ] 
2024-11-16 05:41:41,838 - [Epoch   4 /  30] bpr_loss: 92.3242 reg_loss: 0.8256 ss_loss: 39.5423 
2024-11-16 05:41:42,249 - Epoch   4 Test set [recall@10: 0.0264 recall@20: 0.0415 recall@40: 0.0636 ] Test set [ndcg@10: 0.0335 ndcg@20: 0.0401 ndcg@40: 0.0502 ] 
2024-11-16 05:41:43,537 - [Epoch   5 /  30] bpr_loss: 85.6699 reg_loss: 0.9228 ss_loss: 37.6940 
2024-11-16 05:41:44,031 - Epoch   5 Test set [recall@10: 0.0266 recall@20: 0.0417 recall@40: 0.0644 ] Test set [ndcg@10: 0.0335 ndcg@20: 0.0402 ndcg@40: 0.0506 ] 
2024-11-16 05:41:45,305 - [Epoch   6 /  30] bpr_loss: 82.1693 reg_loss: 1.0237 ss_loss: 37.2561 
2024-11-16 05:41:45,778 - Epoch   6 Test set [recall@10: 0.0277 recall@20: 0.0425 recall@40: 0.0656 ] Test set [ndcg@10: 0.0348 ndcg@20: 0.0412 ndcg@40: 0.0519 ] 
2024-11-16 05:41:47,399 - [Epoch   7 /  30] bpr_loss: 77.8500 reg_loss: 1.1265 ss_loss: 35.8531 
2024-11-16 05:41:47,909 - Epoch   7 Test set [recall@10: 0.0275 recall@20: 0.0417 recall@40: 0.0660 ] Test set [ndcg@10: 0.0343 ndcg@20: 0.0404 ndcg@40: 0.0516 ] 
2024-11-16 05:41:49,437 - [Epoch   8 /  30] bpr_loss: 73.6561 reg_loss: 1.2300 ss_loss: 35.0991 
2024-11-16 05:41:49,930 - Epoch   8 Test set [recall@10: 0.0275 recall@20: 0.0423 recall@40: 0.0654 ] Test set [ndcg@10: 0.0342 ndcg@20: 0.0407 ndcg@40: 0.0513 ] 
2024-11-16 05:41:51,113 - [Epoch   9 /  30] bpr_loss: 72.2662 reg_loss: 1.3322 ss_loss: 34.8000 
2024-11-16 05:41:51,530 - Epoch   9 Test set [recall@10: 0.0270 recall@20: 0.0428 recall@40: 0.0660 ] Test set [ndcg@10: 0.0335 ndcg@20: 0.0405 ndcg@40: 0.0513 ] 
2024-11-16 05:41:52,970 - [Epoch  10 /  30] bpr_loss: 69.0380 reg_loss: 1.4350 ss_loss: 34.1445 
2024-11-16 05:41:53,406 - Epoch  10 Test set [recall@10: 0.0273 recall@20: 0.0434 recall@40: 0.0678 ] Test set [ndcg@10: 0.0337 ndcg@20: 0.0409 ndcg@40: 0.0521 ] 
2024-11-16 05:41:55,111 - [Epoch  11 /  30] bpr_loss: 66.9803 reg_loss: 1.5370 ss_loss: 33.5432 
2024-11-16 05:41:55,517 - Epoch  11 Test set [recall@10: 0.0269 recall@20: 0.0440 recall@40: 0.0682 ] Test set [ndcg@10: 0.0339 ndcg@20: 0.0416 ndcg@40: 0.0528 ] 
2024-11-16 05:41:56,890 - [Epoch  12 /  30] bpr_loss: 63.5689 reg_loss: 1.6368 ss_loss: 33.6483 
2024-11-16 05:41:57,304 - Epoch  12 Test set [recall@10: 0.0275 recall@20: 0.0439 recall@40: 0.0675 ] Test set [ndcg@10: 0.0344 ndcg@20: 0.0417 ndcg@40: 0.0525 ] 
2024-11-16 05:41:58,698 - [Epoch  13 /  30] bpr_loss: 62.0715 reg_loss: 1.7349 ss_loss: 32.8180 
2024-11-16 05:41:59,083 - Epoch  13 Test set [recall@10: 0.0269 recall@20: 0.0439 recall@40: 0.0678 ] Test set [ndcg@10: 0.0341 ndcg@20: 0.0417 ndcg@40: 0.0528 ] 
2024-11-16 05:42:00,351 - [Epoch  14 /  30] bpr_loss: 59.5563 reg_loss: 1.8310 ss_loss: 32.4309 
2024-11-16 05:42:00,842 - Epoch  14 Test set [recall@10: 0.0272 recall@20: 0.0438 recall@40: 0.0685 ] Test set [ndcg@10: 0.0341 ndcg@20: 0.0415 ndcg@40: 0.0529 ] 
2024-11-16 05:42:02,051 - [Epoch  15 /  30] bpr_loss: 59.3543 reg_loss: 1.9257 ss_loss: 32.8913 
2024-11-16 05:42:02,485 - Epoch  15 Test set [recall@10: 0.0272 recall@20: 0.0441 recall@40: 0.0687 ] Test set [ndcg@10: 0.0344 ndcg@20: 0.0420 ndcg@40: 0.0533 ] 
2024-11-16 05:42:03,756 - [Epoch  16 /  30] bpr_loss: 57.4162 reg_loss: 2.0190 ss_loss: 32.1301 
2024-11-16 05:42:04,143 - Epoch  16 Test set [recall@10: 0.0279 recall@20: 0.0447 recall@40: 0.0685 ] Test set [ndcg@10: 0.0349 ndcg@20: 0.0425 ndcg@40: 0.0535 ] 
2024-11-16 05:42:05,541 - [Epoch  17 /  30] bpr_loss: 54.9041 reg_loss: 2.1091 ss_loss: 31.9745 
2024-11-16 05:42:05,949 - Epoch  17 Test set [recall@10: 0.0280 recall@20: 0.0454 recall@40: 0.0689 ] Test set [ndcg@10: 0.0351 ndcg@20: 0.0429 ndcg@40: 0.0538 ] 
2024-11-16 05:42:07,144 - [Epoch  18 /  30] bpr_loss: 54.2701 reg_loss: 2.1973 ss_loss: 31.4757 
2024-11-16 05:42:07,552 - Epoch  18 Test set [recall@10: 0.0281 recall@20: 0.0454 recall@40: 0.0684 ] Test set [ndcg@10: 0.0350 ndcg@20: 0.0428 ndcg@40: 0.0535 ] 
2024-11-16 05:42:08,623 - [Epoch  19 /  30] bpr_loss: 52.3119 reg_loss: 2.2838 ss_loss: 31.3367 
2024-11-16 05:42:09,119 - Epoch  19 Test set [recall@10: 0.0288 recall@20: 0.0461 recall@40: 0.0701 ] Test set [ndcg@10: 0.0360 ndcg@20: 0.0438 ndcg@40: 0.0548 ] 
2024-11-16 05:42:10,161 - [Epoch  20 /  30] bpr_loss: 51.3074 reg_loss: 2.3686 ss_loss: 31.2996 
2024-11-16 05:42:10,592 - Epoch  20 Test set [recall@10: 0.0285 recall@20: 0.0457 recall@40: 0.0695 ] Test set [ndcg@10: 0.0359 ndcg@20: 0.0435 ndcg@40: 0.0544 ] 
2024-11-16 05:42:11,852 - [Epoch  21 /  30] bpr_loss: 50.7684 reg_loss: 2.4525 ss_loss: 31.2469 
2024-11-16 05:42:12,225 - Epoch  21 Test set [recall@10: 0.0281 recall@20: 0.0452 recall@40: 0.0688 ] Test set [ndcg@10: 0.0347 ndcg@20: 0.0424 ndcg@40: 0.0532 ] 
2024-11-16 05:42:13,643 - [Epoch  22 /  30] bpr_loss: 49.1176 reg_loss: 2.5354 ss_loss: 30.8692 
2024-11-16 05:42:14,048 - Epoch  22 Test set [recall@10: 0.0293 recall@20: 0.0450 recall@40: 0.0697 ] Test set [ndcg@10: 0.0361 ndcg@20: 0.0428 ndcg@40: 0.0542 ] 
2024-11-16 05:42:15,166 - [Epoch  23 /  30] bpr_loss: 47.8616 reg_loss: 2.6147 ss_loss: 30.7916 
2024-11-16 05:42:15,655 - Epoch  23 Test set [recall@10: 0.0295 recall@20: 0.0450 recall@40: 0.0704 ] Test set [ndcg@10: 0.0370 ndcg@20: 0.0436 ndcg@40: 0.0553 ] 
2024-11-16 05:42:16,714 - [Epoch  24 /  30] bpr_loss: 47.2188 reg_loss: 2.6931 ss_loss: 30.7476 
2024-11-16 05:42:17,249 - Epoch  24 Test set [recall@10: 0.0284 recall@20: 0.0452 recall@40: 0.0707 ] Test set [ndcg@10: 0.0361 ndcg@20: 0.0436 ndcg@40: 0.0553 ] 
2024-11-16 05:42:18,316 - [Epoch  25 /  30] bpr_loss: 46.4276 reg_loss: 2.7691 ss_loss: 30.0972 
2024-11-16 05:42:18,828 - Epoch  25 Test set [recall@10: 0.0283 recall@20: 0.0454 recall@40: 0.0705 ] Test set [ndcg@10: 0.0362 ndcg@20: 0.0438 ndcg@40: 0.0553 ] 
2024-11-16 05:42:19,965 - [Epoch  26 /  30] bpr_loss: 46.1096 reg_loss: 2.8448 ss_loss: 30.3547 
2024-11-16 05:42:20,369 - Epoch  26 Test set [recall@10: 0.0286 recall@20: 0.0448 recall@40: 0.0710 ] Test set [ndcg@10: 0.0366 ndcg@20: 0.0438 ndcg@40: 0.0559 ] 
2024-11-16 05:42:21,561 - [Epoch  27 /  30] bpr_loss: 44.4373 reg_loss: 2.9214 ss_loss: 29.4354 
2024-11-16 05:42:21,974 - Epoch  27 Test set [recall@10: 0.0283 recall@20: 0.0449 recall@40: 0.0695 ] Test set [ndcg@10: 0.0361 ndcg@20: 0.0434 ndcg@40: 0.0547 ] 
2024-11-16 05:42:23,126 - [Epoch  28 /  30] bpr_loss: 43.5303 reg_loss: 2.9952 ss_loss: 29.5819 
2024-11-16 05:42:23,639 - Epoch  28 Test set [recall@10: 0.0277 recall@20: 0.0449 recall@40: 0.0695 ] Test set [ndcg@10: 0.0357 ndcg@20: 0.0434 ndcg@40: 0.0547 ] 
2024-11-16 05:42:24,734 - [Epoch  29 /  30] bpr_loss: 41.8645 reg_loss: 3.0652 ss_loss: 29.5398 
2024-11-16 05:42:25,135 - Epoch  29 Test set [recall@10: 0.0281 recall@20: 0.0461 recall@40: 0.0705 ] Test set [ndcg@10: 0.0362 ndcg@20: 0.0444 ndcg@40: 0.0555 ] 
2024-11-16 05:42:25,503 - Test set [recall@10: 0.0281 recall@20: 0.0461 recall@40: 0.0705 ] Test set [ndcg@10: 0.0362 ndcg@20: 0.0444 ndcg@40: 0.0555 ] 
2024-11-16 05:42:25,871 - Test set [recall@10: 0.0281 recall@20: 0.0461 recall@40: 0.0705 ] Test set [ndcg@10: 0.0362 ndcg@20: 0.0444 ndcg@40: 0.0555 ] 
