2024-11-16 11:50:29,312 - {'optimizer': {'name': 'adam', 'lr': 0.001, 'weight_decay': 0}, 'train': {'epoch': 30, 'batch_size': 2000, 'save_model': False, 'loss': 'pairwise', 'test_step': 1, 'reproducible': True, 'seed': 2023, 'tensorboard': True, 'log_loss': True, 'early_stop': False}, 'test': {'metrics': ['recall', 'ndcg'], 'k': [10, 20, 40], 'batch_size': 512}, 'data': {'type': 'social', 'name': 'lastfm', 'user_num': 1892, 'item_num': 17632}, 'model': {'name': 'idea_mhcn_v4', 'layer_num': 2, 'reg_weight': 0.001, 'embedding_size': 64, 'ss_rate': 0.01}, 'tune': {'enable': False, 'hyperparameters': ['cl_weight', 'temperature', 'sampling_ratio'], 'cl_weight': [1.0, 0.1, 0.01, 0.001], 'temperature': [0.1, 0.2, 0.3, 0.4, 0.5], 'sampling_ratio': [0.5, 0.6, 0.7, 0.8, 0.9, 1.0]}, 'device': 'cuda', 'log': True}
2024-11-16 11:50:31,181 - [Epoch   0 /  30] bpr_loss: 191.0271 reg_loss: 0.4987 ss_loss: 68.0270 
2024-11-16 11:50:31,745 - Epoch   0 Test set [recall@10: 0.0263 recall@20: 0.0411 recall@40: 0.0638 ] Test set [ndcg@10: 0.0319 ndcg@20: 0.0384 ndcg@40: 0.0489 ] 
2024-11-16 11:50:33,061 - [Epoch   1 /  30] bpr_loss: 121.3896 reg_loss: 0.5721 ss_loss: 51.7079 
2024-11-16 11:50:33,560 - Epoch   1 Test set [recall@10: 0.0256 recall@20: 0.0407 recall@40: 0.0622 ] Test set [ndcg@10: 0.0325 ndcg@20: 0.0392 ndcg@40: 0.0491 ] 
2024-11-16 11:50:34,921 - [Epoch   2 /  30] bpr_loss: 104.9429 reg_loss: 0.6466 ss_loss: 45.9833 
2024-11-16 11:50:35,344 - Epoch   2 Test set [recall@10: 0.0262 recall@20: 0.0408 recall@40: 0.0634 ] Test set [ndcg@10: 0.0328 ndcg@20: 0.0391 ndcg@40: 0.0495 ] 
2024-11-16 11:50:36,687 - [Epoch   3 /  30] bpr_loss: 96.1250 reg_loss: 0.7299 ss_loss: 42.6216 
2024-11-16 11:50:37,076 - Epoch   3 Test set [recall@10: 0.0262 recall@20: 0.0405 recall@40: 0.0621 ] Test set [ndcg@10: 0.0327 ndcg@20: 0.0388 ndcg@40: 0.0487 ] 
2024-11-16 11:50:38,338 - [Epoch   4 /  30] bpr_loss: 91.6304 reg_loss: 0.8204 ss_loss: 40.6164 
2024-11-16 11:50:38,756 - Epoch   4 Test set [recall@10: 0.0266 recall@20: 0.0412 recall@40: 0.0637 ] Test set [ndcg@10: 0.0332 ndcg@20: 0.0396 ndcg@40: 0.0499 ] 
2024-11-16 11:50:40,352 - [Epoch   5 /  30] bpr_loss: 85.0905 reg_loss: 0.9152 ss_loss: 39.1424 
2024-11-16 11:50:40,887 - Epoch   5 Test set [recall@10: 0.0269 recall@20: 0.0411 recall@40: 0.0639 ] Test set [ndcg@10: 0.0338 ndcg@20: 0.0399 ndcg@40: 0.0504 ] 
2024-11-16 11:50:42,005 - [Epoch   6 /  30] bpr_loss: 81.5391 reg_loss: 1.0128 ss_loss: 38.6568 
2024-11-16 11:50:42,487 - Epoch   6 Test set [recall@10: 0.0279 recall@20: 0.0418 recall@40: 0.0667 ] Test set [ndcg@10: 0.0348 ndcg@20: 0.0408 ndcg@40: 0.0522 ] 
2024-11-16 11:50:43,828 - [Epoch   7 /  30] bpr_loss: 77.3236 reg_loss: 1.1126 ss_loss: 37.2430 
2024-11-16 11:50:44,335 - Epoch   7 Test set [recall@10: 0.0280 recall@20: 0.0417 recall@40: 0.0657 ] Test set [ndcg@10: 0.0344 ndcg@20: 0.0402 ndcg@40: 0.0514 ] 
2024-11-16 11:50:45,587 - [Epoch   8 /  30] bpr_loss: 73.1700 reg_loss: 1.2136 ss_loss: 36.5895 
2024-11-16 11:50:46,116 - Epoch   8 Test set [recall@10: 0.0276 recall@20: 0.0422 recall@40: 0.0660 ] Test set [ndcg@10: 0.0342 ndcg@20: 0.0406 ndcg@40: 0.0515 ] 
2024-11-16 11:50:47,618 - [Epoch   9 /  30] bpr_loss: 71.7207 reg_loss: 1.3137 ss_loss: 36.2434 
2024-11-16 11:50:48,041 - Epoch   9 Test set [recall@10: 0.0267 recall@20: 0.0425 recall@40: 0.0661 ] Test set [ndcg@10: 0.0332 ndcg@20: 0.0402 ndcg@40: 0.0512 ] 
2024-11-16 11:50:49,313 - [Epoch  10 /  30] bpr_loss: 68.5040 reg_loss: 1.4142 ss_loss: 35.6561 
2024-11-16 11:50:49,709 - Epoch  10 Test set [recall@10: 0.0274 recall@20: 0.0432 recall@40: 0.0672 ] Test set [ndcg@10: 0.0338 ndcg@20: 0.0409 ndcg@40: 0.0519 ] 
2024-11-16 11:50:50,896 - [Epoch  11 /  30] bpr_loss: 66.4957 reg_loss: 1.5137 ss_loss: 35.4049 
2024-11-16 11:50:51,397 - Epoch  11 Test set [recall@10: 0.0273 recall@20: 0.0434 recall@40: 0.0682 ] Test set [ndcg@10: 0.0340 ndcg@20: 0.0411 ndcg@40: 0.0526 ] 
2024-11-16 11:50:52,628 - [Epoch  12 /  30] bpr_loss: 63.0314 reg_loss: 1.6111 ss_loss: 35.0111 
2024-11-16 11:50:53,135 - Epoch  12 Test set [recall@10: 0.0276 recall@20: 0.0435 recall@40: 0.0672 ] Test set [ndcg@10: 0.0344 ndcg@20: 0.0415 ndcg@40: 0.0524 ] 
2024-11-16 11:50:54,282 - [Epoch  13 /  30] bpr_loss: 61.6167 reg_loss: 1.7067 ss_loss: 34.5021 
2024-11-16 11:50:54,789 - Epoch  13 Test set [recall@10: 0.0271 recall@20: 0.0437 recall@40: 0.0682 ] Test set [ndcg@10: 0.0343 ndcg@20: 0.0419 ndcg@40: 0.0531 ] 
2024-11-16 11:50:56,372 - [Epoch  14 /  30] bpr_loss: 59.0458 reg_loss: 1.8004 ss_loss: 33.9655 
2024-11-16 11:50:56,780 - Epoch  14 Test set [recall@10: 0.0272 recall@20: 0.0436 recall@40: 0.0681 ] Test set [ndcg@10: 0.0341 ndcg@20: 0.0415 ndcg@40: 0.0527 ] 
2024-11-16 11:50:57,911 - [Epoch  15 /  30] bpr_loss: 58.8656 reg_loss: 1.8933 ss_loss: 34.6386 
2024-11-16 11:50:58,290 - Epoch  15 Test set [recall@10: 0.0278 recall@20: 0.0439 recall@40: 0.0690 ] Test set [ndcg@10: 0.0348 ndcg@20: 0.0420 ndcg@40: 0.0535 ] 
2024-11-16 11:50:59,446 - [Epoch  16 /  30] bpr_loss: 57.0139 reg_loss: 1.9844 ss_loss: 33.8571 
2024-11-16 11:50:59,955 - Epoch  16 Test set [recall@10: 0.0277 recall@20: 0.0450 recall@40: 0.0688 ] Test set [ndcg@10: 0.0348 ndcg@20: 0.0426 ndcg@40: 0.0536 ] 
2024-11-16 11:51:01,202 - [Epoch  17 /  30] bpr_loss: 54.5563 reg_loss: 2.0732 ss_loss: 33.7216 
2024-11-16 11:51:01,603 - Epoch  17 Test set [recall@10: 0.0281 recall@20: 0.0450 recall@40: 0.0690 ] Test set [ndcg@10: 0.0352 ndcg@20: 0.0429 ndcg@40: 0.0540 ] 
2024-11-16 11:51:02,656 - [Epoch  18 /  30] bpr_loss: 53.8113 reg_loss: 2.1599 ss_loss: 33.2335 
2024-11-16 11:51:03,185 - Epoch  18 Test set [recall@10: 0.0285 recall@20: 0.0454 recall@40: 0.0689 ] Test set [ndcg@10: 0.0354 ndcg@20: 0.0429 ndcg@40: 0.0538 ] 
2024-11-16 11:51:04,442 - [Epoch  19 /  30] bpr_loss: 51.9757 reg_loss: 2.2446 ss_loss: 33.1155 
2024-11-16 11:51:04,841 - Epoch  19 Test set [recall@10: 0.0292 recall@20: 0.0461 recall@40: 0.0704 ] Test set [ndcg@10: 0.0366 ndcg@20: 0.0440 ndcg@40: 0.0552 ] 
2024-11-16 11:51:06,163 - [Epoch  20 /  30] bpr_loss: 50.8945 reg_loss: 2.3276 ss_loss: 33.0684 
2024-11-16 11:51:06,740 - Epoch  20 Test set [recall@10: 0.0292 recall@20: 0.0459 recall@40: 0.0698 ] Test set [ndcg@10: 0.0366 ndcg@20: 0.0439 ndcg@40: 0.0549 ] 
2024-11-16 11:51:08,050 - [Epoch  21 /  30] bpr_loss: 50.2891 reg_loss: 2.4105 ss_loss: 32.8563 
2024-11-16 11:51:08,450 - Epoch  21 Test set [recall@10: 0.0290 recall@20: 0.0446 recall@40: 0.0699 ] Test set [ndcg@10: 0.0356 ndcg@20: 0.0425 ndcg@40: 0.0542 ] 
2024-11-16 11:51:09,597 - [Epoch  22 /  30] bpr_loss: 48.7544 reg_loss: 2.4924 ss_loss: 32.5168 
2024-11-16 11:51:10,103 - Epoch  22 Test set [recall@10: 0.0293 recall@20: 0.0458 recall@40: 0.0703 ] Test set [ndcg@10: 0.0363 ndcg@20: 0.0435 ndcg@40: 0.0548 ] 
2024-11-16 11:51:11,167 - [Epoch  23 /  30] bpr_loss: 47.5721 reg_loss: 2.5714 ss_loss: 32.5344 
2024-11-16 11:51:11,669 - Epoch  23 Test set [recall@10: 0.0294 recall@20: 0.0456 recall@40: 0.0707 ] Test set [ndcg@10: 0.0372 ndcg@20: 0.0443 ndcg@40: 0.0558 ] 
2024-11-16 11:51:12,882 - [Epoch  24 /  30] bpr_loss: 46.8529 reg_loss: 2.6489 ss_loss: 32.7016 
2024-11-16 11:51:13,268 - Epoch  24 Test set [recall@10: 0.0290 recall@20: 0.0453 recall@40: 0.0706 ] Test set [ndcg@10: 0.0366 ndcg@20: 0.0439 ndcg@40: 0.0554 ] 
2024-11-16 11:51:14,665 - [Epoch  25 /  30] bpr_loss: 46.1678 reg_loss: 2.7240 ss_loss: 31.8225 
2024-11-16 11:51:15,184 - Epoch  25 Test set [recall@10: 0.0288 recall@20: 0.0455 recall@40: 0.0713 ] Test set [ndcg@10: 0.0366 ndcg@20: 0.0441 ndcg@40: 0.0558 ] 
2024-11-16 11:51:16,605 - [Epoch  26 /  30] bpr_loss: 45.7933 reg_loss: 2.7988 ss_loss: 32.0237 
2024-11-16 11:51:17,014 - Epoch  26 Test set [recall@10: 0.0290 recall@20: 0.0450 recall@40: 0.0714 ] Test set [ndcg@10: 0.0370 ndcg@20: 0.0440 ndcg@40: 0.0562 ] 
2024-11-16 11:51:18,195 - [Epoch  27 /  30] bpr_loss: 44.1045 reg_loss: 2.8744 ss_loss: 31.3632 
2024-11-16 11:51:18,581 - Epoch  27 Test set [recall@10: 0.0279 recall@20: 0.0452 recall@40: 0.0704 ] Test set [ndcg@10: 0.0358 ndcg@20: 0.0437 ndcg@40: 0.0552 ] 
2024-11-16 11:51:19,999 - [Epoch  28 /  30] bpr_loss: 43.2886 reg_loss: 2.9477 ss_loss: 31.5891 
2024-11-16 11:51:20,480 - Epoch  28 Test set [recall@10: 0.0282 recall@20: 0.0448 recall@40: 0.0704 ] Test set [ndcg@10: 0.0361 ndcg@20: 0.0435 ndcg@40: 0.0552 ] 
2024-11-16 11:51:21,886 - [Epoch  29 /  30] bpr_loss: 41.5385 reg_loss: 3.0178 ss_loss: 31.2470 
2024-11-16 11:51:22,274 - Epoch  29 Test set [recall@10: 0.0287 recall@20: 0.0462 recall@40: 0.0716 ] Test set [ndcg@10: 0.0364 ndcg@20: 0.0443 ndcg@40: 0.0559 ] 
2024-11-16 11:51:22,637 - Test set [recall@10: 0.0287 recall@20: 0.0462 recall@40: 0.0716 ] Test set [ndcg@10: 0.0364 ndcg@20: 0.0443 ndcg@40: 0.0559 ] 
2024-11-16 11:51:23,001 - Test set [recall@10: 0.0287 recall@20: 0.0462 recall@40: 0.0716 ] Test set [ndcg@10: 0.0364 ndcg@20: 0.0443 ndcg@40: 0.0559 ] 
