2024-11-06 11:16:52,800 - {'optimizer': {'name': 'adam', 'lr': 0.001, 'weight_decay': 0}, 'train': {'epoch': 30, 'batch_size': 2000, 'save_model': False, 'loss': 'pairwise', 'test_step': 1, 'reproducible': True, 'seed': 2023, 'tensorboard': True, 'log_loss': True, 'early_stop': False}, 'test': {'metrics': ['recall', 'ndcg'], 'k': [10, 20, 40], 'batch_size': 512}, 'data': {'type': 'social', 'name': 'yelp', 'user_num': 43043, 'item_num': 66576}, 'model': {'name': 'idea_mhcn_v3', 'layer_num': 2, 'reg_weight': 0.001, 'embedding_size': 64, 'ss_rate': 0.01, 'cl_weight': 0.01, 'zeta': 0.3, 'temperature': 0.1, 'sampling_ratio': 0.5, 'k': 1}, 'tune': {'enable': True, 'hyperparameters': ['cl_weight', 'temperature', 'sampling_ratio'], 'cl_weight': [1.0, 0.1, 0.01, 0.001], 'temperature': [0.1, 0.2, 0.3, 0.4, 0.5], 'sampling_ratio': [0.5, 0.6, 0.7, 0.8, 0.9, 1.0]}, 'device': 'cuda', 'log': True}
2024-11-06 11:16:52,801 - hyperparameter: {'cl_weight': 1.0, 'temperature': 0.1, 'sampling_ratio': 0.5}
2024-11-06 11:23:48,841 - [Epoch   0 /  30] bpr_loss: 170.6638 reg_loss: 0.9632 ss_loss: 1984.6067 cl_loss: 69.9791 
2024-11-06 11:24:04,215 - Epoch   0 Test set [recall@10: 0.0164 recall@20: 0.0292 recall@40: 0.0487 ] Test set [ndcg@10: 0.0081 ndcg@20: 0.0113 ndcg@40: 0.0153 ] 
2024-11-06 11:30:49,918 - [Epoch   1 /  30] bpr_loss: 116.1439 reg_loss: 1.6269 ss_loss: 1805.9407 cl_loss: 31.8598 
2024-11-06 11:31:05,017 - Epoch   1 Test set [recall@10: 0.0194 recall@20: 0.0334 recall@40: 0.0557 ] Test set [ndcg@10: 0.0094 ndcg@20: 0.0129 ndcg@40: 0.0175 ] 
2024-11-06 11:37:46,957 - [Epoch   2 /  30] bpr_loss: 100.3207 reg_loss: 2.2201 ss_loss: 1784.2301 cl_loss: 24.6504 
2024-11-06 11:38:03,140 - Epoch   2 Test set [recall@10: 0.0210 recall@20: 0.0363 recall@40: 0.0608 ] Test set [ndcg@10: 0.0106 ndcg@20: 0.0144 ndcg@40: 0.0194 ] 
2024-11-06 11:44:45,796 - [Epoch   3 /  30] bpr_loss: 91.3479 reg_loss: 2.8123 ss_loss: 1771.3804 cl_loss: 21.1570 
2024-11-06 11:45:03,242 - Epoch   3 Test set [recall@10: 0.0234 recall@20: 0.0403 recall@40: 0.0642 ] Test set [ndcg@10: 0.0117 ndcg@20: 0.0159 ndcg@40: 0.0208 ] 
2024-11-06 11:51:48,695 - [Epoch   4 /  30] bpr_loss: 84.0709 reg_loss: 3.4112 ss_loss: 1767.0972 cl_loss: 18.9440 
2024-11-06 11:52:05,995 - Epoch   4 Test set [recall@10: 0.0243 recall@20: 0.0413 recall@40: 0.0665 ] Test set [ndcg@10: 0.0120 ndcg@20: 0.0163 ndcg@40: 0.0214 ] 
2024-11-06 11:58:47,012 - [Epoch   5 /  30] bpr_loss: 78.5735 reg_loss: 4.0164 ss_loss: 1757.4028 cl_loss: 17.5383 
2024-11-06 11:59:03,793 - Epoch   5 Test set [recall@10: 0.0264 recall@20: 0.0442 recall@40: 0.0709 ] Test set [ndcg@10: 0.0134 ndcg@20: 0.0178 ndcg@40: 0.0233 ] 
2024-11-06 12:05:42,094 - [Epoch   6 /  30] bpr_loss: 74.5436 reg_loss: 4.6395 ss_loss: 1755.9187 cl_loss: 16.4914 
2024-11-06 12:05:58,543 - Epoch   6 Test set [recall@10: 0.0277 recall@20: 0.0452 recall@40: 0.0723 ] Test set [ndcg@10: 0.0140 ndcg@20: 0.0184 ndcg@40: 0.0239 ] 
2024-11-06 12:12:34,457 - [Epoch   7 /  30] bpr_loss: 70.8287 reg_loss: 5.2914 ss_loss: 1754.5710 cl_loss: 15.5729 
2024-11-06 12:12:49,875 - Epoch   7 Test set [recall@10: 0.0277 recall@20: 0.0452 recall@40: 0.0718 ] Test set [ndcg@10: 0.0140 ndcg@20: 0.0184 ndcg@40: 0.0238 ] 
2024-11-06 12:19:23,232 - [Epoch   8 /  30] bpr_loss: 67.2480 reg_loss: 5.9735 ss_loss: 1748.1918 cl_loss: 14.8106 
2024-11-06 12:19:40,066 - Epoch   8 Test set [recall@10: 0.0282 recall@20: 0.0474 recall@40: 0.0732 ] Test set [ndcg@10: 0.0143 ndcg@20: 0.0191 ndcg@40: 0.0244 ] 
2024-11-06 12:26:14,670 - [Epoch   9 /  30] bpr_loss: 64.1370 reg_loss: 6.6830 ss_loss: 1748.0317 cl_loss: 14.2915 
2024-11-06 12:26:31,081 - Epoch   9 Test set [recall@10: 0.0289 recall@20: 0.0473 recall@40: 0.0738 ] Test set [ndcg@10: 0.0147 ndcg@20: 0.0193 ndcg@40: 0.0247 ] 
2024-11-06 12:33:05,901 - [Epoch  10 /  30] bpr_loss: 61.5526 reg_loss: 7.4144 ss_loss: 1743.8277 cl_loss: 13.7274 
2024-11-06 12:33:22,122 - Epoch  10 Test set [recall@10: 0.0286 recall@20: 0.0479 recall@40: 0.0735 ] Test set [ndcg@10: 0.0145 ndcg@20: 0.0194 ndcg@40: 0.0246 ] 
2024-11-06 12:39:58,221 - [Epoch  11 /  30] bpr_loss: 59.3274 reg_loss: 8.1728 ss_loss: 1737.9070 cl_loss: 13.0671 
2024-11-06 12:40:13,663 - Epoch  11 Test set [recall@10: 0.0287 recall@20: 0.0467 recall@40: 0.0743 ] Test set [ndcg@10: 0.0145 ndcg@20: 0.0191 ndcg@40: 0.0247 ] 
2024-11-06 12:46:50,307 - [Epoch  12 /  30] bpr_loss: 56.8199 reg_loss: 8.9435 ss_loss: 1736.2026 cl_loss: 12.7384 
2024-11-06 12:47:05,606 - Epoch  12 Test set [recall@10: 0.0284 recall@20: 0.0476 recall@40: 0.0739 ] Test set [ndcg@10: 0.0144 ndcg@20: 0.0192 ndcg@40: 0.0246 ] 
2024-11-06 12:53:41,037 - [Epoch  13 /  30] bpr_loss: 55.1365 reg_loss: 9.7498 ss_loss: 1736.1242 cl_loss: 12.3455 
2024-11-06 12:53:56,293 - Epoch  13 Test set [recall@10: 0.0288 recall@20: 0.0476 recall@40: 0.0748 ] Test set [ndcg@10: 0.0146 ndcg@20: 0.0193 ndcg@40: 0.0249 ] 
2024-11-06 13:00:30,101 - [Epoch  14 /  30] bpr_loss: 52.4748 reg_loss: 10.5760 ss_loss: 1732.6477 cl_loss: 12.0179 
2024-11-06 13:00:44,997 - Epoch  14 Test set [recall@10: 0.0294 recall@20: 0.0479 recall@40: 0.0760 ] Test set [ndcg@10: 0.0147 ndcg@20: 0.0193 ndcg@40: 0.0250 ] 
2024-11-06 13:07:17,537 - [Epoch  15 /  30] bpr_loss: 50.8311 reg_loss: 11.4145 ss_loss: 1728.9945 cl_loss: 11.5810 
2024-11-06 13:07:32,228 - Epoch  15 Test set [recall@10: 0.0292 recall@20: 0.0471 recall@40: 0.0759 ] Test set [ndcg@10: 0.0148 ndcg@20: 0.0193 ndcg@40: 0.0252 ] 
2024-11-06 13:14:06,056 - [Epoch  16 /  30] bpr_loss: 49.1678 reg_loss: 12.2698 ss_loss: 1728.6777 cl_loss: 11.2075 
2024-11-06 13:14:21,316 - Epoch  16 Test set [recall@10: 0.0289 recall@20: 0.0468 recall@40: 0.0757 ] Test set [ndcg@10: 0.0148 ndcg@20: 0.0192 ndcg@40: 0.0251 ] 
