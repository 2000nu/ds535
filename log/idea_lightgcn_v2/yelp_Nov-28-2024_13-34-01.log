2024-11-28 13:34:01,542 - {'optimizer': {'name': 'adam', 'lr': 0.001, 'weight_decay': 0}, 'train': {'epoch': 500, 'batch_size': 4096, 'save_model': False, 'loss': 'pairwise', 'log_loss': False, 'test_step': 3, 'patience': 5, 'reproducible': True, 'seed': 2023, 'early_stop': True}, 'test': {'metrics': ['recall', 'ndcg'], 'k': [10, 20, 40], 'batch_size': 1024}, 'data': {'type': 'social', 'name': 'yelp', 'user_num': 43043, 'item_num': 66576}, 'model': {'name': 'idea_lightgcn_v2', 'layer_num': 3, 'reg_weight': 1e-06, 'embedding_size': 64, 'self_gating_unit': True, 'pagerank': False, 'combine_gcn': False, 'alpha': 0.9, 'cl_weight': 1e-05, 'sigma': 20, 'not_normalize': False}, 'tune': {'enable': False, 'hyperparameters': ['layer_num', 'reg_weight', 'cl_weight', 'alpha'], 'layer_num': [2, 3], 'reg_weight': [1e-06, 1e-07, 1e-08], 'cl_weight': [1e-05, 1e-06, 1e-07], 'alpha': [0.7, 0.8, 0.9]}, 'device': 'cuda', 'log': True}
2024-11-28 13:34:25,682 - Epoch   0 Test set [recall@10: 0.0214 recall@20: 0.0359 recall@40: 0.0586 ] Test set [ndcg@10: 0.0111 ndcg@20: 0.0148 ndcg@40: 0.0194 ] 
2024-11-28 13:34:25,683 - Validation score increased.  Copying the best model ...
2024-11-28 13:35:05,910 - Epoch   3 Test set [recall@10: 0.0231 recall@20: 0.0390 recall@40: 0.0619 ] Test set [ndcg@10: 0.0120 ndcg@20: 0.0160 ndcg@40: 0.0206 ] 
2024-11-28 13:35:05,911 - Validation score increased.  Copying the best model ...
2024-11-28 13:35:46,214 - Epoch   6 Test set [recall@10: 0.0253 recall@20: 0.0422 recall@40: 0.0685 ] Test set [ndcg@10: 0.0132 ndcg@20: 0.0174 ndcg@40: 0.0227 ] 
2024-11-28 13:35:46,215 - Validation score increased.  Copying the best model ...
2024-11-28 13:36:27,024 - Epoch   9 Test set [recall@10: 0.0266 recall@20: 0.0449 recall@40: 0.0703 ] Test set [ndcg@10: 0.0137 ndcg@20: 0.0182 ndcg@40: 0.0234 ] 
2024-11-28 13:36:27,025 - Validation score increased.  Copying the best model ...
2024-11-28 13:37:08,377 - Epoch  12 Test set [recall@10: 0.0277 recall@20: 0.0454 recall@40: 0.0720 ] Test set [ndcg@10: 0.0141 ndcg@20: 0.0186 ndcg@40: 0.0240 ] 
2024-11-28 13:37:08,378 - Validation score increased.  Copying the best model ...
2024-11-28 13:37:49,968 - Epoch  15 Test set [recall@10: 0.0281 recall@20: 0.0464 recall@40: 0.0741 ] Test set [ndcg@10: 0.0144 ndcg@20: 0.0189 ndcg@40: 0.0246 ] 
2024-11-28 13:37:49,969 - Validation score increased.  Copying the best model ...
2024-11-28 13:38:30,426 - Epoch  18 Test set [recall@10: 0.0286 recall@20: 0.0467 recall@40: 0.0750 ] Test set [ndcg@10: 0.0148 ndcg@20: 0.0193 ndcg@40: 0.0251 ] 
2024-11-28 13:38:30,427 - Validation score increased.  Copying the best model ...
2024-11-28 13:39:10,536 - Epoch  21 Test set [recall@10: 0.0294 recall@20: 0.0481 recall@40: 0.0764 ] Test set [ndcg@10: 0.0149 ndcg@20: 0.0196 ndcg@40: 0.0254 ] 
2024-11-28 13:39:10,537 - Validation score increased.  Copying the best model ...
2024-11-28 13:39:51,495 - Epoch  24 Test set [recall@10: 0.0299 recall@20: 0.0491 recall@40: 0.0782 ] Test set [ndcg@10: 0.0153 ndcg@20: 0.0201 ndcg@40: 0.0260 ] 
2024-11-28 13:39:51,496 - Validation score increased.  Copying the best model ...
2024-11-28 13:40:32,600 - Epoch  27 Test set [recall@10: 0.0302 recall@20: 0.0496 recall@40: 0.0790 ] Test set [ndcg@10: 0.0154 ndcg@20: 0.0203 ndcg@40: 0.0263 ] 
2024-11-28 13:40:32,601 - Validation score increased.  Copying the best model ...
2024-11-28 13:41:13,911 - Epoch  30 Test set [recall@10: 0.0305 recall@20: 0.0507 recall@40: 0.0789 ] Test set [ndcg@10: 0.0156 ndcg@20: 0.0207 ndcg@40: 0.0264 ] 
2024-11-28 13:41:13,912 - Validation score increased.  Copying the best model ...
2024-11-28 13:41:53,768 - Epoch  33 Test set [recall@10: 0.0312 recall@20: 0.0507 recall@40: 0.0790 ] Test set [ndcg@10: 0.0159 ndcg@20: 0.0208 ndcg@40: 0.0265 ] 
2024-11-28 13:41:53,768 - Validation score increased.  Copying the best model ...
2024-11-28 13:42:33,698 - Epoch  36 Test set [recall@10: 0.0309 recall@20: 0.0510 recall@40: 0.0805 ] Test set [ndcg@10: 0.0158 ndcg@20: 0.0208 ndcg@40: 0.0268 ] 
2024-11-28 13:42:33,698 - Early stop counter: 1 out of 5
2024-11-28 13:43:13,158 - Epoch  39 Test set [recall@10: 0.0319 recall@20: 0.0513 recall@40: 0.0806 ] Test set [ndcg@10: 0.0162 ndcg@20: 0.0210 ndcg@40: 0.0270 ] 
2024-11-28 13:43:13,159 - Validation score increased.  Copying the best model ...
2024-11-28 13:43:52,172 - Epoch  42 Test set [recall@10: 0.0317 recall@20: 0.0517 recall@40: 0.0809 ] Test set [ndcg@10: 0.0161 ndcg@20: 0.0211 ndcg@40: 0.0270 ] 
2024-11-28 13:43:52,172 - Early stop counter: 1 out of 5
2024-11-28 13:44:31,557 - Epoch  45 Test set [recall@10: 0.0319 recall@20: 0.0506 recall@40: 0.0822 ] Test set [ndcg@10: 0.0163 ndcg@20: 0.0210 ndcg@40: 0.0274 ] 
2024-11-28 13:44:31,557 - Early stop counter: 2 out of 5
2024-11-28 13:45:10,608 - Epoch  48 Test set [recall@10: 0.0318 recall@20: 0.0515 recall@40: 0.0820 ] Test set [ndcg@10: 0.0162 ndcg@20: 0.0212 ndcg@40: 0.0274 ] 
2024-11-28 13:45:10,609 - Early stop counter: 3 out of 5
2024-11-28 13:45:49,587 - Epoch  51 Test set [recall@10: 0.0322 recall@20: 0.0521 recall@40: 0.0835 ] Test set [ndcg@10: 0.0163 ndcg@20: 0.0213 ndcg@40: 0.0276 ] 
2024-11-28 13:45:49,587 - Validation score increased.  Copying the best model ...
2024-11-28 13:46:29,436 - Epoch  54 Test set [recall@10: 0.0326 recall@20: 0.0528 recall@40: 0.0837 ] Test set [ndcg@10: 0.0167 ndcg@20: 0.0217 ndcg@40: 0.0280 ] 
2024-11-28 13:46:29,436 - Validation score increased.  Copying the best model ...
2024-11-28 13:47:09,242 - Epoch  57 Test set [recall@10: 0.0324 recall@20: 0.0527 recall@40: 0.0830 ] Test set [ndcg@10: 0.0167 ndcg@20: 0.0217 ndcg@40: 0.0279 ] 
2024-11-28 13:47:09,243 - Early stop counter: 1 out of 5
2024-11-28 13:47:47,877 - Epoch  60 Test set [recall@10: 0.0328 recall@20: 0.0525 recall@40: 0.0842 ] Test set [ndcg@10: 0.0167 ndcg@20: 0.0216 ndcg@40: 0.0280 ] 
2024-11-28 13:47:47,878 - Validation score increased.  Copying the best model ...
2024-11-28 13:48:26,760 - Epoch  63 Test set [recall@10: 0.0330 recall@20: 0.0533 recall@40: 0.0842 ] Test set [ndcg@10: 0.0167 ndcg@20: 0.0218 ndcg@40: 0.0281 ] 
2024-11-28 13:48:26,761 - Validation score increased.  Copying the best model ...
2024-11-28 13:49:05,538 - Epoch  66 Test set [recall@10: 0.0329 recall@20: 0.0538 recall@40: 0.0846 ] Test set [ndcg@10: 0.0167 ndcg@20: 0.0220 ndcg@40: 0.0282 ] 
2024-11-28 13:49:05,538 - Early stop counter: 1 out of 5
2024-11-28 13:49:44,817 - Epoch  69 Test set [recall@10: 0.0331 recall@20: 0.0532 recall@40: 0.0853 ] Test set [ndcg@10: 0.0168 ndcg@20: 0.0218 ndcg@40: 0.0284 ] 
2024-11-28 13:49:44,818 - Validation score increased.  Copying the best model ...
2024-11-28 13:50:24,782 - Epoch  72 Test set [recall@10: 0.0322 recall@20: 0.0542 recall@40: 0.0850 ] Test set [ndcg@10: 0.0165 ndcg@20: 0.0220 ndcg@40: 0.0283 ] 
2024-11-28 13:50:24,783 - Early stop counter: 1 out of 5
2024-11-28 13:51:04,669 - Epoch  75 Test set [recall@10: 0.0329 recall@20: 0.0541 recall@40: 0.0854 ] Test set [ndcg@10: 0.0167 ndcg@20: 0.0221 ndcg@40: 0.0284 ] 
2024-11-28 13:51:04,669 - Early stop counter: 2 out of 5
2024-11-28 13:51:44,045 - Epoch  78 Test set [recall@10: 0.0330 recall@20: 0.0540 recall@40: 0.0860 ] Test set [ndcg@10: 0.0168 ndcg@20: 0.0221 ndcg@40: 0.0286 ] 
2024-11-28 13:51:44,045 - Early stop counter: 3 out of 5
2024-11-28 13:52:23,534 - Epoch  81 Test set [recall@10: 0.0332 recall@20: 0.0549 recall@40: 0.0871 ] Test set [ndcg@10: 0.0169 ndcg@20: 0.0223 ndcg@40: 0.0288 ] 
2024-11-28 13:52:23,534 - Validation score increased.  Copying the best model ...
2024-11-28 13:53:03,309 - Epoch  84 Test set [recall@10: 0.0337 recall@20: 0.0549 recall@40: 0.0869 ] Test set [ndcg@10: 0.0171 ndcg@20: 0.0224 ndcg@40: 0.0289 ] 
2024-11-28 13:53:03,310 - Validation score increased.  Copying the best model ...
2024-11-28 13:53:43,160 - Epoch  87 Test set [recall@10: 0.0337 recall@20: 0.0549 recall@40: 0.0879 ] Test set [ndcg@10: 0.0170 ndcg@20: 0.0224 ndcg@40: 0.0291 ] 
2024-11-28 13:53:43,161 - Validation score increased.  Copying the best model ...
2024-11-28 13:54:22,871 - Epoch  90 Test set [recall@10: 0.0344 recall@20: 0.0552 recall@40: 0.0880 ] Test set [ndcg@10: 0.0172 ndcg@20: 0.0224 ndcg@40: 0.0291 ] 
2024-11-28 13:54:22,872 - Validation score increased.  Copying the best model ...
2024-11-28 13:55:02,891 - Epoch  93 Test set [recall@10: 0.0345 recall@20: 0.0557 recall@40: 0.0884 ] Test set [ndcg@10: 0.0174 ndcg@20: 0.0227 ndcg@40: 0.0294 ] 
2024-11-28 13:55:02,892 - Validation score increased.  Copying the best model ...
2024-11-28 13:55:41,975 - Epoch  96 Test set [recall@10: 0.0341 recall@20: 0.0560 recall@40: 0.0883 ] Test set [ndcg@10: 0.0173 ndcg@20: 0.0228 ndcg@40: 0.0294 ] 
2024-11-28 13:55:41,975 - Early stop counter: 1 out of 5
2024-11-28 13:56:21,200 - Epoch  99 Test set [recall@10: 0.0344 recall@20: 0.0554 recall@40: 0.0887 ] Test set [ndcg@10: 0.0173 ndcg@20: 0.0226 ndcg@40: 0.0294 ] 
2024-11-28 13:56:21,200 - Early stop counter: 2 out of 5
2024-11-28 13:56:59,821 - Epoch 102 Test set [recall@10: 0.0347 recall@20: 0.0560 recall@40: 0.0880 ] Test set [ndcg@10: 0.0176 ndcg@20: 0.0230 ndcg@40: 0.0295 ] 
2024-11-28 13:56:59,822 - Validation score increased.  Copying the best model ...
2024-11-28 13:57:38,657 - Epoch 105 Test set [recall@10: 0.0338 recall@20: 0.0559 recall@40: 0.0874 ] Test set [ndcg@10: 0.0172 ndcg@20: 0.0227 ndcg@40: 0.0291 ] 
2024-11-28 13:57:38,657 - Early stop counter: 1 out of 5
2024-11-28 13:58:17,359 - Epoch 108 Test set [recall@10: 0.0346 recall@20: 0.0554 recall@40: 0.0875 ] Test set [ndcg@10: 0.0177 ndcg@20: 0.0229 ndcg@40: 0.0294 ] 
2024-11-28 13:58:17,360 - Early stop counter: 2 out of 5
2024-11-28 13:58:55,971 - Epoch 111 Test set [recall@10: 0.0351 recall@20: 0.0558 recall@40: 0.0885 ] Test set [ndcg@10: 0.0177 ndcg@20: 0.0229 ndcg@40: 0.0296 ] 
2024-11-28 13:58:55,972 - Validation score increased.  Copying the best model ...
2024-11-28 13:59:34,372 - Epoch 114 Test set [recall@10: 0.0350 recall@20: 0.0556 recall@40: 0.0890 ] Test set [ndcg@10: 0.0178 ndcg@20: 0.0230 ndcg@40: 0.0297 ] 
2024-11-28 13:59:34,372 - Early stop counter: 1 out of 5
2024-11-28 14:00:12,852 - Epoch 117 Test set [recall@10: 0.0348 recall@20: 0.0562 recall@40: 0.0889 ] Test set [ndcg@10: 0.0176 ndcg@20: 0.0230 ndcg@40: 0.0297 ] 
2024-11-28 14:00:12,853 - Early stop counter: 2 out of 5
2024-11-28 14:00:51,329 - Epoch 120 Test set [recall@10: 0.0343 recall@20: 0.0558 recall@40: 0.0883 ] Test set [ndcg@10: 0.0175 ndcg@20: 0.0229 ndcg@40: 0.0296 ] 
2024-11-28 14:00:51,329 - Early stop counter: 3 out of 5
2024-11-28 14:01:29,817 - Epoch 123 Test set [recall@10: 0.0342 recall@20: 0.0562 recall@40: 0.0900 ] Test set [ndcg@10: 0.0176 ndcg@20: 0.0231 ndcg@40: 0.0299 ] 
2024-11-28 14:01:29,817 - Early stop counter: 4 out of 5
2024-11-28 14:02:08,885 - Epoch 126 Test set [recall@10: 0.0348 recall@20: 0.0558 recall@40: 0.0899 ] Test set [ndcg@10: 0.0178 ndcg@20: 0.0231 ndcg@40: 0.0300 ] 
2024-11-28 14:02:08,885 - Early stop counter: 5 out of 5
2024-11-28 14:02:08,885 - Best Epoch 111
2024-11-28 14:02:22,747 - Test set [recall@10: 0.0351 recall@20: 0.0558 recall@40: 0.0885 ] Test set [ndcg@10: 0.0177 ndcg@20: 0.0229 ndcg@40: 0.0296 ] 
2024-11-28 14:02:36,514 - Test set [recall@10: 0.0351 recall@20: 0.0558 recall@40: 0.0885 ] Test set [ndcg@10: 0.0177 ndcg@20: 0.0229 ndcg@40: 0.0296 ] 
2024-11-28 14:02:50,613 - Test set [recall@10: 0.0351 recall@20: 0.0558 recall@40: 0.0885 ] Test set [ndcg@10: 0.0177 ndcg@20: 0.0229 ndcg@40: 0.0296 ] 
